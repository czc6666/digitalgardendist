<!doctype html>
<html lang="zh-CN">
<head>
<title>2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script async type="module">import mermaid from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-sv0slik/5O0JIPdLBCR2A3XDg/1U3WuDEheZfI/DI5n8Yqc3h5kjrnr46FGBNiUAJF7rE4LHKwQ/SoSLRKAxEA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdn.jsdelivr.net/npm/lucide@0.115.0/dist/umd/lucide.min.js"></script>
<script>window.addEventListener("load",(()=>{document.querySelectorAll(".callout").forEach((e=>{const t=getComputedStyle(e).getPropertyValue("--callout-icon"),l=t&&t.trim().replace(/^lucide-/,"");if(l){const t=e.querySelector(".callout-title");if(t){const e=document.createElement("div"),c=document.createElement("i");e.appendChild(c),c.setAttribute("icon-name",l),e.setAttribute("class","callout-icon"),t.insertBefore(e,t.firstChild)}}})),lucide.createIcons(),Array.from(document.querySelectorAll(".callout.is-collapsible")).forEach((e=>{e.querySelector(".callout-title").addEventListener("click",(t=>{e.classList.contains("is-collapsed")?e.classList.remove("is-collapsed"):e.classList.add("is-collapsed")}))}))}))</script>
<script async src="https://fastly.jsdelivr.net/npm/force-graph@1.43.0/dist/force-graph.min.js"></script>
<script async src="https://fastly.jsdelivr.net/npm/@alpinejs/persist@3.11.1/dist/cdn.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/alpinejs@3.11.1/dist/cdn.min.js" async></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer" async>
<script src="https://fastly.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer" async></script>
<link href="/styles/digital-garden-base.css" rel="stylesheet">
<link href="/styles/obsidian-base.css" rel="stylesheet">
<link href="/styles/_theme.74516f71.css" rel="stylesheet">
<link href="/styles/custom-style.css" rel="stylesheet">
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<style></style>
<style></style>
</head>
<body class="theme-light markdown-preview-view markdown-rendered markdown-preview-section css-settings-manager mod-windows is-frameless is-maximized is-hidden-frameless is-focused obsidian-app theme-light show-inline-title show-ribbon show-view-header css-settings-manager theme-default line-style-solid folder-default blockquote-normal callout-normal checkbox-default tag-default link-default heading-default responsive-tile-height oz-show-all-num">
<nav class="navbar">
<div class="navbar-inner">
<a href="/" style="text-decoration:none">
<h1 style="margin:15px!important">czc&#39;s digital garden</h1>
</a>
</div>
<div class="search-button align-icon" onclick="toggleSearch()">
<span class="search-icon">
<i icon-name="search"></i>
</span>
<span class="search-text">
<span>Search</span>
<span style="font-size:.6rem;padding:2px 2px 0 6px;text-align:center;transform:translateY(4px)" class="search-keys">
CTRL + K
</span>
</span>
</div>
</nav>
<div class="search-container" id="globalsearch" onclick="toggleSearch()">
<div class="search-box">
<input type="search" id="term" placeholder="Start typing...">
<div id="search-results"></div>
<footer class="search-box-footer">
<div class="navigation-hint">
<span>Enter to select</span>
</div>
<div class="navigation-hint align-icon">
<i icon-name="arrow-up" aria-hidden="true"></i>
<i icon-name="arrow-down" aria-hidden="true"></i>
<span>to navigate</span>
</div>
<div class="navigation-hint">
<span>ESC to close</span>
</div>
</footer>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js"></script>
<script>document.addEventListener("DOMContentLoaded",init,!1),document.addEventListener("DOMContentLoaded",setCorrectShortcut,!1),window.toggleSearch=function(){document.getElementById("globalsearch").classList.contains("active")?document.getElementById("globalsearch").classList.remove("active"):(document.getElementById("globalsearch").classList.add("active"),document.getElementById("term").focus())},window.toggleTagSearch=function(e){console.log(e.textContent);const t=e.textContent;t&&(window.document.getElementById("term").value=t.trim(),window.toggleSearch(),window.search())};const loadingSvg='\n    <svg width="100" height="100" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg" stroke="#fff">\n      <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="1.5s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="1.5s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="1.5s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="3s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="3s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="3s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="8">\n              <animate attributeName="r"\n                   begin="0s" dur="1.5s"\n                   values="6;1;2;3;4;5;6"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n      </g>\n  </svg>';function debounce(e,t,n){var a;return function(){var r=this,i=arguments,c=n&&!a;clearTimeout(a),a=setTimeout((function(){a=null,n||e.apply(r,i)}),t),c&&e.apply(r,i)}}function setCorrectShortcut(){navigator.platform.toUpperCase().indexOf("MAC")>=0&&document.querySelectorAll(".search-keys").forEach((e=>e.innerHTML="⌘ + K"))}function createIndex(e){const t=e=>e.toLowerCase().split(/([^a-z]|[^\x00-\x7F])/),n=new FlexSearch.Document({cache:!0,charset:"latin:extra",optimize:!0,index:[{field:"content",tokenize:"reverse",encode:t},{field:"title",tokenize:"forward",encode:t},{field:"tags",tokenize:"forward",encode:t}]});return e.forEach(((e,t)=>{n.add({id:t,title:e.title,content:e.content,tags:e.tags})})),n}async function init(){let e=!0;if(localStorage.getItem("searchIndex")){let{date:t,docs:n}=JSON.parse(localStorage.getItem("searchIndex"));if("2025-06-28T13:57:11.408Z"===t){e=!1;let t=createIndex(n);window.docs=n,window.index=t}}if(e){let e=await(await fetch("/searchIndex.json?v=2025-06-28T13:57:11.408Z")).json(),t=createIndex(e);localStorage.setItem("searchIndex",JSON.stringify({date:"2025-06-28T13:57:11.408Z",docs:e})),window.docs=e,window.index=t}document.addEventListener("keydown",(e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),toggleSearch()),"Escape"===e.key&&document.getElementById("globalsearch").classList.remove("active"),document.getElementById("globalsearch").classList.contains("active")){if("ArrowDown"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.nextElementSibling?t.nextElementSibling.classList.add("active"):document.querySelector(".searchresult").classList.add("active")):document.querySelector(".searchresult").classList.add("active");let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("ArrowUp"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.previousElementSibling?t.previousElementSibling.classList.add("active"):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling||e.classList.add("active")}))):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling&&e.classList.add("active")}));let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("Enter"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t&&(window.location.href=t.querySelector("a").href)}}}));const t=debounce(search,200,!1);field=document.querySelector("#term"),field.addEventListener("keydown",(e=>{"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&t()})),resultsDiv=document.querySelector("#search-results");const n=new URL(location.href).searchParams;n.get("q")&&(field.setAttribute("value",n.get("q")),toggleSearch(),search())}async function search(){let e=field.value.trim();if(!e)return;if(e==lastSearch)return;console.log(`search for ${e}`),window.lastSearch=e,resultsDiv.innerHTML=loadingSvg;let t=offlineSearch(e),n="";if(!t.length){let t=document.createElement("p");return t.innerText=`No results for "${e}"`,resultsDiv.innerHTML="",void resultsDiv.appendChild(t)}n+='<div style="max-width:100%;">',t.forEach((e=>{e.tags&&e.tags.length>0?n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        <div class="header-meta">\n                            <div class="header-tags">\n                                ${e.tags.map((e=>'<a class="tag" href="JavaScript:Void(0);">#'+e+"</a>")).join("")}\n                            </div>\n                        </div>\n                        ${e.content}\n                    </div>\n                </div>`:n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        ${e.content}\n                    </div>\n                </div>`})),n+="</div>",resultsDiv.innerHTML=n}function truncate(e,t){return(e=e.replaceAll(/<[^>]*>/g,"")).length<t?e:e.substring(0,t-3)+"..."}function offlineSearch(e){let t=window.docs,n="#"===e[0]&&e.length>1?index.search(e.substring(1),[{field:"tags"}]):index.search(e,[{field:"title",limit:5},{field:"content",weight:10}]);const a=e=>{const t=n.filter((t=>t.field===e));return 0===t.length?[]:[...t[0].result]};return[...new Set([...a("title"),...a("content"),...a("tags")])].map((e=>{let n=t[e];return n.content=truncate(n.content,400),n.tags=n.tags.filter((e=>"gardenEntry"!=e&&"note"!=e)),n}))}window.lastSearch=""</script>
<main class="content cm-s-obsidian">
<header>
<h1 data-note-icon="">2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测</h1>
<div class="header-meta">
<div class="header-tags">
</div>
<div class="timestamps"><div><i icon-name="calendar-plus"></i> <span class="human-date" data-date="2025-06-09T10:30:59.884+08:00"></span></div><div><i icon-name="calendar-clock"></i> <span class="human-date" data-date="2024-12-15T23:30:51.000+08:00"></span></div></div></div>
</header>
<p>ccfa</p>
<p>IntDroid: Android Malware Detection Based on API Intimacy Analysis<br>
IntDroid：基于API亲密度分析的Android恶意软件检测</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image.png"><source media="(max-width:480px)" srcset="/img/optimized/SuHSLkGtO6-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/SuHSLkGtO6-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/SuHSLkGtO6-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/SuHSLkGtO6-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image.png" width=""></picture></p>
<h1 id="android" tabindex="-1">Android恶意软件检测的新方法</h1>
<p>Android作为最受欢迎的移动操作系统，吸引了全球数百万用户。与此同时，近年来新的Android恶意软件实例的数量呈指数级增长。一方面，现有的Android恶意软件检测系统已经证明，将程序语义提炼为图形表示，并通过进行图匹配来检测恶意程序，能够在检测Android恶意软件时达到高准确率。然而，这些传统的基于图的方法总是需要进行昂贵的程序分析，并且在恶意软件检测的可扩展性上表现不佳。另一方面，由于社交网络分析的高可扩展性，它已被应用于完成大规模的恶意软件检测。然而，基于社交网络分析的方法只考虑简单的语义信息（即中心性），用于实现市场范围内的移动恶意软件扫描，这可能在良性应用表现出与恶意软件相似的行为时限制检测的有效性。</p>
<p>在本文中，我们旨在将传统基于图的方法的高准确性与基于社交网络分析的方法的高可扩展性结合起来，用于Android恶意软件的检测。我们不使用传统的重量级静态分析，而是将应用的函数调用图视为复杂的社交网络，并应用基于社交网络的中心性分析来挖掘调用图中的中心节点。获取中心节点后，计算敏感API调用与中心节点之间的平均亲密度，以表示图的语义特征。我们在一个名为IntDroid的工具中实现了我们的方法，并在一个包含3,988个良性样本和4,265个恶意样本的数据集上进行评估。实验结果显示，IntDroid能够在保持99.1%的真阳性率的同时，检测Android恶意软件的F-measure达到97.1%。尽管其可扩展性不如基于社交网络分析的方法（即MalScan），与传统的基于图的方法相比，IntDroid的速度快了六倍以上。此外，在从GooglePlay市场收集的应用程序语料库中，IntDroid能够识别出28个能够规避现有工具检测的零日恶意软件，其中一个已被超过一千万用户下载并安装。这个应用还被VirusTotal中的六个反病毒扫描器标记为恶意软件，其中一个是赛门铁克移动洞察。</p>
<p><strong>CCS概念</strong></p>
<ul>
<li>安全与隐私 → 恶意软件及其缓解</li>
</ul>
<p><strong>关键词和短语</strong></p>
<ul>
<li>Android恶意软件，API亲密度，社交网络，中心性</li>
</ul>
<h1 id="1" tabindex="-1">1 引言</h1>
<p>在2018年第二季度，谷歌的Android系统进一步扩大了其相对于苹果iOS的领先优势，占据了88%的市场份额，而iOS仅占11.9%[4]。Android设备和应用程序（apps）的爆炸性增长也刺激了Android恶意软件的增长。全球数以百万计的Android用户从各种应用市场安装了应用程序。截至2018年第三季度末，新增恶意应用的数量较上年同期增长超过40%[3]。相应地，Android恶意软件的激增也引发了开发自动检测恶意软件方法的强烈热情。</p>
<p>总的来说，现有的移动恶意软件检测方法可以分为基于语法的方法[9, 12, 36, 46, 50, 53, 60]和基于语义的方法[10, 16, 24, 28, 43, 56-58]。在基于语法的技术中，例如，一些方法[46, 53]关注应用程序请求的权限并建立恶意软件检测模型。然而，恶意软件可以在不需要任何权限的情况下执行恶意活动[29]。此外，良性应用可能会请求超出必要的权限，这也会导致较高的误报率[20]。为了解决这个问题，Drebin[12]使用了广泛的静态分析来获取尽可能多的特征，这些特征包括权限和API调用。然而，由于缺乏程序行为的结构和上下文信息，它很容易被混淆技术规避。</p>
<p>为了克服这一挑战，一些系统提出将应用程序的程序语义提炼为图形表示，并通过图形匹配来检测恶意软件。实证研究[24, 28, 58]表明，这些基于图的技术在Android恶意软件检测方面具有很高的有效性。然而，图形匹配通常非常耗时，因为一个图通常包含数千个节点。例如，DroidSIFT[58]和Apposcopy[24]对一个应用程序的平均分析时间分别为175.8秒和275秒。换句话说，这些基于图的技术在检测移动恶意软件时存在可扩展性低的问题。</p>
<p>为了实现更具可扩展性的恶意软件检测，一种基于抽象的方法被提出，即MaMaDroid[43]，它利用从调用图获得的抽象序列来模拟应用程序的行为。具体来说，它建立了一个马尔可夫链模型来表示方法调用之间的转换，这些马尔可夫链代表应用程序执行的多个成对调用关系，并用于提取特征以完成分类。MaMaDroid中的方法调用抽象和马尔可夫链建模可以在检测移动恶意软件时实现稳健性和可扩展性。</p>
<p>然而，一些设计选择可能会限制MaMaDroid的有效性。首先，一阶马尔可夫链（即成对调用）无法完全反映方法调用之间的依赖关系，因此该方法缺乏将某些恶意应用与良性应用区分开来的关键信息。此外，粗粒度信息（即包级别信息而不是方法级别信息）可能无法准确区分良性应用和恶意软件。例如，android.telephony.TelephonyManager.getDeviceId()和android.telephony.SmsManager.sendTextMessage()都被抽象在android.telephony包中，而它们的用途和敏感程度完全不同。这些设计选择是可以理解的，因为使用整图分析（而不是仅考虑成对调用）和更细粒度的信息（即方法级别信息）可能会产生更高的成本，从而使大规模恶意软件扫描变得不可行。</p>
<p>为了解决上述问题，我们在之前的工作[54]中提出了MalScan来完成市场范围的移动恶意软件扫描。MalScan将应用程序的函数调用图视为复杂的社交网络，并对敏感API调用应用社交网络中心性分析来表示图形语义以进行恶意软件检测。然而，仅使用敏感API调用的中心性来进行恶意软件检测可能会在良性应用通过调用敏感API表现出与恶意软件类似行为时导致一些误报。在这种情况下，良性应用中某些敏感API调用的中心性可能与某些恶意软件中的几乎相同。例如，一些社交应用（如抖音）需要访问用户的位置以呈现特定位置的新闻或视频，并读取用户的通讯录以推荐新朋友。在这种情况下，敏感API调用LocationManager.getLastLocation()的中心性可能与某些恶意软件几乎相同，这可能会导致误报。</p>
<p>总之，一方面，传统的基于图分析的方法[24, 28, 43, 58]由于考虑了不同类型的程序语义，可以在Android恶意软件检测方面取得高效性。然而，这些方法的效率并不理想，因为一个图通常包含数千个节点，导致恶意软件检测的可扩展性较低。另一方面，基于社交网络分析的方法[54]由于社交网络分析的高可扩展性，能够完成市场范围的Android恶意软件扫描。然而，MalScan[54]仅考虑敏感API调用的中心性，这种简单的考虑可能会在应用程序通过调用敏感API表现出与恶意软件类似行为时限制检测效果。</p>
<p>因此，我们提出一个研究问题：是否有办法将传统基于图分析方法的高效性与基于社交网络分析方法的高可扩展性相结合，用于Android恶意软件检测？</p>
<p>在本文中，我们旨在解决上述研究问题。为了实现传统基于图分析方法和基于社交网络分析方法之间的结合和平衡，我们首先利用社交网络中心性分析对整个图进行挖掘，找出最重要的节点（即中心节点）。然后应用传统图分析来计算这些节点与敏感API调用之间的亲密度作为语义特征，这些特征提供了更有效的图细节来区分恶意软件和良性应用。</p>
<p>我们的关键洞察来源于对日常生活社交网络的观察。我们发现，一个人在不同的社交网络中可能会表现出与相应社交网络中心人物之间不同的亲密度（即通信频率）。在恶意软件检测的背景下，由于良性应用（例如，提供实用功能）和恶意软件（例如，最大化利润，延长生命周期）[57]的固有目标不同，一个API方法可能在不同的函数调用网络中与中心节点有不同的通信频率。</p>
<p>具体来说，为了维持程序语义，我们首先基于静态分析提取应用程序的函数调用图。给定一个调用图，我们然后应用中心性分析来发掘图中的中心节点。中心性的概念最初是在社交网络分析中提出的，其原始目标是量化网络中顶点的重要性。我们利用方法调用中心性的分析结果来找到具有高中心性的节点（即中心节点）。此外，由于恶意软件总是调用一些敏感API来执行恶意活动，我们关注这些API调用。因此，在获得图中的中心节点后，我们进行亲密度分析来计算敏感API调用和中心节点之间的平均亲密度。我们对调用图中两个节点之间亲密度的定义包括两个影响因素：(1)可达路径的数量和(2)平均路径距离。换句话说，可达路径数量越多，平均路径距离越短，两个节点之间的亲密度就越高。这些计算出的亲密度被用作特征，并输入机器学习分类器以训练模型并对新给定的特征向量进行分类。</p>
<p>我们实现了一个原型系统IntDroid，并使用3,988个良性样本和4,265个恶意样本进行评估。实验结果表明，IntDroid能够以97.1%的F-measure检测Android恶意软件，同时真阳性率能够保持在99.1%。在可扩展性方面，由于亲密度分析的过程，IntDroid不如基于社交网络分析的方法（即MalScan[54]）快，但与最先进的传统基于图的方法（即MaMaDroid[43]）相比，IntDroid的时间开销减少了六倍多。</p>
<p>我们还检验了IntDroid在检测零日恶意软件方面的能力。具体来说，在从GooglePlay市场收集的应用程序语料库中，IntDroid能够识别28个可以逃避现有工具检测的零日恶意软件，其中一个已被超过一千万用户下载和安装。这个应用程序也被VirusTotal中的六个防病毒扫描器标记为恶意软件，其中之一是赛门铁克移动洞察。</p>
<p>总之，本文做出了以下贡献：</p>
<ul>
<li>
<p>我们提出了一种新方法，通过分析函数调用图中敏感API调用与中心节点之间的亲密度来检测Android恶意软件。</p>
</li>
<li>
<p>我们设计并实现了一个原型系统IntDroid，将传统基于图分析方法的高效性与基于社交网络分析方法的高可扩展性相结合，以检测Android恶意软件。</p>
</li>
<li>
<p>我们使用3,988个良性样本和4,265个恶意样本进行评估。实验结果表明，IntDroid能够以97.1%的F-measure和99.1%的真阳性率检测Android恶意软件。此外，与传统的基于图的方法相比，IntDroid比MaMaDroid[43]快六倍多。</p>
</li>
</ul>
<p>文章组织。本文的其余部分组织如下。第2节介绍我们的动机。第3节展示定义。第4节介绍我们的系统。第5节报告实验结果。第6节介绍与MalScan的广泛比较。第7节讨论未来工作和局限性。第8节描述相关工作。第9节总结本文。</p>
<h1 id="2" tabindex="-1">2 动机</h1>
<p>为了理解关键洞察，我们检查了一个良性应用和一个恶意应用的API调用网络。这个良性应用是一个为Android提供更安全体验的移动安全应用，而恶意应用则允许追踪丢失的手机。我们分析了这两个应用的API调用并创建了函数调用图。这些应用的函数调用图可以被视为API调用网络。节点代表函数，边代表它们之间的通信。边的方向用于帮助区分图中的调用者和被调用者。例如，在图1中，从节点MainActivity.onResume()到节点PreferenceManager.getDefaultSharedPreferences()的边表示从函数MainActivity.onResume()到函数PreferenceManager.getDefaultSharedPreferences()的调用路径。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-5.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-5.png"><source media="(max-width:480px)" srcset="/img/optimized/SO02YR3QwP-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/SO02YR3QwP-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/SO02YR3QwP-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/SO02YR3QwP-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-5.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-5.png" width=""></picture></p>
<p>对于每个API调用网络，我们基于节点度选择一个中心节点。如图1所示，良性应用网络以节点MainActivity.onResume()为中心，向外连接到PreferenceManager.AccountManager()等节点。恶意应用网络以节点SmsReceiver.onReceive()为中心，向外连接到TelephonyManager.DevicePolicyManager()等节点。函数MainActivity.onResume()和SmsReceiver.onReceive()是生命周期方法，因此它们具有高度。应用开发者重写这些函数以进行特定实现，这通常涉及对其他API的多次调用。这些API调用中有许多属于敏感方法[13]，在这种情况下，我们将它们称为敏感API调用。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-6.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-6.png"><source media="(max-width:480px)" srcset="/img/optimized/YKhNq1OVsW-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/YKhNq1OVsW-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/YKhNq1OVsW-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/YKhNq1OVsW-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-6.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-6.png" width=""></picture></p>
<p>图1中边的权重表示两个节点之间的通信频率。权重越高，从中心节点到API的调用就越频繁。表1分别展示了图1中节点PreferenceManager.getDefaultSharedPreferences()、TelephonyManager.getDeviceId()与MainActivity.onResume()、SmsReceiver.onReceive()之间的通信频率。如果我们将亲密度定义为两个函数之间的通信频率，那么从图1和表1中呈现的结果可以看出，由于PreferenceManager.getDefaultSharedPreferences()和TelephonyManager.getDeviceId()的不同目标，它们与中心节点之间的亲密度是不同的。</p>
<p>基于这个观察，我们提出一个问题：恶意应用中敏感API调用与中心节点之间的亲密度是否与良性应用中敏感API调用与中心节点之间的亲密度不同？</p>
<p>为了回答这个问题，我们从AndroZoo[11]中随机选择了500个良性应用和500个恶意应用。然后基于静态分析提取函数调用图。给定一个调用图，我们选择度值排名前1%的节点作为调用图中的中心节点。在获得调用图中的中心节点后，我们计算敏感API调用和中心节点之间的亲密度。如前所述，我们简单地将亲密度定义为社交网络中两个人之间的通信频率。因此，为了更精确地定义函数调用图中两个节点之间的亲密度，我们选择了以下两个影响因素：(1)可达路径的数量和(2)平均路径距离。换句话说，可达路径数量越多，平均路径距离越短，两个节点之间的亲密度就越高。第4节将展示一个更详细的真实世界示例。</p>
<p>我们从安全敏感方法列表[13]中选择了前缀为android.telephony.TelephonyManager.get的API调用作为测试对象。在计算调用图中敏感API调用与中心节点之间的所有亲密度后，我们收集这些亲密度的平均值。事实上，由于我们随机选择的数据集规模较小，仅包含500个良性应用和500个恶意应用，一些敏感API调用并未出现在这些应用中。在这种情况下，平均亲密度值都为零，因此，我们只考虑同时被良性应用和恶意应用调用的API。最终，PScout[13]中前缀为android.telephony.TelephonyManager.get的满足条件的API调用总数为14个。由于页面限制，我们只展示部分结果。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-7.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-7.png"><source media="(max-width:480px)" srcset="/img/optimized/c2LgW0fuXe-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/c2LgW0fuXe-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/c2LgW0fuXe-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/c2LgW0fuXe-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-7.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-7.png" width=""></picture></p>
<p>图2显示了三个敏感API调用的平均亲密度分布：(1)TelephonyManager.getDeviceID()可以获取手机的国际移动设备识别码（IMEI），(2)TelephonyManager.getLine1Number()可以获取手机号码，(3)TelephonyManager.getSubscriberld()可以获取手机的国际移动用户识别码（IMSI）。图2中的结果表明，良性应用和恶意应用中敏感API调用与调用图中中心节点之间的平均亲密度存在差异。</p>
<p>为了获得更确定的结果，我们首先进行Shapiro-Wilk测试[51]来检查平均亲密度是否呈正态分布。在获得测试结果后，我们发现这些敏感API调用与中心节点之间的平均亲密度不符合正态分布。因此，我们采用非参数检验（即Mann-Whitney U检验[41]），该检验对正态性偏差具有鲁棒性。Mann-Whitney U检验的零假设是两个总体具有相同的均值，备择假设是两个总体的均值不同。第一类错误率或显著性水平是在零假设为真时拒绝零假设的概率。如果计算出的p值小于预先确定的阈值α（称为显著性水平），则拒绝零假设。通常，显著性水平设置为0.05，这意味着可以接受5%的概率错误地拒绝真实的零假设。</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>API调用</th>
<th>P值</th>
</tr>
</thead>
<tbody>
<tr>
<td>TelephonyManager.getSimOperator()</td>
<td>0.054473</td>
</tr>
<tr>
<td>TelephonyManager.getSimState()</td>
<td>0.014292</td>
</tr>
<tr>
<td>TelephonyManager.getNetworkType()</td>
<td>0.004563</td>
</tr>
<tr>
<td>TelephonyManager.getNetworkCountryIso()</td>
<td>0.000743</td>
</tr>
<tr>
<td>TelephonyManager.getSimOperatorName()</td>
<td>3.02E-05</td>
</tr>
<tr>
<td>TelephonyManager.getPhoneType()</td>
<td>6.81E-18</td>
</tr>
<tr>
<td>TelephonyManager.getSimSerialNumber()</td>
<td>8.43E-29</td>
</tr>
<tr>
<td>TelephonyManager.getLine1Number()</td>
<td>5.36E-31</td>
</tr>
<tr>
<td>TelephonyManager.getDeviceID()</td>
<td>3.59E-36</td>
</tr>
<tr>
<td>TelephonyManager.getSimCountryIso()</td>
<td>6.09E-47</td>
</tr>
<tr>
<td>TelephonyManager.getNetworkOperator()</td>
<td>1.36E-55</td>
</tr>
<tr>
<td>TelephonyManager.getSubscriberId()</td>
<td>5.43E-63</td>
</tr>
<tr>
<td>TelephonyManager.getCellLocation()</td>
<td>9.75E-97</td>
</tr>
<tr>
<td>TelephonyManager.getNetworkOperatorName()</td>
<td>5.6E-118</td>
</tr>
</tbody>
</table></div>
<p>我们使用Mann-Whitney U检验来实验这些API调用，以检验良性应用和恶意应用之间API亲密度的差异。表2展示了14个前缀为android.telephony.TelephonyManager.get的API调用在良性应用和恶意应用之间平均亲密度的p值。如表2所示，我们可以看到大多数p值小于0.05。换句话说，对于表2中的大多数API调用，我们可以拒绝零假设。因此，基于这个观察，我们提出并开发了一个通过分析函数调用图中敏感API调用与中心节点之间的平均亲密度来自动检测Android恶意软件的系统。</p>
<h1 id="3" tabindex="-1">3 定义</h1>
<p>在介绍我们提出的方法之前，我们首先描述本文中使用的正式定义。</p>
<h2 id="3-1" tabindex="-1">3.1 中心性</h2>
<p>中心性概念最初是在社交网络分析中发展起来的，它量化了节点在网络中的重要性。中心性度量对网络分析非常有用，许多研究已经提出在不同领域使用中心性度量，例如：生物网络[34]、合著网络[39]、交通网络[30]、犯罪网络[18]、附属网络[22]等。在社交网络中已经提出了几种中心性的定义，例如：</p>
<p>定义1. 节点的度中心性[26]是指它与其他节点相连的比例。度中心性值通过除以图中可能的最大度数（N-1，其中N是图中节点的数量）来进行归一化：</p>
<mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-1.738ex" xmlns="http://www.w3.org/2000/svg" width="14.015ex" height="5.041ex" role="img" focusable="false" viewBox="0 -1460 6194.6 2228" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1306,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1972.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(3028.6,0)"><g data-mml-node="mrow" transform="translate(220,710)"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(986,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1463,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1852,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2337,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g><g data-mml-node="mrow" transform="translate(277.8,-686)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1110.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(2110.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g></g><rect width="2926" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;overflow:hidden;width:100%"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>x</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac></math></mjx-assistive-mml></mjx-container><p>其中<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="6.167ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2726 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(520,0)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(986,0)"><path data-c="1D454" d="M311 43Q296 30 267 15T206 0Q143 0 105 45T66 160Q66 265 143 353T314 442Q361 442 401 394L404 398Q406 401 409 404T418 412T431 419T447 422Q461 422 470 413T480 394Q480 379 423 152T363 -80Q345 -134 286 -169T151 -205Q10 -205 10 -137Q10 -111 28 -91T74 -71Q89 -71 102 -80T116 -111Q116 -121 114 -130T107 -144T99 -154T92 -162L90 -164H91Q101 -167 151 -167Q189 -167 211 -155Q234 -144 254 -122T282 -75Q288 -56 298 -13Q311 35 311 43ZM384 328L380 339Q377 350 375 354T369 368T359 382T346 393T328 402T306 405Q262 405 221 352Q191 313 171 233T151 117Q151 38 213 38Q269 38 323 108L331 118L384 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1463,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1852,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2337,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mi>e</mi><mi>g</mi><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>是节点<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="1.097ex" height="1.027ex" role="img" focusable="false" viewBox="0 -443 485 454" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>v</mi></math></mjx-assistive-mml></mjx-container>的度数，<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:0" xmlns="http://www.w3.org/2000/svg" width="2.009ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 888 683" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></mjx-assistive-mml></mjx-container>是图中节点的总数。</p>
<p>定义2. Katz中心性[35]基于节点邻居的中心性来计算节点的中心性。节点i的katz中心性为：</p>
<mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-3.006ex" xmlns="http://www.w3.org/2000/svg" width="19.803ex" height="5.155ex" role="img" focusable="false" viewBox="0 -950 8752.9 2278.6" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g></g><g data-mml-node="mo" transform="translate(1176.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2232.5,0)"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" style="stroke-width:3"></path></g><g data-mml-node="munder" transform="translate(3039.2,0)"><g data-mml-node="mo"><path data-c="2211" d="M60 948Q63 950 665 950H1267L1325 815Q1384 677 1388 669H1348L1341 683Q1320 724 1285 761Q1235 809 1174 838T1033 881T882 898T699 902H574H543H251L259 891Q722 258 724 252Q725 250 724 246Q721 243 460 -56L196 -356Q196 -357 407 -357Q459 -357 548 -357T676 -358Q812 -358 896 -353T1063 -332T1204 -283T1307 -196Q1328 -170 1348 -124H1388Q1388 -125 1381 -145T1356 -210T1325 -294L1267 -449L666 -450Q64 -450 61 -448Q55 -446 55 -439Q55 -437 57 -433L590 177Q590 178 557 222T452 366T322 544L56 909L55 924Q55 945 60 948Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(576.3,-1084.4) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g></g><g data-mml-node="msub" transform="translate(4649.8,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(783,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(345,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="msub" transform="translate(6018.1,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g></g><g data-mml-node="mo" transform="translate(7186.7,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(8186.9,0)"><path data-c="1D6FD" d="M29 -194Q23 -188 23 -186Q23 -183 102 134T186 465Q208 533 243 584T309 658Q365 705 429 705H431Q493 705 533 667T573 570Q573 465 469 396L482 383Q533 332 533 252Q533 139 448 65T257 -10Q227 -10 203 -2T165 17T143 40T131 59T126 65L62 -188Q60 -194 42 -194H29ZM353 431Q392 431 427 419L432 422Q436 426 439 429T449 439T461 453T472 471T484 495T493 524T501 560Q503 569 503 593Q503 611 502 616Q487 667 426 667Q384 667 347 643T286 582T247 514T224 455Q219 439 186 308T152 168Q151 163 151 147Q151 99 173 68Q204 26 260 26Q302 26 349 51T425 137Q441 171 449 214T457 279Q457 337 422 372Q380 358 347 358H337Q258 358 258 389Q258 396 261 403Q275 431 353 431Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;overflow:hidden;width:100%"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>α</mi><munder><mo data-mjx-texclass="OP">∑</mo><mi>j</mi></munder><msub><mi>A</mi><mrow data-mjx-texclass="ORD"><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mi>j</mi></msub><mo>+</mo><mi>β</mi></math></mjx-assistive-mml></mjx-container><p>注意，A是图G的邻接矩阵，其特征值为λ。参数β控制初始中心性，且<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-1.033ex" xmlns="http://www.w3.org/2000/svg" width="8.765ex" height="2.99ex" role="img" focusable="false" viewBox="0 -864.9 3874 1321.5" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D6FC" d="M34 156Q34 270 120 356T309 442Q379 442 421 402T478 304Q484 275 485 237V208Q534 282 560 374Q564 388 566 390T582 393Q603 393 603 385Q603 376 594 346T558 261T497 161L486 147L487 123Q489 67 495 47T514 26Q528 28 540 37T557 60Q559 67 562 68T577 70Q597 70 597 62Q597 56 591 43Q579 19 556 5T512 -10H505Q438 -10 414 62L411 69L400 61Q390 53 370 41T325 18T267 -2T203 -11Q124 -11 79 39T34 156ZM208 26Q257 26 306 47T379 90L403 112Q401 255 396 290Q382 405 304 405Q235 405 183 332Q156 292 139 224T121 120Q121 71 146 49T208 26Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(917.8,0)"><path data-c="3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(1973.6,0)"><g data-mml-node="mn" transform="translate(773.4,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g><g data-mml-node="msub" transform="translate(220,-345) scale(0.707)"><g data-mml-node="mi"><path data-c="1D706" d="M166 673Q166 685 183 694H202Q292 691 316 644Q322 629 373 486T474 207T524 67Q531 47 537 34T546 15T551 6T555 2T556 -2T550 -11H482Q457 3 450 18T399 152L354 277L340 262Q327 246 293 207T236 141Q211 112 174 69Q123 9 111 -1T83 -12Q47 -12 47 20Q47 37 61 52T199 187Q229 216 266 252T321 306L338 322Q338 323 288 462T234 612Q214 657 183 657Q166 657 166 673Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(616,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g></g></g><rect width="1660.4" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi><mo>&lt;</mo><mfrac><mn>1</mn><msub><mi>λ</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mfrac></math></mjx-assistive-mml></mjx-container>。katz中心性通过测量直接邻居（一度节点）的数量以及通过这些直接邻居与考虑中的节点相连的图中所有其他节点来计算节点在图中的相对影响力。</p>
<p>定义3. 接近中心性[26]表示一个节点与网络中所有其他节点的接近程度。它被计算为从该节点到图中每个其他节点的最短路径长度的平均值。节点的平均最短距离越小，该节点的接近中心性就越大。换句话说，平均最短距离和相应的接近中心性呈负相关：</p>
<mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-2.596ex" xmlns="http://www.w3.org/2000/svg" width="17.111ex" height="5.671ex" role="img" focusable="false" viewBox="0 -1359 7563.2 2506.4" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g></g><g data-mml-node="mo" transform="translate(1176.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(2232.5,0)"><g data-mml-node="mrow" transform="translate(1360.1,676)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1110.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(2110.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="munder"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1123,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mi" transform="translate(2391.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2911.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3300.1,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(3645.1,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(4089.7,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4501.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g><rect width="5090.7" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;overflow:hidden;width:100%"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow><mrow><munder><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></munder><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container><p>注意，<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="5.655ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2499.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(520,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(909,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1254,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1698.7,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2110.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>是节点i和j之间的距离，N是图中节点的数量。</p>
<p>定义4. 谐波中心性[42]在接近中心性的定义中反转了求和和倒数运算：</p>
<mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-1.738ex" xmlns="http://www.w3.org/2000/svg" width="16.184ex" height="5.973ex" role="img" focusable="false" viewBox="0 -1872 7153.3 2640" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(605,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g></g><g data-mml-node="mo" transform="translate(1176.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(2232.5,0)"><g data-mml-node="mrow" transform="translate(220,1007.1)"><g data-mml-node="munder"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1123,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mfrac" transform="translate(2391.1,0)"><g data-mml-node="mn" transform="translate(868.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g><g data-mml-node="mrow" transform="translate(220,-370.3) scale(0.707)"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(520,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(909,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1254,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1532,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1944,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g><rect width="1849.7" height="60" x="120" y="220"></rect></g></g><g data-mml-node="mrow" transform="translate(1155.2,-686)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1110.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(2110.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g></g><rect width="4680.8" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;overflow:hidden;width:100%"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><munder><mo data-mjx-texclass="OP">∑</mo><mrow data-mjx-texclass="ORD"><mi>i</mi><mo>≠</mo><mi>j</mi></mrow></munder><mfrac><mn>1</mn><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></mfrac></mrow><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></mfrac></math></mjx-assistive-mml></mjx-container><p>注意，<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="5.655ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2499.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(520,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(909,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1254,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1698.7,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2110.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>是节点i和j之间的距离，N是图中节点的数量。</p>
<h2 id="3-2" tabindex="-1">3.2 亲密度</h2>
<p>一方面，如果两个函数之间存在更多的可达路径，那么这两个函数之间的&quot;通信&quot;可以被认为是频繁的。另一方面，如果两个函数之间的距离较短，那么它们之间的&quot;通信&quot;可以被认为是容易的。在本文中，如果两个函数之间的&quot;通信&quot;是频繁且容易的，那么它们将被视为一对亲密的函数。</p>
<p>定义5. 给定一个函数调用图<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="11.03ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4875.2 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1063.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2119.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2508.6,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(3277.6,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3722.2,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4486.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mo>=</mo><mo stretchy="false">(</mo><mi>V</mi><mo>,</mo><mi>E</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>，以及两个函数<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="7.679ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 3394.2 888" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(529,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(973.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1680.4,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2625.2,0)"><path data-c="1D449" d="M52 648Q52 670 65 683H76Q118 680 181 680Q299 680 320 683H330Q336 677 336 674T334 656Q329 641 325 637H304Q282 635 274 635Q245 630 242 620Q242 618 271 369T301 118L374 235Q447 352 520 471T595 594Q599 601 599 609Q599 633 555 637Q537 637 537 648Q537 649 539 661Q542 675 545 679T558 683Q560 683 570 683T604 682T668 681Q737 681 755 683H762Q769 676 769 672Q769 655 760 640Q757 637 743 637Q730 636 719 635T698 630T682 623T670 615T660 608T652 599T645 592L452 282Q272 -9 266 -16Q263 -18 259 -21L241 -22H234Q216 -22 216 -15Q213 -9 177 305Q139 623 138 626Q133 637 76 637H59Q52 642 52 648Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi><mo>∈</mo><mi>V</mi></math></mjx-assistive-mml></mjx-container>，那么a和b之间的亲密度定义为：</p>
<mjx-container class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-2.172ex" xmlns="http://www.w3.org/2000/svg" width="29.157ex" height="4.701ex" role="img" focusable="false" viewBox="0 -1118 12887.3 2078" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(345,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(945,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1306,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1651,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2529,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3058,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3491,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(3981,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(4370,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4899,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(5343.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(5772.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(6439.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(7495.2,0)"><g data-mml-node="mi" transform="translate(2396.1,676)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mrow" transform="translate(220,-710)"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1049,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1438,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1967,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2411.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2840.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(3451.9,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(4452.1,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g></g><rect width="5152.1" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;overflow:hidden;width:100%"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>i</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>m</mi><mi>a</mi><mi>c</mi><mi>y</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mi>n</mi><mrow><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mfrac></math></mjx-assistive-mml></mjx-container><p>注意，n表示a和b之间可达路径的数量，<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="7.307ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3229.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1049,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1438,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1967,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2411.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2840.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>表示这些可达路径的平均距离。例如，假设a和b之间有两条可达路径：<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.439ex" xmlns="http://www.w3.org/2000/svg" width="14.904ex" height="2.009ex" role="img" focusable="false" viewBox="0 -694 6587.7 888" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(806.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2084.6,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2865.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(4143.1,0)"><path data-c="1D45E" d="M33 157Q33 258 109 349T280 441Q340 441 372 389Q373 390 377 395T388 406T404 418Q438 442 450 442Q454 442 457 439T460 434Q460 425 391 149Q320 -135 320 -139Q320 -147 365 -148H390Q396 -156 396 -157T393 -175Q389 -188 383 -194H370Q339 -192 262 -192Q234 -192 211 -192T174 -192T157 -193Q143 -193 143 -185Q143 -182 145 -170Q149 -154 152 -151T172 -148Q220 -148 230 -141Q238 -136 258 -53T279 32Q279 33 272 29Q224 -10 172 -10Q117 -10 75 30T33 157ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4880.9,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(6158.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false">→</mo><mi>p</mi><mo stretchy="false">→</mo><mi>q</mi><mo stretchy="false">→</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container>和<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.025ex" xmlns="http://www.w3.org/2000/svg" width="11.193ex" height="1.595ex" role="img" focusable="false" viewBox="0 -694 4947.1 705" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(806.8,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2084.6,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(3240.3,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(4518.1,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false">→</mo><mi>m</mi><mo stretchy="false">→</mo><mi>b</mi></math></mjx-assistive-mml></mjx-container>。那么可达路径的数量n为2，平均距离<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="7.307ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 3229.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(529,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1049,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1438,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1967,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2411.7,0)"><path data-c="1D44F" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2840.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container>为<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="14.959ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6612 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(389,0)"><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1111.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(2111.4,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2611.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3000.4,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z" style="stroke-width:3"></path></g></g><g data-mml-node="mn" transform="translate(3500.4,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4278.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(5334,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>3</mn><mo>+</mo><mn>2</mn><mo stretchy="false">)</mo><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mn>2.5</mn></math></mjx-assistive-mml></mjx-container>。因此，a和b之间的亲密度可以计算为<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.566ex" xmlns="http://www.w3.org/2000/svg" width="17.851ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7890 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(500,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z" style="stroke-width:3"></path></g></g><g data-mml-node="mo" transform="translate(1000,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(1389,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z" style="stroke-width:3"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2889.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3889.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4389.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(5056.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(6112,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z" style="stroke-width:3"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(500,0)" style="stroke-width:3"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(778,0)" style="stroke-width:3"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(1278,0)" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mn>2.5</mn><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>0.57</mn></math></mjx-assistive-mml></mjx-container>。此外，当中心节点是敏感API调用时存在一个特殊情况。在这种情况下，API调用和中心节点之间的平均距离将为0，这就是为什么在亲密度的定义中分母要加1的原因。</p>
<h1 id="4" tabindex="-1">4 系统架构</h1>
<p>在本节中，我们介绍IntDroid，一个基于函数调用图中敏感API调用和中心函数调用之间亲密度分析的自动Android恶意软件检测系统。算法1展示了我们系统的完整流程。</p>
<h2 id="4-1" tabindex="-1">4.1 概述</h2>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-8.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-8.png"><source media="(max-width:480px)" srcset="/img/optimized/7aBHsLjyxN-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/7aBHsLjyxN-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/7aBHsLjyxN-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/7aBHsLjyxN-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-8.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-8.png" width=""></picture></p>
<p>如图3所示，IntDroid包含四个主要阶段：静态分析、中心性分析、亲密度分析和分类。</p>
<ul>
<li>
<p>静态分析：这个阶段旨在基于静态分析提取应用程序的函数调用图，其中每个节点是一个函数，可以是API调用或用户定义的函数。</p>
</li>
<li>
<p>中心性分析：在获得函数调用图后，我们计算调用图中所有节点的中心性。中心性排名前n%的节点将被选为中心节点。</p>
</li>
<li>
<p>亲密度分析：接下来，我们计算函数调用图中敏感API调用和中心节点之间的平均亲密度。这个阶段的输出是特征向量。</p>
</li>
<li>
<p>分类：在最后阶段，给定特征向量，我们可以使用机器学习分类器准确且高效地将应用程序分类为良性或恶意。</p>
</li>
</ul>
<h2 id="4-2" tabindex="-1">4.2 静态分析</h2>
<p>在本文中，我们旨在将基于图的方法的有效性与基于社交网络分析的方法的可扩展性相结合。因此，我们通过对给定的APK文件执行低成本的程序分析（例如，上下文不敏感和流不敏感分析）来提取简洁的函数调用图。具体来说，我们基于Android逆向工程工具Androguard[19]实现静态分析。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-9.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-9.png"><source media="(max-width:480px)" srcset="/img/optimized/pnUZwMOuu2-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/pnUZwMOuu2-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/pnUZwMOuu2-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/pnUZwMOuu2-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-9.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-9.png" width=""></picture></p>
<p>为了更好地说明我们系统中涉及的不同阶段，我们选择了一个真实世界的恶意软件样本。图4显示了该样本的函数调用图，其中每个节点是一个API调用或用户定义的函数。节点和边的数量分别为140和251。</p>
<div class="callout" data-callout="note"><div class="callout-title"><div class="callout-title-inner"> 算法1：提取调用图中敏感API调用和中心节点之间的平均亲密度</div></div>
<div class="callout-content">
<p>
<pre><code>输入：
    A: 一个APK文件
    t: 用于挖掘中心节点的中心性度量类型
    n: 中心性排名前n%的节点将被选为中心节点
    S: 敏感API调用列表

输出：
    AI: 敏感API调用和中心节点之间的平均亲密度

1:  CG ← extractCallGraph(A)
2:  V ← obtainNodes(CG)
3:  for each v ∈ V do
4:      centrality ← computeCentrality(CG, v, t)
5:      Centralities.add(centrality)
6:  end for
7:  for each v ∈ V do
8:      ranking ← computeRanking(Centralities, v)
9:      if ranking/len(V) ≤ n% then
10:         CenterNodes.add(v)
11:     end if
12: end for
13: for each s ∈ S do
14:     for each c ∈ CenterNodes do
15:         i ← computeIntimacy(CG, s, c)
16:         I.add(i)
17:     end for
18:     ai ← computeAverageIntimacy(I)
19:     AI.add(ai)
20: end for
21: return AI
</code></pre>
</p></div></div>
<h2 id="4-3" tabindex="-1">4.3 中心性分析</h2>
<p>如前所述，我们将函数调用图视为社交网络。因此，在这个阶段，我们的目标是挖掘调用图社交网络中最重要的&quot;人物&quot;。这个阶段对应算法1中的第2-12行。由于中心性度量可以表示节点在网络中的重要性，我们执行中心性分析来选择调用图中的中心节点。给定一个调用图，我们计算图中所有节点的中心性。中心性排名前n%的节点将被视为中心节点。为了进行更全面的实验，我们选取了八个不同的n值，分别是1、2、3、4、5、6、7和8。此外，对于中心性度量，我们选择度中心性、katz中心性、接近中心性和谐波中心性来开展实验。</p>
<p>另外，由于不同的中心性从不同角度衡量顶点的重要性，因此顶点的重要性通常需要使用多个中心性来衡量。因此，为了研究的完整性，我们通过整合四个单独的中心性度量构造了另外两个中心性。一个是通过计算前四个中心性度量的平均值得到的平均中心性，另一个是通过合并四个单独中心性度量获得的中心节点得到的全中心性。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-10.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-10.png"><source media="(max-width:480px)" srcset="/img/optimized/crUkXJn00i-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/crUkXJn00i-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/crUkXJn00i-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/crUkXJn00i-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-10.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-10.png" width=""></picture></p>
<p>如图5所示，假设在度中心性分析后，我们在图4中选择node1和node2作为中心节点。类似地，在接近中心性、谐波中心性和katz中心性分析后，中心节点分别是(node1, node3)、(node2, node4)和(node3, node5)。然后将这四个中心节点结果的并集计算为全中心性的中心节点，即node1、node2、node3、node4和node5。</p>
<p>如图4所示，我们首先计算所有节点的度中心性。为了在图4中更清晰地呈现，我们使用度中心性作为节点大小的权重（即度中心性越大，节点越大）。图4中函数调用图的节点数为140，因此，我们选择度中心性排名前24的节点作为中心节点，即NqUtils$1.run()和NqUtils$2.run()。我们将这两个节点标记为黄色，以区别于图4中的其他节点。</p>
<h2 id="4-4" tabindex="-1">4.4 亲密度分析</h2>
<p>由于API调用被Android应用用于访问操作系统功能和系统资源，它们可以用作Android应用行为的表示。特别是，Android恶意软件通常调用一些与安全相关的API调用来执行恶意活动。例如，getDeviceID()可以获取手机的IMEI，getLine1Number()可以获取手机号码。因此，为了表征恶意行为，我们基于PScout[13]报告的结果关注这些与安全相关的API调用，即敏感API调用，其中包含21,986个敏感API调用。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-11.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-11.png"><source media="(max-width:480px)" srcset="/img/optimized/6rFCxLi7JQ-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/6rFCxLi7JQ-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/6rFCxLi7JQ-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/6rFCxLi7JQ-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-11.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-11.png" width=""></picture></p>
<p>算法1中的第13-21行显示了亲密度分析。在计算敏感API调用和中心节点之间的所有亲密度后，我们使用这些亲密度的平均值作为该敏感API调用的相应特征。例如，在度中心性分析后，我们选择NqUtils$1.run()和NqUtils$2.run()作为中心节点，并在图4中将它们标记为黄色。我们选择敏感API调用TelephonyManager.getDeviceID()作为示例来说明亲密度分析的详细步骤。</p>
<p>如图6所示，我们首先执行可达性分析以获得TelephonyManager.getDeviceID()和中心节点（即NqUtils$1.run()和NqUtils$2.run()）之间的可达路径。图4中的结果显示，TelephonyManager.getDeviceID()和NqUtils$1.run()之间有一条路径：NqUtils$1.run() → NqUtils.access$3() → NqUtils.getRequestJson() → NqUtils.getIMEI() → TelephonyManager.getDeviceID()。也就是说，可达路径的数量为1（即n=1），平均距离为4（即ad=4）。因此，TelephonyManager.getDeviceID()和NqUtils$1.run()之间的亲密度为1/(4+1)=0.2。类似地，TelephonyManager.getDeviceID()和另一个中心节点NqUtils$2.run()之间也有一条路径，它们之间的亲密度也是1/(4+1)=0.2。然后这两个亲密度的平均值可以计算为(0.2+0.2)/2=0.2，换句话说，TelephonyManager.getDeviceID()的特征是0.2。此外，在特征向量中，未出现在函数调用图中的其他敏感API调用用0表示。</p>
<h2 id="4-5" tabindex="-1">4.5 分类</h2>
<p>我们的最后阶段关注分类，即将应用标记为良性或恶意。为此，我们选择了三种不同的分类算法：1-最近邻(1-NN)、3-最近邻(3-NN)和随机森林(RF)来完成分类。从训练数据集提取的特征向量被输入到学习模型中以训练分类器，然后在测试数据集上执行分类。</p>
<h1 id="5" tabindex="-1">5 评估</h1>
<p>在本节中，我们旨在回答以下研究问题：</p>
<ul>
<li>RQ1：IntDroid在从不同方面检测Android恶意软件的有效性如何？</li>
<li>RQ2：与其他最先进的Android恶意软件检测方法相比，IntDroid的有效性如何？</li>
<li>RQ3：IntDroid在检测Android恶意软件时的运行时开销是多少？</li>
<li>RQ4：IntDroid能否检测零日恶意软件？</li>
</ul>
<hr>
<p>表3. 我们实验中使用的数据集摘要</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>类别</th>
<th>应用数量</th>
<th>平均大小 (MB)</th>
</tr>
</thead>
<tbody>
<tr>
<td>良性应用</td>
<td>3,988</td>
<td>3.45</td>
</tr>
<tr>
<td>恶意应用</td>
<td>4,265</td>
<td>3.97</td>
</tr>
<tr>
<td>总计</td>
<td>8,253</td>
<td>3.72</td>
</tr>
</tbody>
</table></div>
<hr>
<p>表4. 我们实验中使用的指标描述</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>指标</th>
<th>缩写</th>
<th>定义</th>
</tr>
</thead>
<tbody>
<tr>
<td>真阳性</td>
<td>TP</td>
<td>正确分类为恶意的样本数</td>
</tr>
<tr>
<td>真阴性</td>
<td>TN</td>
<td>正确分类为良性的样本数</td>
</tr>
<tr>
<td>假阳性</td>
<td>FP</td>
<td>错误分类为恶意的样本数</td>
</tr>
<tr>
<td>假阴性</td>
<td>FN</td>
<td>错误分类为良性的样本数</td>
</tr>
<tr>
<td>真阳性率</td>
<td>TPR</td>
<td>TP/(TP+FN)</td>
</tr>
<tr>
<td>假阴性率</td>
<td>FNR</td>
<td>FN/(TP+FN)</td>
</tr>
<tr>
<td>真阴性率</td>
<td>TNR</td>
<td>TN/(TN+FP)</td>
</tr>
<tr>
<td>假阳性率</td>
<td>FPR</td>
<td>FP/(TN+FP)</td>
</tr>
<tr>
<td>准确率</td>
<td>A</td>
<td>(TP+TN)/(TP+TN+FP+FN)</td>
</tr>
<tr>
<td>精确率</td>
<td>P</td>
<td>TP/(TP+FP)</td>
</tr>
<tr>
<td>召回率</td>
<td>R</td>
<td>TP/(TP+FN)</td>
</tr>
<tr>
<td>F值</td>
<td>F1</td>
<td>2PR/(P+R)</td>
</tr>
</tbody>
</table></div>
<h2 id="5-1" tabindex="-1">5.1 数据集和指标</h2>
<p>我们用于评估IntDroid的数据集包含8,253个样本，这些样本可在github上获取，研究人员可以进行可重复的实验。我们从AndroZoo[11]爬取了这些APK文件，AndroZoo目前包含超过一千万个APK文件，每个文件都已被VirusTotal[7]中的多个不同防病毒产品检测过。我们利用检测报告来过滤和生成我们的数据集。只有当所有报告都将APK文件归类为非恶意时，该文件才被视为良性。对于恶意样本，我们采用Drebin[12]中的选择方法，即当一个应用被两个以上的防病毒扫描器标记为恶意时，该应用就会被收集，这样做的目的是生成更准确的数据集。</p>
<p>我们的最终数据集包括3,988个良性应用和4,265个恶意应用。表3列出了我们数据集的摘要。最大的良性样本大小为45.81 MB，最小的良性样本大小为67 KB。对于恶意软件，最大样本大小为69.69 MB，最小样本大小为54 KB。为了评估IntDroid，我们通过对数据集进行10折交叉验证来进行实验，这意味着数据集被分成十个子集，每次我们选择一个子集作为测试集，其余九个子集作为训练集。我们重复这个过程十次，并将平均值作为最终结果。用于衡量IntDroid有效性的指标如表4所示。</p>
<h2 id="5-2" tabindex="-1">5.2 检测有效性</h2>
<p>我们首先评估IntDroid在检测Android恶意软件方面的有效性。为此，我们对我们的数据集进行10折交叉验证。具体来说，我们从以下三个方面评估IntDroid的有效性：</p>
<ul>
<li>
<p>不同的分类模型：1NN、3NN和随机森林</p>
</li>
<li>
<p>不同的中心性度量：度中心性、接近中心性、谐波中心性、katz中心性、平均中心性和全中心性</p>
</li>
<li>
<p>选择不同前n%中心性的节点作为中心节点：1、2、3、4、5、6、7和8</p>
</li>
</ul>
<h3 id="5-2-1" tabindex="-1">5.2.1 不同的分类模型</h3>
<p>我们首先使用第4.5节中讨论的不同机器学习算法进行一系列实验。具体来说，我们使用1-最近邻(1NN)、3-最近邻(3NN)和随机森林(RF)运行IntDroid。这三个分类器是使用Python库scikit-learn[6]实现的。对于RF，我们采用默认参数来开展实验。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-12.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-12.png"><source media="(max-width:480px)" srcset="/img/optimized/-ujakrfcga-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/-ujakrfcga-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/-ujakrfcga-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/-ujakrfcga-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-12.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-12.png" width=""></picture></p>
<p>图7展示了当我们选择度中心性来挑选调用图中的中心节点时，IntDroid达到的F值、准确率、真阳性率(TPR)和假阳性率(FPR)。图7中的结果表明，1NN在所有实验中都能在F值、TPR和准确率方面保持最佳效果。例如，当我们选择度中心性排名前3%的节点作为中心节点时，使用1NN的IntDroid的F值为96.8%，而使用3NN和RF分别为95.2%和92.0%。对于TPR，当IntDroid使用1NN进行分类时，它可以获得比使用3NN和RF更好的性能。如图7所示，使用1NN的IntDroid的TPR范围在97.4%到98.9%之间，而使用RF时范围在81.0%到88.3%之间。对于FPR，当我们使用RF训练分类器时，IntDroid能够检测到更多的良性应用，但是TPR非常低，这表明更多的恶意样本被错误分类为良性应用。</p>
<p>事实上，对于Android恶意软件检测来说，保持高TPR非常重要，因为低TPR意味着更多的恶意样本被错误分类为良性样本，这些错误分类的恶意样本仍然可以传播恶意活动。当用户安装这些规避检测的恶意软件时，他们的私人数据可能被攻击者窃取，这可能导致不同程度的经济损失。总之，当我们采用1NN来训练分类器并用它来检测Android恶意软件时，IntDroid能够获得更好的结果。</p>
<h3 id="5-2-2" tabindex="-1">5.2.2 不同的中心性度量</h3>
<p>为了测试IntDroid使用不同中心性选择中心节点来检测Android恶意软件的有效性，我们首先通过采用以下四种中心性进行四个实验：度中心性、接近中心性、谐波中心性和katz中心性。此外，在社交网络中通常通过组合多个中心性度量来衡量顶点的重要性。因此，我们通过使用前四个单独中心性的平均值来挑选调用图中的中心节点，添加了一个平均中心性实验。此外，我们还通过计算前四个单独中心节点结果的并集（图5）构建了另一个实验（即全中心性）。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-13.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-13.png"><source media="(max-width:480px)" srcset="/img/optimized/FUsmlnXBk4-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/FUsmlnXBk4-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/FUsmlnXBk4-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/FUsmlnXBk4-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-13.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-13.png" width=""></picture></p>
<p>表5和图8展示了使用1NN的IntDroid的实验结果，包括每个实验的F值、准确率、TPR和FPR。表5和图8中的结果表明，当我们选择度中心性和全中心性来挖掘中心节点时，IntDroid可以获得更好的效果。例如，当中心性度量为度中心性和全中心性时，IntDroid的F值分别为96.8%和97.1%，而当我们选择接近中心性、谐波中心性、katz中心性和平均中心性来挑选调用图中的中心节点时，F值分别为92.9%、92.7%、93.2%和92.7%。对于TPR，如表5和图8所示，当我们采用全中心性来提取中心节点时，IntDroid能够保持99.1%的TPR。总之，当我们采用度中心性和全中心性来挖掘调用图中的中心节点时，IntDroid可以获得更好的效果。</p>
<h3 id="5-2-3-n" tabindex="-1">5.2.3 不同的前n%</h3>
<p>n越大，中心节点越多，导致运行时开销越大（第5.4节）。因此，我们只选择八个不同的n值，并排除较大的数字。如图8所示，F值、准确率、TPR和FPR随n值的变化而变化。对于度中心性和全中心性，随着n的增加，检测结果变化缓慢。对于其他选定的中心性度量，F值、准确率和TPR通常与n值呈正相关，FPR通常与n呈负相关。此外，无论n是多少，当我们选择度中心性或全中心性来提取调用图中的中心节点时，IntDroid总能保持更好的效果。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-14.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-14.png"><source media="(max-width:480px)" srcset="/img/optimized/YO02d1uTVL-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/YO02d1uTVL-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/YO02d1uTVL-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/YO02d1uTVL-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-14.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-14.png" width=""></picture></p>
<h2 id="5-3" tabindex="-1">5.3 与先前工作的比较</h2>
<p>在本节中，我们将IntDroid与VirusTotal[7]中的30个防病毒扫描器和三种最先进的Android恶意软件检测方法进行比较：一种基于权限的方法（即PerDroid[53]）、一种传统的基于图的方法（即MaMaDroid[43]）和一种基于社交网络分析的系统（即MalScan[54]）。为了在图中更清晰地显示，我们仅展示表5中所有48个实验结果中IntDroid的最佳结果。</p>
<h3 id="5-3-1" tabindex="-1">5.3.1 与防病毒扫描器的比较</h3>
<p>如前所述，我们的数据集来自AndroZoo[11]，每个APK文件都已被VirusTotal[7]中的不同防病毒产品检测过。我们利用检测报告来生成数据集。只有当所有报告都将APK文件归类为非恶意时，该文件才被视为良性。换句话说，我们数据集中的良性应用都在防病毒扫描器可以检测的范围内。因此，在本小节中，我们关注数据集中4,265个恶意软件样本的检测率。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-15.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-15.png"><source media="(max-width:480px)" srcset="/img/optimized/Al5nwcFgqg-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/Al5nwcFgqg-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/Al5nwcFgqg-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/Al5nwcFgqg-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-15.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-15.png" width=""></picture></p>
<p>具体来说，我们将这4,265个恶意软件样本上传到VirusTotal以生成检测报告。在获得所有报告后，我们在表7中显示了所有防病毒扫描器的前30个TPR，这30个扫描器的名称在表6中列出。从表7的结果中，我们可以看到这些防病毒扫描器的TPR差异很大。例如，SymantecMobileInsight可以检测到我们数据集中超过95%的恶意软件，而Baidu-International只能检测到4,265个恶意样本中的45%。对于IntDroid，TPR令人鼓舞，因为它可以发现我们数据集中超过99%的恶意软件，这是VirusTotal中所有扫描器中最高的。</p>
<p>此外，我们还研究了IntDroid和这30个防病毒扫描器检测到的恶意软件的重叠情况。我们发现，虽然IntDroid可以检测到比这30个防病毒扫描器更多的恶意软件，但IntDroid的七个假阴性（即被IntDroid错误分类的恶意软件）被某些扫描器正确检测到。我们随后手动分析了这些恶意软件，结果显示它们都是灰色软件。灰色软件是一种不必要的应用，它不一定是恶意的，但如果不处理，可能会导致性能问题和安全风险。换句话说，IntDroid可以检测到被30个扫描器错误分类的恶意软件，这30个扫描器也可以检测到被IntDroid错误分类的恶意软件。因此，我们可以将IntDroid与VirusTotal中的其他防病毒扫描器结合，以实现更完整的恶意软件检测。</p>
<h3 id="5-3-2-per-droid" tabindex="-1">5.3.2 与PerDroid的比较</h3>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-16.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-16.png"><source media="(max-width:480px)" srcset="/img/optimized/ieUyjG9iCS-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/ieUyjG9iCS-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/ieUyjG9iCS-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/ieUyjG9iCS-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-16.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-16.png" width=""></picture></p>
<p>Wang等人[53]提出了一种基于风险权限的Android恶意软件检测方法，这些风险权限是提供对移动系统核心设施访问控制机制的安全感知特征。他们应用三种特征排名方法（即互信息、相关系数和T检验）来对Android个别权限进行风险排名。然后将排名靠前的风险权限用作恶意软件检测的特征。我们利用他们论文中报告的权限风险排名，并使用他们公共网站[1]中列出的前88个风险权限。具体来说，我们使用Androguard[19]构建特征，并将其输入到三个机器学习分类器中，即1NN、3NN和RF。通过对我们8,253个样本的实验结果，我们发现3NN能够在这三个分类器中保持最佳效果。图9展示了IntDroid和PerDroid[53]的比较结果，这些结果表明我们提出的方法比基于权限的方法更有效。例如，F值和准确率分别为92.9%和92.5%，而IntDroid可以分别达到97.1%和96.9%。这种观察主要是由于基于权限的方法缺乏程序语义。</p>
<h3 id="5-3-3-ma-ma-droid" tabindex="-1">5.3.3 与MaMaDroid的比较</h3>
<p>我们还将IntDroid与一种最先进的基于图的方法MaMaDroid[43]进行比较，该方法利用从调用图获得的抽象函数调用序列，并使用它来提取特征进行分类。这些抽象序列用于构建马尔可夫链模型来表示函数之间的传输概率。具体来说，我们使用他们网站[2]上的MaMaDroid开源代码进行抽象、建模和特征提取。为了完成分类，我们实现了他们论文中描述的三个分类器（即1NN、3NN和RF），这些分类器在他们的源代码中没有提供。</p>
<p>图9给出了IntDroid和MaMaDroid在F值、准确率、TPR、TNR、FPR和FNR方面的比较结果。从图9的结果中，我们可以看到MaMaDroid优于基于权限的方法，这是因为MaMaDroid保留了程序语义（即它将程序语义提炼为图形表示），而基于权限的方法忽略了它们。此外，比较结果还表明IntDroid能够检测到更多的恶意软件，并获得比MaMaDroid更好的效果。使用IntDroid时，F值和TPR能够保持在97.1%和99.1%，而使用MaMaDroid时为94.4%和97.3%。这主要是因为API调用的抽象可能会导致一些误报。例如，两个完全不同的API调用TelephonyManager.getDeviceId()和SmsManager.sendTextMessage()可以被抽象到同一个包android.telephony中。</p>
<h3 id="5-3-4-mal-scan" tabindex="-1">5.3.4 与MalScan的比较</h3>
<p>为了实现市场范围的移动恶意软件扫描，MalScan[54]将应用程序的函数调用图视为复杂的社交网络，并对敏感API调用应用中心性分析来提取图的语义特征。然后这些中心性值用于训练Android恶意软件检测的模型。如MalScan[54]所述，我们可以看到，当使用连接中心性来训练1NN模型进行恶意软件检测时，MalScan的平均检测效果能够保持最佳。因此，我们提取调用图中敏感API调用的连接中心性来训练1NN模型以完成比较实验。</p>
<p>从图9中呈现的结果可以看出，由于考虑了应用程序的图语义，MalScan可以获得比基于权限的方法更好的效果。此外，IntDroid能够保持比MalScan略好的效果。例如，使用MalScan时TPR为98.3%，而使用IntDroid进行分类时为99.1%。这是因为仅使用敏感API调用的中心性来进行恶意软件检测可能会在良性应用通过调用敏感API表现出与恶意软件类似的行为时导致一些误报和漏报。例如，一些社交应用（如抖音）需要访问用户的位置来呈现特定位置的新闻或视频，并读取用户的通讯录来推荐新朋友。在这种情况下，敏感API调用LocationManager.getLastLocation()的中心性可能与某些恶意软件几乎相同。</p>
<p>然而，当我们使用敏感API调用和中心节点之间的亲密度来检测恶意软件时，这些良性应用和恶意软件的中心节点是不同的，导致不同应用中相同敏感API调用与中心节点之间的亲密度不同。换句话说，虽然敏感API调用的中心性值相似，但API调用和中心节点之间的亲密度可能不同，因为良性应用和恶意软件中的中心节点是不同的。通过这种方式，我们可以在较低的漏报率下检测到更多的恶意软件。</p>
<h2 id="5-4" tabindex="-1">5.4 运行时开销</h2>
<p>在本节中，我们使用8,253个样本（即3,988个良性样本和4,265个恶意样本）对IntDroid的运行时开销进行全面评估。这8,253个样本的平均节点数和边数分别为4,779和10,159。对于一个新的应用，IntDroid包含四个主要步骤来完成分类：(1)函数调用图提取，(2)中心性分析，(3)亲密度分析，和(4)分类。</p>
<h3 id="5-4-1" tabindex="-1">5.4.1 函数调用图提取</h3>
<p>IntDroid的第一步是为给定的APK文件提取函数调用图。图10展示了我们数据集上调用图提取的运行时开销，对于超过99%的APK文件，我们可以在2秒内获得调用图。平均而言，为给定的APK文件构建调用图需要0.37秒。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-17.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-17.png"><source media="(max-width:480px)" srcset="/img/optimized/S_8Goz6z4T-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/S_8Goz6z4T-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/S_8Goz6z4T-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/S_8Goz6z4T-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-17.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-17.png" width=""></picture></p>
<h3 id="5-4-2" tabindex="-1">5.4.2 中心性分析</h3>
<p>IntDroid的第二步是进行中心性分析以发掘函数调用图中的中心节点。如表8和图11所示，平均运行时开销根据不同的中心性度量而变化。显然，平均中心性和全中心性的运行时间大约是四个单独中心性的总和，这是合理的，因为这两个中心性是度中心性、接近中心性、谐波中心性和Katz中心性的组合。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-18.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-18.png"><source media="(max-width:480px)" srcset="/img/optimized/Gp18bWK_k0-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/Gp18bWK_k0-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/Gp18bWK_k0-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/Gp18bWK_k0-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-18.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-18.png" width=""></picture></p>
<h3 id="5-4-3" tabindex="-1">5.4.3 亲密度分析</h3>
<p>IntDroid的第三步是执行亲密度分析以提取特征向量。表9和图11展示了IntDroid在这一步骤的平均运行时开销，这些结果表明亲密度分析的平均运行时间通常与前n%呈正相关。这种观察主要是因为n越大，中心节点越多，导致提取敏感API调用和中心节点之间的平均亲密度需要更多的运行时开销。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-20.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-20.png"><source media="(max-width:480px)" srcset="/img/optimized/vZ4UMjCpAN-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/vZ4UMjCpAN-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/vZ4UMjCpAN-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/vZ4UMjCpAN-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-20.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-20.png" width=""></picture></p>
<h3 id="5-4-4" tabindex="-1">5.4.4 分类</h3>
<p>IntDroid的最后一步是使用从亲密度分析步骤获得的特征向量训练分类器，并在测试数据集上执行分类。如表10和图11所示，完成分类消耗不到0.02秒。分类的运行时开销是四个步骤中最少的。</p>
<p>表11和图11展示了IntDroid分析给定APK文件的总平均运行时开销。当我们选择度中心性排名前1%的节点作为中心节点并进行亲密度分析以生成用于分类的特征向量时，总运行时开销平均仅为5.4秒，而TPR能够保持在97.4%。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-19.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-19.png"><source media="(max-width:480px)" srcset="/img/optimized/Xhzc75wxqR-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/Xhzc75wxqR-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/Xhzc75wxqR-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/Xhzc75wxqR-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-19.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-19.png" width=""></picture></p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-21.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-21.png"><source media="(max-width:480px)" srcset="/img/optimized/Kl6sB1OThS-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/Kl6sB1OThS-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/Kl6sB1OThS-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/Kl6sB1OThS-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-21.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-21.png" width=""></picture></p>
<p>一方面，PerDroid[53]是一种基于权限的方法，其在恶意软件检测方面的效果低于MaMaDroid[43]和MalScan[54]。另一方面，IntDroid是传统基于图分析方法与基于社交网络分析方法的结合。因此，我们主要关注IntDroid与传统基于图分析方法（即MaMaDroid）和基于社交网络分析方法（即MalScan）的运行时开销比较。</p>
<p>对于MaMaDroid，表12显示平均需要约33.83秒来完成一次分类。虽然MaMaDroid的运行时开销可以与IntDroid几乎相同，但它需要比IntDroid多7倍的内存来执行分类。MaMaDroid需要63.7 GB的内存来完成对我们8,253个样本的分类，而IntDroid只需要8.5 GB。这是因为MaMaDroid的特征向量维度为115,600，而我们提出的方法为21,986。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-22.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-22.png"><source media="(max-width:480px)" srcset="/img/optimized/8DuoCyNqLk-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/8DuoCyNqLk-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/8DuoCyNqLk-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/8DuoCyNqLk-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-22.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-22.png" width=""></picture></p>
<p>此外，由于IntDroid的亲密度分析，其检测效率低于MalScan。例如，当我们将度中心性排名前1%的节点作为中心节点，使用1NN算法训练分类器时，IntDroid需要约5.4秒来分析给定的应用，而当我们提取连接中心性作为特征来训练1NN分类器时，MalScan只需要2.7秒就能完成整个分析。然而，由于IntDroid的更高效性，IntDroid和MalScan可以互补。换句话说，MalScan可以作为第一道防线来过滤大多数恶意软件，然后IntDroid可以作为第二道防线来挖掘更多恶意软件。通过这种方式，我们可以节省更多的时间和资源。</p>
<p>例如，假设给定10,000个新应用，我们可以先使用MalScan来检测这些应用。然后将MalScan分类为良性的应用输入到IntDroid中进行深入分析，以发现更多的恶意应用。通过这种方式，与仅使用IntDroid分析这10,000个应用相比，我们可以节省更多时间。在实践中，IntDroid和MalScan都无法达到100%的检测准确率。因此，在收集所有检测到的恶意软件样本后，我们可以将它们上传到VirusTotal以生成更详细的报告，帮助分析人员从这些恶意软件中过滤出良性应用。</p>
<h2 id="5-5" tabindex="-1">5.5 零日恶意软件的检测</h2>
<p>在本小节中，我们想要检查IntDroid在发现真实世界恶意软件方面的能力。为了实现这个目标，我们将全中心性排名前3%的节点作为中心节点，并利用我们的8,253个样本使用1NN算法训练分类器。接下来，我们从GooglePlay市场爬取5,000个应用并将它们输入到训练好的1NN分类器中。在这些应用中，IntDroid报告其中32个为恶意软件。为了验证这32个应用是否确实是恶意软件，我们将它们上传到VirusTotal[7]进行分析。在这32个样本中，24个被至少两个防病毒扫描器报告为恶意软件。</p>
<p>为了进一步研究这24个样本的行为，我们将它们上传到一个最先进的沙箱[8]，该沙箱结合静态和动态分析来报告详细的风险行为。通过结果，我们观察到它们都收集用户的私人信息（如IMSI、IMEI、电话号码和联系人），然后将它们发送到网络或写入文件。此外，其中七个执行shellcode来完成更多风险活动。分析这些样本后，我们对它们进行调查（即从GooglePlay官方网站获取更详细的信息），结果显示其中一个已被超过一千万用户下载和安装。这个应用也被VirusTotal[7]中的六个防病毒扫描器标记为恶意软件，其中之一是Symantec Mobile Insight。</p>
<p>实际上，三个应用在VirusTotal中只被一个扫描器标记为恶意软件。同样，我们也将它们上传到沙箱[8]，行为报告显示它们不一定是恶意的，而是被识别为一种灰色软件（即广告软件）。对于剩下的五个应用，我们手动检查了它们。我们的手动检查显示，这五个应用中的一个实际上是恶意软件，因为它包含高度可疑的行为。该应用是一个音乐下载器，包含六个危险权限，并读取设备的电池和内存信息。此外，该应用收集许多敏感数据（即Android ID、序列号、IMSI、IMEI、电话号码、联系人、电子邮件和位置），甚至可以执行shellcode。</p>
<p>总之，IntDroid能够在5,000个GooglePlay应用中发现28个零日恶意软件，其中一个已被超过1000万用户下载和安装，另一个未被现有工具[7]报告为恶意软件。</p>
<h1 id="6-malscan" tabindex="-1">6 与MALSCAN的广泛比较</h1>
<p>因为IntDroid最相似的系统是MalScan，因此，为了验证IntDroid的更高效性，我们在本节中与MalScan进行广泛比较。从第5节中的实验结果来看，当我们选择全中心性排名前3%的节点作为中心节点并应用1NN来训练恶意软件检测模型时，我们能够保持最佳效果。我们选择这三个参数来开始与MalScan的比较。</p>
<h2 id="6-1" tabindex="-1">6.1 暮光区恶意软件的检测</h2>
<p>如前所述，灰色软件样本是一种不必要的应用，它不一定是恶意的，但如果不处理，可能会导致性能问题和安全风险。根据最近的一份报告，即使灰色软件不是主动恶意的，它们也可能造成大量损害。由于灰色软件的恶意行为不明显，它们更难与良性应用区分开来。在Euphony[38]中，作者发现被VirusTotal中至少五个防病毒扫描器标记的应用表现出更明显的恶意行为。换句话说，被一到五个扫描器检测到的应用很可能处于恶意和良性功能之间的暮光区。</p>
<p>在这部分中，我们关注使用MalScan和IntDroid检测暮光区的恶意软件（如灰色软件）。具体来说，我们随机下载3,000个被VirusTotal中一到五个扫描器报告为恶意的恶意软件样本。对于良性应用，我们使用第5节中的3,988个良性样本作为数据集。收集3,988个良性应用和3,000个恶意样本后，我们开始检查MalScan和IntDroid在检测暮光区恶意软件方面的能力。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-4.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-4.png"><source media="(max-width:480px)" srcset="/img/optimized/cdVs7nMn5f-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/cdVs7nMn5f-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/cdVs7nMn5f-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/cdVs7nMn5f-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-4.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-4.png" width=""></picture></p>
<p>表13展示了MalScan和IntDroid的比较结果。MalScan的TPR为91.2%，这意味着MalScan只能检测到91.2%的暮光区恶意软件。然而，对于IntDroid，TPR能够保持在95.1%，这大于91.2%。这样的结果表明IntDroid在检测暮光区恶意软件方面表现优于MalScan。虽然IntDroid在检测我们收集的数据集时可以达到96.1%的准确率，但它仍然无法检测某些暮光区的恶意软件。我们随后手动检查这些错误分类的恶意软件，发现它们大多是广告软件。广告软件最常见的原因是为了赚取广告收入而收集用户信息。在实践中，一些良性应用可能使用广告库来访问用户的私人信息，甚至监控用户的行为以推送合适的广告来获取利润。这些广告库和广告软件的行为类似，导致错误分类。</p>
<h2 id="6-2" tabindex="-1">6.2 不同家族恶意软件的检测</h2>
<p>在测试恶意软件检测方法的检测效果时，还有另一个重要方面（即实验数据集中恶意软件家族的平衡[12, 48]）需要考虑。假设几个恶意软件家族的样本数量远大于其他家族，那么训练模型的检测能力将主要依赖于这些家族。换句话说，恶意软件检测方法应该对不同家族都保持高效性。</p>
<p>在本小节中，我们进行比较实验来评估MalScan和IntDroid在检测不同家族恶意软件方面的效果。具体来说，我们选择AndroZoo[11]中20个最大的恶意软件家族作为测试对象。AndroZoo[11]中的一些恶意APK文件使用[33]中的方法被标记到相应的家族中。我们为每个家族随机下载1,000个样本，下载的样本总数为20,000个。每个家族的名称和样本平均大小可以在表14中找到。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-2.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-2.png"><source media="(max-width:480px)" srcset="/img/optimized/cdD-i-kY_k-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/cdD-i-kY_k-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/cdD-i-kY_k-633.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/cdD-i-kY_k-633.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-2.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-2.png" width=""></picture></p>
<p>我们利用第5节中使用的3,988个良性样本和这20,000个恶意软件样本来开展研究。实际上，我们为20个家族总共进行了20次实验。换句话说，每个实验的数据集包括3,988个良性应用和每个家族的1,000个恶意应用。我们为20个家族重复这个过程20次。所有研究都使用10折交叉验证进行。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-3.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-3.png"><source media="(max-width:480px)" srcset="/img/optimized/19vugrdYMa-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/19vugrdYMa-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/19vugrdYMa-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/19vugrdYMa-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-3.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-3.png" width=""></picture></p>
<p>图12展示了MalScan和IntDroid对每个家族的检测效果。从图12的结果中，我们可以看到IntDroid能够在检测所有这20个家族的恶意软件时保持比MalScan更好的效果。例如，在检测admogo家族的恶意软件时，MalScan只能检测到95.5%的恶意软件，而IntDroid可以达到98.8%的TPR。此外，IntDroid能够对所有20个恶意软件家族保持超过94%的检测率。特别是，有七个家族的TPR超过98%，一个家族的TPR大于99%。在测试这23,988个样本时，IntDroid的平均检测率为96.9%，如此高的效果表明IntDroid适合检测不同家族的恶意软件。</p>
<h2 id="6-3" tabindex="-1">6.3 未知家族恶意软件的检测</h2>
<p>随着Android的不断发展，攻击者创建了许多新的恶意样本来逃避现有的恶意软件检测器[52]。这些样本中的一些可能不属于任何现有的恶意软件家族。当应用来自新的恶意软件家族时，由于缺乏区分性特征来将其标记为恶意软件，恶意软件检测器可能会产生假阴性。因此，评估恶意软件检测方法在区分新恶意软件家族方面的能力很重要。</p>
<p>在本小节中，我们进行比较实验来检查MalScan和IntDroid在检测未知家族恶意软件方面的效果。本小节中的数据集包括第5节中的3,988个良性样本和第6.2节中的20,000个恶意样本。我们总共进行三个实验，其中我们限制特定家族的训练样本数量。</p>
<p>在第一个实验中，我们在训练集中不提供该家族的任何样本。假设admogo家族是一个新家族，那么训练集将由3,988个良性样本和19,000个恶意样本组成，包括0个admogo家族样本。为了模拟新家族的开始传播，我们开始第二个实验，我们首先随机选择该家族的10个样本，然后将这些选定的样本放入训练集。这个实验中恶意训练样本的数量是19,010个，其中包括10个新家族样本。随着新家族恶意软件的扩散，可用样本的数量会增加。在最后一个实验中，我们假设获得的新家族样本数量为100，并将这100个样本放入我们的训练集。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-1.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-1.png"><source media="(max-width:480px)" srcset="/img/optimized/sURb9bh0eq-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/sURb9bh0eq-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/sURb9bh0eq-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/sURb9bh0eq-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2021.07.%E5%90%B4%E6%9C%88%E6%98%8E3.IntDroid%EF%BC%9A%E5%9F%BA%E4%BA%8EAPI%E4%BA%B2%E5%AF%86%E5%BA%A6%E5%88%86%E6%9E%90%E7%9A%84Android%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B_image-1.png" alt="2021.07.吴月明3.IntDroid：基于API亲密度分析的Android恶意软件检测_image-1.png" width=""></picture></p>
<p>我们对每个家族进行这三个实验，检测结果在表15中呈现。如表15所示，与图12中的结果类似，IntDroid在检测所有新家族的恶意软件方面表现优于MalScan。当新家族的可用样本数量为0、10和100时，MalScan的平均TPR分别为92.6%、93.0%和94.2%。然而，它们都小于IntDroid达到的TPR。此外，在没有任何新家族样本用于训练的情况下，IntDroid的TPR仍然能够对20个不同家族保持在80%以上。此外，11个家族可以达到超过95%的TPR，甚至一个家族（即appsgeyser）可以被完美检测（即100%准确率）。这些结果表明IntDroid能够以良好的效果检测来自新家族的恶意软件。</p>
<p>当新家族的可用样本数量增加时，IntDroid的TPR可以达到更好的效果。例如，如果没有startapp样本可用于训练，IntDroid在检测startapp家族恶意软件时的TPR为81.4%，而当可用训练样本增加到10和100时，分别为84.9%和92.6%。这样的结果是合理的，因为某些家族的成员通常表现出类似的行为，只是带有一些轻微修改的重打包恶意软件。可用样本数量越多，可以检测到的家族变体就越多。</p>
<h1 id="7" tabindex="-1">7 讨论和局限性</h1>
<h2 id="7-1" tabindex="-1">7.1 有效性威胁</h2>
<p>外部有效性威胁：在第5节中使用有限数量的应用构成了外部有效性威胁。这些有限的应用可能无法代表整个市场。我们在第6节中使用来自20个家族的20,000个恶意应用进行其他详细的比较实验来缓解这个威胁。</p>
<p>内部有效性威胁：</p>
<ul>
<li>
<p>当我们得出良性应用和恶意应用之间差异程度的结论时，亲密度值的分布可能会导致一些不准确。我们通过采用非参数检验（即Mann-Whitney）来研究这些亲密度值的差异来缓解这个威胁。</p>
</li>
<li>
<p>由于不同的机器运行状态（如不同的CPU使用率），记录运行时开销的不准确性是不可避免的。通过收集所有运行时开销三次后报告平均运行时开销来缓解这个威胁。</p>
</li>
<li>
<p>根据简单排序的节点中心性百分比选择中心节点可能会导致一些不准确。为了缓解这个威胁，我们选择八个阈值（即1%到8%）进行更完整的实验，以找出恶意软件检测的理想阈值。</p>
</li>
<li>
<p>在从Google Play市场检测零日恶意软件时可能会有一些误报。我们将这些样本上传到结合静态和动态分析的沙箱中，生成详细的风险报告来缓解这个威胁。</p>
</li>
</ul>
<h2 id="7-2" tabindex="-1">7.2 误报和漏报</h2>
<p>误报：深入分析IntDroid造成的误报后，我们发现最常见的原因是良性应用中使用广告库。这些广告库需要访问私人信息，甚至监控用户的行为以推送合适的广告来获取利润。这些广告库的行为可能被错误分类为恶意软件，导致误报。</p>
<p>漏报：对于IntDroid的漏报，我们观察到它们大多数都在暮光区，即灰色软件。换句话说，这些样本的恶意代码没有表现出明显的恶意行为或被深度伪装。广告软件是一种灰色软件，是设计用来在屏幕上显示广告的不需要的软件。由于它们大多数没有执行任何明显的恶意活动，IntDroid无法正确地将它们标记为恶意软件。</p>
<h2 id="7-3" tabindex="-1">7.3 讨论</h2>
<p>在我们的工作中，我们总共选择了四个单独的中心性度量，并构造了另外两个中心性度量来挖掘Android恶意软件检测的中心节点。通过第5节的实验结果，我们看到度中心性在四个单独的中心性度量（即度中心性、katz中心性、接近中心性和谐波中心性）中可以达到最佳性能。此外，当我们使用组合的中心节点（即全中心性）来检测恶意软件时，性能与使用度中心性几乎相同。</p>
<p>我们进行了一个简单的研究，以检查使用度中心性和全中心性获得的特征向量之间的余弦距离。我们选择n=1（即中心性排名前1%的节点将被选为中心节点）作为参数。对于度中心性和全中心性之间3,988个良性样本的特征向量，3,921个样本（3,921/3,988=98.32%）的相似度大于90%，3,185个样本（3185/3988=79.86%）的相似度大于99%，548个样本的相似度为100%。此外，对于我们的4,265个恶意样本，4,249个样本（4,249/4,265=99.62%）的相似度大于90%，3,818个样本（3,818/4,265=89.52%）的相似度大于99%，394个样本的相似度为100%。这些结果表明度中心性可能是提取恶意软件检测中心节点的最佳候选。</p>
<p>在我们的未来工作中，我们将测试更多不同中心性度量在检测Android恶意软件方面的能力。此外，由于大多数Android恶意软件检测系统是闭源的，我们只将IntDroid与三个开源系统[43, 53, 54]进行比较。我们将在未来的工作中对更多系统进行详细的比较分析。</p>
<h2 id="7-4" tabindex="-1">7.4 局限性</h2>
<p>与任何经验方法一样，IntDroid存在几个局限性，列举如下：</p>
<ul>
<li>
<p>敏感API调用：我们的方法依赖于调用图中敏感API调用和中心节点之间的亲密度分析。我们使用PScout[13]映射的最新版本敏感API调用。然而，它可能部分过时。一些不正确和缺失的API调用可能会导致恶意软件检测的一些误报和漏报。需要使用PScout[13]在最新的Android版本上更新敏感API调用。</p>
</li>
<li>
<p>加密：使用混淆技术保护Android应用非常普遍。考虑到IntDroid分析函数调用图来提取特征，它对几种典型的本地混淆技术[32]具有弹性，如用户定义的函数和包的重命名。然而，它容易受到某些混淆技术的影响，如加密（例如APK Protect[5]）。这些加密打包器可以使用加密技术隐藏实际的Dex代码来保护应用。为了解决这个限制，我们可以使用一些解包系统[55, 59]来恢复实际的Dex文件，然后应用静态分析来提取调用图。</p>
</li>
<li>
<p>调用图提取：为了保持IntDroid在恶意软件检测方面的高效性，我们使用Androguard[19]进行简单的静态分析来提取简洁的函数调用图。实际上，许多应用使用反射技术[47]来调用敏感方法，在这种情况下，我们可能会遗漏这些方法之间的调用关系。为了对反射具有弹性，我们可以使用开源工具DroidRA[37]对我们的数据集进行反射分析，以识别每个应用中使用反射的方法。然后可以将缺失的边添加到调用图中，其中调用者节点是使用反射的方法，被调用者节点是反射的方法。此外，Androguard[19]提取的函数调用图是上下文和流不敏感的调用图。我们忽略这些信息以实现高效的恶意软件检测。如果我们执行昂贵的程序分析来考虑调用图的上下文和流信息，保持高可扩展性对我们来说是一个两难的问题。然而，我们的实验结果表明，简洁的调用图足以让我们进行有效的恶意软件检测。</p>
</li>
</ul>
<h1 id="8" tabindex="-1">8 相关工作</h1>
<p>已经提出了许多Android恶意软件检测方法，可以分为两个主要类别：基于语法和基于语义。</p>
<h2 id="8-1-android" tabindex="-1">8.1 基于语法的Android恶意软件检测</h2>
<p>基于语法的方法[9, 12, 21, 31, 36, 46, 50, 53, 60]忽略应用代码的语义以实现高效的Android恶意软件检测。例如，Wang等人[53]关注应用请求的权限来检测Android恶意软件。它扫描清单文件以收集所有权限的列表，然后应用几种特征排名方法来对它们进行风险排名。在获得所有分析权限的排名后，排名靠前的权限将被视为风险权限，并用作检测恶意软件的特征。这些风险权限可以提供对移动系统核心设施的访问控制机制，因此它们可以表示为一种应用行为类型。</p>
<p>与Wang等人[53]类似，Huang等人[31]也从APK文件中提取权限和几个易于检索的特征（例如，扩展名为&quot;.so&quot;的文件数量）来检测恶意软件。在实践中，由于精度有限，他们得出结论，他们的方法可以用作快速过滤器来识别恶意软件，然后应该应用更高级的技术来实现更准确的恶意软件检测。换句话说，由于缺乏程序语义，基于权限的方法在检测Android恶意软件方面效果不佳。</p>
<p>为了缓解这个问题，Drebin[12]使用广泛的静态分析从清单和反汇编代码中提取尽可能多的特征，并将它们嵌入联合向量空间以检测恶意软件。清单中的特征集包括硬件特征、请求的权限、应用组件和过滤的意图，而应用反汇编代码中包括受限的API调用、使用的权限、可疑的API调用和网络地址。然而，它只搜索特定字符串的存在，而不考虑程序语义。因此它可以很容易地被语法特征的攻击[17]规避。</p>
<h2 id="8-2-android" tabindex="-1">8.2 基于语义的Android恶意软件检测</h2>
<p>为了保持在检测Android恶意软件方面的高效性，研究人员[10, 14, 20, 23-25, 27, 28, 40, 43-44, 45, 49, 56-58]进行程序分析以提取不同类型的应用语义。例如，MassVet[16]构建一个视图图来描述具有相当复杂UI结构的应用。为了确保图匹配的高可扩展性，MassVet应用他们之前工作[15]中出现的相似性比较算法来分析恢复的视图图。它已经验证了在移动恶意软件检测方面的高效性和可扩展性，然而，MassVet的原始目的是检测重打包的恶意软件。当应用是新的恶意软件时，它可能会导致漏报。</p>
<p>DroidSIFT[58]基于静态分析提取加权上下文API依赖图来解决恶意软件变形问题。Apposcopy[24]利用静态污点分析形成一种称为组件间调用图的新程序表示，并使用它来检测恶意软件。然而，DroidSIFT[58]和Apposcopy[24]都存在严重的运行时开销。根据他们的论文报告，它们分别平均需要175.8秒和275秒来分析一个应用。</p>
<p>SMART[44]基于确定性符号自动机构建Android恶意软件的语义模型，可以捕获恶意软件家族的常见恶意行为。它包含两个主要阶段来完成恶意软件检测。第一阶段是离线模型学习，克隆检测平均消耗72.5秒，克隆差异和DSA生成消耗167.5秒。第二阶段是在线恶意软件检测和分类，其中基于ML的恶意软件检测平均需要13.4秒，而将恶意软件分类到相应家族平均需要105.9秒。</p>
<p>MaMaDroid[43]利用从调用图获得的抽象函数调用序列来构建行为模型，并使用它来提取特征进行分类。这种方法的一个限制是它可以很容易地被看起来类似于Android、Google或Java包的自定义包[17]规避，另一个限制是由于其大量特征[43]，它在分类时需要相当大的内存。</p>
<h2 id="8-3-mal-scan" tabindex="-1">8.3 与MalScan的区别</h2>
<p>与IntDroid最相似的工作是我们之前的工作MalScan[54]，它将函数调用图视为复杂的社交网络，并对敏感API调用应用基于社交网络的中心性分析来表示图语义进行分类。然而，仅使用敏感API调用的中心性来进行恶意软件检测可能会在良性应用通过调用敏感API表现出与恶意软件类似的行为时导致一些误报。在这种情况下，良性应用中某些敏感API调用的中心性可能与某些恶意软件中的几乎相同。</p>
<p>然而，当我们使用敏感API调用和中心节点之间的亲密度（在第3.2节中定义）来检测恶意软件时，这些良性应用和恶意软件的中心节点是不同的，导致不同应用中相同敏感API调用与中心节点之间的亲密度不同。换句话说，虽然敏感API调用的中心性值相似，但由于中心节点不同，良性应用和恶意应用中API调用和中心节点之间的亲密度可能不同。通过这种方式，我们可以在较低的误报率下检测到更多的恶意软件。</p>
<p>实际上，由于计算敏感API调用和中心节点之间的亲密度，IntDroid的效率低于MalScan。因此，MalScan可以作为第一道防线来过滤大多数恶意软件，然后IntDroid可以作为第二道防线来发现更多恶意软件。通过这种方式，我们可以实现更高效的恶意软件检测并节省更多资源。</p>
<h1 id="9" tabindex="-1">9 结论</h1>
<p>在本文中，我们提出了一种基于函数调用图中敏感API调用和中心节点之间亲密度分析的新方法来检测Android恶意软件。为了避免重量级图匹配开销，我们将函数调用图视为复杂的社交网络，并进行中心性分析以发掘中心节点。我们实现了一个自动化系统IntDroid，广泛的评估表明我们提出的系统能够在Android恶意软件检测方面保持高准确性和可扩展性。</p>
<h1 id="致谢" tabindex="-1">致谢</h1>
<p>我们感谢匿名审稿人提供的富有洞察力的意见，以提高文章的质量。</p>
</main>
<aside>
<div class="sidebar">
<div class="sidebar-container">
<div class="toc">
<div class="toc-title-container">
<div class="toc-title">
On this page
</div>
</div>
<div class="toc-container">
<nav class="toc">
<ol>
<li><a href="#android">Android恶意软件检测的新方法</a>
</li>
<li><a href="#1">1 引言</a>
</li>
<li><a href="#2">2 动机</a>
</li>
<li><a href="#3">3 定义</a>
<ol>
<li><a href="#3-1">3.1 中心性</a>
</li>
<li><a href="#3-2">3.2 亲密度</a>
</li>
</ol>
</li>
<li><a href="#4">4 系统架构</a>
<ol>
<li><a href="#4-1">4.1 概述</a>
</li>
<li><a href="#4-2">4.2 静态分析</a>
</li>
<li><a href="#4-3">4.3 中心性分析</a>
</li>
<li><a href="#4-4">4.4 亲密度分析</a>
</li>
<li><a href="#4-5">4.5 分类</a>
</li>
</ol>
</li>
<li><a href="#5">5 评估</a>
<ol>
<li><a href="#5-1">5.1 数据集和指标</a>
</li>
<li><a href="#5-2">5.2 检测有效性</a>
<ol>
<li><a href="#5-2-1">5.2.1 不同的分类模型</a>
</li>
<li><a href="#5-2-2">5.2.2 不同的中心性度量</a>
</li>
<li><a href="#5-2-3-n">5.2.3 不同的前n%</a>
</li>
</ol>
</li>
<li><a href="#5-3">5.3 与先前工作的比较</a>
<ol>
<li><a href="#5-3-1">5.3.1 与防病毒扫描器的比较</a>
</li>
<li><a href="#5-3-2-per-droid">5.3.2 与PerDroid的比较</a>
</li>
<li><a href="#5-3-3-ma-ma-droid">5.3.3 与MaMaDroid的比较</a>
</li>
<li><a href="#5-3-4-mal-scan">5.3.4 与MalScan的比较</a>
</li>
</ol>
</li>
<li><a href="#5-4">5.4 运行时开销</a>
<ol>
<li><a href="#5-4-1">5.4.1 函数调用图提取</a>
</li>
<li><a href="#5-4-2">5.4.2 中心性分析</a>
</li>
<li><a href="#5-4-3">5.4.3 亲密度分析</a>
</li>
<li><a href="#5-4-4">5.4.4 分类</a>
</li>
</ol>
</li>
<li><a href="#5-5">5.5 零日恶意软件的检测</a>
</li>
</ol>
</li>
<li><a href="#6-malscan">6 与MALSCAN的广泛比较</a>
<ol>
<li><a href="#6-1">6.1 暮光区恶意软件的检测</a>
</li>
<li><a href="#6-2">6.2 不同家族恶意软件的检测</a>
</li>
<li><a href="#6-3">6.3 未知家族恶意软件的检测</a>
</li>
</ol>
</li>
<li><a href="#7">7 讨论和局限性</a>
<ol>
<li><a href="#7-1">7.1 有效性威胁</a>
</li>
<li><a href="#7-2">7.2 误报和漏报</a>
</li>
<li><a href="#7-3">7.3 讨论</a>
</li>
<li><a href="#7-4">7.4 局限性</a>
</li>
</ol>
</li>
<li><a href="#8">8 相关工作</a>
<ol>
<li><a href="#8-1-android">8.1 基于语法的Android恶意软件检测</a>
</li>
<li><a href="#8-2-android">8.2 基于语义的Android恶意软件检测</a>
</li>
<li><a href="#8-3-mal-scan">8.3 与MalScan的区别</a>
</li>
</ol>
</li>
<li><a href="#9">9 结论</a>
</li>
<li><a href="#致谢">致谢</a>
</li>
</ol>
</nav>
</div>
</div>
<div class="backlinks">
<div class="backlink-title" style="margin:4px 0!important">Pages mentioning this page</div>
<div class="backlink-list"><div class="backlink-card"><i icon-name="link"></i><a href="/硕士研究生/科研/恶意软件检测文献阅读/恶意软件检测文献阅读/" data-note-icon="" class="backlink">恶意软件检测文献阅读</a>
</div></div>
</div>
</div>
</div>
</aside>
<style>#tooltip-wrapper{background:var(--background-primary);padding:1em;border-radius:4px;overflow:hidden;position:fixed;width:80%;max-width:400px;height:auto;max-height:300px;font-size:.8em;box-shadow:0 5px 10px rgba(0,0,0,.1);opacity:0;transition:opacity .1s;unicode-bidi:plaintext;overflow-y:scroll;z-index:10}#tooltip-wrapper:after{content:"";position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;width:100%;unicode-bidi:plaintext;height:75px}</style>
<div style="opacity:0;display:none" id="tooltip-wrapper">
<div id="tooltip-content">
</div>
</div>
<iframe style="display:none;height:0;width:0" id="link-preview-iframe" src="">
</iframe>
<script>var opacityTimeout,contentTimeout,transitionDurationMs=100,iframe=document.getElementById("link-preview-iframe"),tooltipWrapper=document.getElementById("tooltip-wrapper"),tooltipContent=document.getElementById("tooltip-content"),linkHistories={};function hideTooltip(){opacityTimeout=setTimeout((function(){tooltipWrapper.style.opacity=0,contentTimeout=setTimeout((function(){tooltipContent.innerHTML="",tooltipWrapper.style.display="none"}),transitionDurationMs+1)}),transitionDurationMs)}function showTooltip(t){var e=t.target,o=e.getClientRects()[e.getClientRects().length-1],i=window.pageYOffset||document.documentElement.scrollTop,n=t.target.getAttribute("href");if(-1===n.indexOf("http")||-1!==n.indexOf(window.location.host)){let t=n.split("#")[0];linkHistories[t]?(tooltipContent.innerHTML=linkHistories[t],tooltipWrapper.style.display="block",setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)):(iframe.src=t,iframe.onload=function(){tooltipContentHtml="",tooltipContentHtml+='<div style="font-weight: bold; unicode-bidi: plaintext;">'+iframe.contentWindow.document.querySelector("h1").innerHTML+"</div>",tooltipContentHtml+=iframe.contentWindow.document.querySelector(".content").innerHTML,tooltipContent.innerHTML=tooltipContentHtml,linkHistories[t]=tooltipContentHtml,tooltipWrapper.style.display="block",tooltipWrapper.scrollTop=0,setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),console.log(e),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)}),tooltipWrapper.style.left=o.left-tooltipWrapper.offsetWidth/2+o.width/2+"px",window.innerHeight-o.top<tooltipWrapper.offsetHeight?tooltipWrapper.style.top=o.top+i-tooltipWrapper.offsetHeight-10+"px":window.innerHeight-o.top>tooltipWrapper.offsetHeight&&(tooltipWrapper.style.top=o.top+i+35+"px"),o.left+o.width/2<tooltipWrapper.offsetWidth/2?tooltipWrapper.style.left="10px":document.body.clientWidth-o.left-o.width/2<tooltipWrapper.offsetWidth/2&&(tooltipWrapper.style.left=document.body.clientWidth-tooltipWrapper.offsetWidth-20+"px")}}function setupListeners(t){t.addEventListener("mouseleave",(function(t){hideTooltip()})),tooltipWrapper.addEventListener("mouseleave",(function(t){hideTooltip()})),t.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout),showTooltip(t)})),tooltipWrapper.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout)}))}window.addEventListener("load",(function(t){document.querySelectorAll(".internal-link").forEach(setupListeners),document.querySelectorAll(".backlink-card a").forEach(setupListeners)}))</script>
<script>window.location.hash&&document.getElementById(window.location.hash.slice(1)).classList.add("referred"),window.addEventListener("hashchange",(e=>{const t=e.oldURL.split("#");t[1]&&document.getElementById(t[1]).classList.remove("referred");const n=e.newURL.split("#");n[1]&&document.getElementById(n[1]).classList.add("referred")}),!1);const url_parts=window.location.href.split("#"),url=url_parts[0],referrence=url_parts[1];document.querySelectorAll(".cm-s-obsidian > *[id]").forEach((function(e){e.ondblclick=function(e){const t=url+"#"+e.target.id;navigator.clipboard.writeText(t)}}))</script>
<script src="https://fastly.jsdelivr.net/npm/luxon@3.2.1/build/global/luxon.min.js"></script>
<script defer="defer">TIMESTAMP_FORMAT="MMM dd, yyyy h:mm a",document.querySelectorAll(".human-date").forEach((function(e){date=e.getAttribute("data-date")||e.innerText,parsed_date=luxon.DateTime.fromISO(date),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromSQL(date)),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromHTML(date)),e.innerHTML=parsed_date.toFormat(TIMESTAMP_FORMAT)}))</script>
<script>lucide.createIcons({attrs:{class:["svg-icon"]}})</script>
</body>
</html>
