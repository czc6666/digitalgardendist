<!doctype html>
<html lang="zh-CN">
<head>
<title>GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script async type="module">import mermaid from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-sv0slik/5O0JIPdLBCR2A3XDg/1U3WuDEheZfI/DI5n8Yqc3h5kjrnr46FGBNiUAJF7rE4LHKwQ/SoSLRKAxEA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdn.jsdelivr.net/npm/lucide@0.115.0/dist/umd/lucide.min.js"></script>
<script>window.addEventListener("load",(()=>{document.querySelectorAll(".callout").forEach((e=>{const t=getComputedStyle(e).getPropertyValue("--callout-icon"),l=t&&t.trim().replace(/^lucide-/,"");if(l){const t=e.querySelector(".callout-title");if(t){const e=document.createElement("div"),c=document.createElement("i");e.appendChild(c),c.setAttribute("icon-name",l),e.setAttribute("class","callout-icon"),t.insertBefore(e,t.firstChild)}}})),lucide.createIcons(),Array.from(document.querySelectorAll(".callout.is-collapsible")).forEach((e=>{e.querySelector(".callout-title").addEventListener("click",(t=>{e.classList.contains("is-collapsed")?e.classList.remove("is-collapsed"):e.classList.add("is-collapsed")}))}))}))</script>
<script async src="https://fastly.jsdelivr.net/npm/force-graph@1.43.0/dist/force-graph.min.js"></script>
<script async src="https://fastly.jsdelivr.net/npm/@alpinejs/persist@3.11.1/dist/cdn.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/alpinejs@3.11.1/dist/cdn.min.js" async></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer" async>
<script src="https://fastly.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer" async></script>
<link href="/styles/digital-garden-base.css" rel="stylesheet">
<link href="/styles/obsidian-base.css" rel="stylesheet">
<link href="/styles/_theme.74516f71.css" rel="stylesheet">
<link href="/styles/custom-style.css" rel="stylesheet">
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<style></style>
<style></style>
</head>
<body class="theme-light markdown-preview-view markdown-rendered markdown-preview-section css-settings-manager mod-windows is-frameless is-maximized is-hidden-frameless is-focused obsidian-app theme-light show-inline-title show-ribbon show-view-header css-settings-manager theme-default line-style-solid folder-default blockquote-normal callout-normal checkbox-default tag-default link-default heading-default responsive-tile-height oz-show-all-num">
<nav class="navbar">
<div class="navbar-inner">
<a href="/" style="text-decoration:none">
<h1 style="margin:15px!important">czc&#39;s digital garden</h1>
</a>
</div>
<div class="search-button align-icon" onclick="toggleSearch()">
<span class="search-icon">
<i icon-name="search"></i>
</span>
<span class="search-text">
<span>Search</span>
<span style="font-size:.6rem;padding:2px 2px 0 6px;text-align:center;transform:translateY(4px)" class="search-keys">
CTRL + K
</span>
</span>
</div>
</nav>
<div class="search-container" id="globalsearch" onclick="toggleSearch()">
<div class="search-box">
<input type="search" id="term" placeholder="Start typing...">
<div id="search-results"></div>
<footer class="search-box-footer">
<div class="navigation-hint">
<span>Enter to select</span>
</div>
<div class="navigation-hint align-icon">
<i icon-name="arrow-up" aria-hidden="true"></i>
<i icon-name="arrow-down" aria-hidden="true"></i>
<span>to navigate</span>
</div>
<div class="navigation-hint">
<span>ESC to close</span>
</div>
</footer>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js"></script>
<script>document.addEventListener("DOMContentLoaded",init,!1),document.addEventListener("DOMContentLoaded",setCorrectShortcut,!1),window.toggleSearch=function(){document.getElementById("globalsearch").classList.contains("active")?document.getElementById("globalsearch").classList.remove("active"):(document.getElementById("globalsearch").classList.add("active"),document.getElementById("term").focus())},window.toggleTagSearch=function(e){console.log(e.textContent);const t=e.textContent;t&&(window.document.getElementById("term").value=t.trim(),window.toggleSearch(),window.search())};const loadingSvg='\n    <svg width="100" height="100" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg" stroke="#fff">\n      <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="1.5s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="1.5s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="1.5s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="3s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="3s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="3s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="8">\n              <animate attributeName="r"\n                   begin="0s" dur="1.5s"\n                   values="6;1;2;3;4;5;6"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n      </g>\n  </svg>';function debounce(e,t,n){var a;return function(){var r=this,i=arguments,c=n&&!a;clearTimeout(a),a=setTimeout((function(){a=null,n||e.apply(r,i)}),t),c&&e.apply(r,i)}}function setCorrectShortcut(){navigator.platform.toUpperCase().indexOf("MAC")>=0&&document.querySelectorAll(".search-keys").forEach((e=>e.innerHTML="⌘ + K"))}function createIndex(e){const t=e=>e.toLowerCase().split(/([^a-z]|[^\x00-\x7F])/),n=new FlexSearch.Document({cache:!0,charset:"latin:extra",optimize:!0,index:[{field:"content",tokenize:"reverse",encode:t},{field:"title",tokenize:"forward",encode:t},{field:"tags",tokenize:"forward",encode:t}]});return e.forEach(((e,t)=>{n.add({id:t,title:e.title,content:e.content,tags:e.tags})})),n}async function init(){let e=!0;if(localStorage.getItem("searchIndex")){let{date:t,docs:n}=JSON.parse(localStorage.getItem("searchIndex"));if("2025-06-15T15:04:52.026Z"===t){e=!1;let t=createIndex(n);window.docs=n,window.index=t}}if(e){let e=await(await fetch("/searchIndex.json?v=2025-06-15T15:04:52.026Z")).json(),t=createIndex(e);localStorage.setItem("searchIndex",JSON.stringify({date:"2025-06-15T15:04:52.026Z",docs:e})),window.docs=e,window.index=t}document.addEventListener("keydown",(e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),toggleSearch()),"Escape"===e.key&&document.getElementById("globalsearch").classList.remove("active"),document.getElementById("globalsearch").classList.contains("active")){if("ArrowDown"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.nextElementSibling?t.nextElementSibling.classList.add("active"):document.querySelector(".searchresult").classList.add("active")):document.querySelector(".searchresult").classList.add("active");let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("ArrowUp"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.previousElementSibling?t.previousElementSibling.classList.add("active"):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling||e.classList.add("active")}))):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling&&e.classList.add("active")}));let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("Enter"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t&&(window.location.href=t.querySelector("a").href)}}}));const t=debounce(search,200,!1);field=document.querySelector("#term"),field.addEventListener("keydown",(e=>{"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&t()})),resultsDiv=document.querySelector("#search-results");const n=new URL(location.href).searchParams;n.get("q")&&(field.setAttribute("value",n.get("q")),toggleSearch(),search())}async function search(){let e=field.value.trim();if(!e)return;if(e==lastSearch)return;console.log(`search for ${e}`),window.lastSearch=e,resultsDiv.innerHTML=loadingSvg;let t=offlineSearch(e),n="";if(!t.length){let t=document.createElement("p");return t.innerText=`No results for "${e}"`,resultsDiv.innerHTML="",void resultsDiv.appendChild(t)}n+='<div style="max-width:100%;">',t.forEach((e=>{e.tags&&e.tags.length>0?n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        <div class="header-meta">\n                            <div class="header-tags">\n                                ${e.tags.map((e=>'<a class="tag" href="JavaScript:Void(0);">#'+e+"</a>")).join("")}\n                            </div>\n                        </div>\n                        ${e.content}\n                    </div>\n                </div>`:n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        ${e.content}\n                    </div>\n                </div>`})),n+="</div>",resultsDiv.innerHTML=n}function truncate(e,t){return(e=e.replaceAll(/<[^>]*>/g,"")).length<t?e:e.substring(0,t-3)+"..."}function offlineSearch(e){let t=window.docs,n="#"===e[0]&&e.length>1?index.search(e.substring(1),[{field:"tags"}]):index.search(e,[{field:"title",limit:5},{field:"content",weight:10}]);const a=e=>{const t=n.filter((t=>t.field===e));return 0===t.length?[]:[...t[0].result]};return[...new Set([...a("title"),...a("content"),...a("tags")])].map((e=>{let n=t[e];return n.content=truncate(n.content,400),n.tags=n.tags.filter((e=>"gardenEntry"!=e&&"note"!=e)),n}))}window.lastSearch=""</script>
<main class="content cm-s-obsidian">
<header>
<h1 data-note-icon="">GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding</h1>
<div class="header-meta">
<div class="header-tags">
</div>
<div class="timestamps"><div><i icon-name="calendar-plus"></i> <span class="human-date" data-date="2025-06-08T20:20:47.426+08:00"></span></div><div><i icon-name="calendar-clock"></i> <span class="human-date" data-date="2025-05-15T20:13:37.000+08:00"></span></div></div></div>
</header>
<h2 id="摘要" tabindex="-1">摘要</h2>
<p>目前，安卓恶意软件的流行程度依然相当高。恶意程序越来越多地采用先进的混淆技术，这给安全专业人员带来了更大的挑战，因为它们具有更强的伪装能力、变种增多以及检测难度不断上升。利用语义特征为解决这些挑战提供了一个有前景的途径。嵌入在操作码和 API 调用图中的丰富语义信息已被确定为区分良性与恶意应用程序的关键所在。因此，诸如 Word2vec 等各种自然语言处理（NLP）技术被用于对 Dalvik 操作码序列的特征进行编码，从而产生嵌入表示。鉴于恶意软件开发者往往选择语义相似的 API 来实现类似的功能，因此可以推测此类 API 的操作码嵌入应具有相似的特征。然而，仅提取统计信息的简单 NLP 模型不足以理解混淆后的恶意软件的行为模式，因为它们无法提供全面的语义洞察。为了弥合这一差距，我们提出了一种基于 CodeBERT 和 TextCNN 的新型轻量级嵌入模型。该模型旨在高效且精确地对指令序列进行表示。因此，我们引入了 GSEDroid，这是一个 Android 恶意软件检测框架，它使用带有权限和指令语义特征的 API 调用图来描述 APK。这种方法将检测挑战转化为通过图神经网络算法执行的图分类任务。我们方法的有效性已通过与其他技术的比较分析得到了验证。实验结果表明，我们的 GraphSage + SAGPooling 模型达到了 99.47% 的准确率和 99.44% 的 F1 值，突显了其在 Android 恶意软件检测中的有效性。</p>
<h2 id="介绍" tabindex="-1">介绍</h2>
<p>随着全球范围内安卓设备的广泛普及，庞大的用户群体构成了一个巨大的攻击面。根据 Statcounter 于 2023 年发布的《全球操作系统市场份额报告》（GlobalStats，2023），截至 2023 年 2 月，安卓操作系统在全球市场的占有率高达 43.88%。尽管安卓操作系统的开放性和可定制性为用户提供了更多的选择和灵活性，但也为其恶意软件的传播和安装提供了便利。安卓恶意软件攻击者利用各种策略进行盈利，包括窃取敏感信息、展示广告和勒索要求。当前的网络犯罪趋势表明，攻击者的关注重点已转向安卓恶意软件的质量而非数量。G DATA 移动安全报告（CyberDefence General Dynamics，2023）指出，在 2022 年上半年，攻击者的恶意软件感染应用程序的发布频率呈持续下降趋势，从之前的平均每分钟发布五个降至两到三个。尽管攻击的频率有所下降，但其质量却明显提高。中国国家互联网应急中心（CNCERT）发布的《2020 年中国互联网网络安全形势概述》（2020 年）显示，当年共发现约 303 万个新的移动互联网恶意程序，较上年增长 8.5%。然而，从 2014 年到 2020 年，被移除的恶意应用程序数量每年都有所下降。这种情况凸显了控制恶意安卓应用程序源头传播的迫切需求，需要有效切断传播渠道并提高恶意软件检测的准确性。这些挑战增加了对安卓恶意软件检测技术的需求，需要更复杂和有效的方法来应对不断变化的网络威胁环境。</p>
<p>当前针对安卓恶意软件检测的研究广泛采用数据挖掘和机器学习方法来开发有效的检测机制。这些方法大致可分为两类。第一类采用多种机器学习算法，例如支持向量机（SVM）、随机森林和 XGBoost 等。这种方法涉及从安卓应用程序包（APK）中提取代码、资源、配置以及其他关键元素，以形成特征向量。然后使用由机器学习算法构建的分类器对这些向量进行处理，以区分良性软件和恶意软件。然而，传统的机器学习算法通常更适合解决相对简单的问题，并且在处理大规模数据和复杂模式方面可能表现不佳（LeCun 等人，2015 年；赵等人，2021 年 b）。第二类则标志着深度学习算法在安卓恶意软件检测领域的应用。将深度学习技术应用于特定场景已成为一种主流趋势，其中图神经网络（GNNs）成为了深度学习领域的一个焦点研究方向。越来越多的研究人员正在采用来自不同领域的技术来开发安卓恶意软件检测方法。创新之处包括源自图像分析（Yadav 等人，2022 年）、音频（Tarwireyi 等人，2023 年）、网络流量（Wang 等人，2018 年）和日志（Meng 等人，2021 年）的方法。早期的研究主要集中在语法特征上，例如请求的权限（Arora 等人，2020 年）、意图行为、组件间通信（ICCs）（Cai 等人，2019 年）和系统调用（Bhat 等人，2023 年）。</p>
<p>最近，图深度学习技术的迅速发展引起了广泛关注。这些技术擅长学习高质量的图表示，从而能够高效地在图上完成各种任务。因此，嵌入在图数据中的语义特征，如函数调用图（FCGs），变得越来越关键。研究人员目前正构建图表以分析和检测恶意软件。例如，GDroid（Gao 等人，2021 年）基于调用关系和 API 使用模式将 APK 和 API 映射到一个大型异构图上，将原始问题转化为节点分类任务。这种方法利用图卷积网络（GCN）为 Android 恶意软件检测和家族分类引入了一种新颖的方法。此外，PermPair（Arora 等人，2020 年）提出了一种通过从清单文件中提取权限对构建图来检测恶意应用程序的新方法。</p>
<p>先前的研究（Khan 等人，2021 年；Pekta ̧ s 和 Acarman，2020 年；Zhang 等人，2018 年）表明，可执行文件中的指令码可能包含潜在的信息。鉴于它们能够精细地表示程序的行为模式，Dalvik 指令码被认为是区分良性与恶意 Android 软件的最常见静态特征之一。然而，目前缺乏处理这些特征的标准化方法。人工设计的特征提取过程在资源和时间方面具有显著的代价。为了实现这一过程的自动化，并有效地识别潜在信息并提取深层特征，构建一个能够有效表示指令操作码序列的恰当嵌入模型至关重要。指令操作码序列与文本数据的相似性以及它们与英语单词的紧密相似性，使得它们成为适合用自然语言处理技术处理的合适对象。近年来，已有若干研究提出了使用 N-gram、Word2vec 等方法来处理指令操作码序列。然而，这些方法并非毫无局限性。对于这些自然语言处理模型在指令操作码序列嵌入表示中的有效性，缺乏对比评估和合理的解释。这种评估对于确定这些模型在准确捕捉指令操作码序列的语义本质方面的适用性和有效性至关重要。</p>
<p>为了解决将操作码序列转换为向量嵌入这一难题，我们采用了创新的方法，将预训练模型 CodeBERT 的强大功能与 TextCNN 模型相结合。这种融合方式精准地将 API 的操作码序列映射为嵌入向量。CodeBERT 为我们提供了丰富的上下文信息以及捕捉长距离依赖关系的能力，而 TextCNN 则擅长自主识别和提取有价值的局部特征。</p>
<p>此外，我们还进一步整合了权限特征，以实现对 API 节点特征的更全面描述。这种方法使我们能够构建一个融入复杂语义层次的 API 调用图，其中每个图都独特地代表一个 APK。</p>
<p>在此基础上，我们引入了两种图神经网络技术：GraphSage 和 SAGPooling。利用 GraphSage 的基于采样的归纳学习框架，我们从相邻节点中聚合信息并捕捉局部邻域结构，从而能够有效地从 API 调用图中学习节点表示，并增强我们对 API 调用模式的理解。此外，我们利用 SAGPooling 的自注意力机制在池化过程中保留最具有信息量的节点，这有助于模型准确捕捉调用图的关键结构特征。这一方面对于恶意软件检测至关重要，因为恶意行为可能在 APK 的特定部分有所体现。这些技术的整合为我们的 Android 恶意软件检测框架 GSEDroid 提供了强大的学习基础设施。这使我们能够深入理解并识别 API 调用图中隐藏的复杂模式，显著增强了我们检测恶意软件的能力。</p>
<p>总之，本文的贡献有三个方面：</p>
<ol>
<li>我们引入了一种用于表示 Dalvik 操作码序列的新嵌入模型，利用预训练的 CodeBERT 和 TextCNN 模型的综合优势，以实现对 API 的高效语义嵌入。</li>
<li>
<ol start="2">
<li>我们将诸如 APK 的权限属性、API 调用图的结构特征以及 Dalvik 操作码序列的语义特征等各种特性进行整合。这促成了 GSEDroid 的开发，这是一个利用先进的图分类算法来检测 Android 恶意软件的框架。</li>
</ol>
</li>
<li>
<ol start="3">
<li>GSEDroid 的有效性通过大量的对比实验得到了证实。GraphSage 和 SAGPooling 组合的图模型在公开数据集上的检测准确率达到了 99.47%。</li>
</ol>
</li>
</ol>
<p>本文的其余部分组织如下：第 2 节概述了相关工作。第 3 节描述了所提出的 Android 恶意软件检测框架 GSEDroid。第 4 节描述了我们的实验数据集、实验设置、结果分析以及与其他检测方法的比较。第 5 节提供了对未来工作的见解，第 6 节总结了本文。</p>
<hr>
<h2 id="相关工作" tabindex="-1">相关工作</h2>
<h2 id="建议的方法" tabindex="-1">建议的方法</h2>
<p>如图1所示，GSEDORID的总体框架包括原始功能提取和功能处理，构建具有节点属性特征以表示APK的API调用图，并使用图形神经网络将Android恶意软件检测问题转换为图形分类任务。算法1展示具有节点属性特征的API调用图的生成算法。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image.png"><source media="(max-width:480px)" srcset="/img/optimized/bNn32LF_Ma-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/bNn32LF_Ma-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/bNn32LF_Ma-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/bNn32LF_Ma-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image.png" width=""></picture><br>
!<a class="internal-link is-unresolved" href="/404" target=""> 300</a>!<a class="internal-link is-unresolved" href="/404" target=""> 300</a></p>
<h3 id="3-1" tabindex="-1">3.1 功能处理模块</h3>
<p>在 Android 系统中，权限主要分为两类：AOSP（Android 开源项目）权限和第三方权限。AOSP 权限是 Android 操作系统固有的，由 Android 的开发者和维护者定义。这些权限控制着应用程序对设备和系统资源的访问权限。另一方面，第三方权限是由独立的开发者或组织创建的，并由第三方应用程序请求，获得用户授权后才会生效。该数据集包含约 12,000 个第三方权限（确切数量为 12,564 个）。由于 APK 中的大多数 API 方法都需要 AOSP 相关权限，并且考虑到恶意软件对 Android 基本权限的常见滥用，我们从数据集中提取了 334 个 AOSP 权限。从中，我们根据请求频率选择了前 64 个权限。本研究通过解析 Manifest 文件中的标签来收集表 1 中详细列出的与权限相关的信息。提取的请求权限的存在被用作构建权限特征向量的基础。由于某些 API 是第三方库中的方法，其没有可访问的指令序列，而另一些则通过 JNI 与原生代码链接，这些代码通常用 C/C++ 等语言编写，因此我们旨在对输入到模型中的指令类型进行标准化。此外，为了使 API 调用图中的节点数量与具有可获取特征的节点数量相匹配，我们使用并改编了 Androguard 工具（Desnos 和 Gueguen，2012），这是一个用于反编译和分析应用程序文件的开源 Python 库。在构建 API 调用图时，我们排除了 DalvikVMObject 中未定义的方法，包括某些第三方库的方法。这些方法可能包含各种代码类型，例如静态 Java 字节码、动态加载的运行时代码以及通过 JNI 链接的 C/C++ 等原生语言的方法（.so 文件）（Qiu 等人，2022 年）。我们还自动过滤掉孤立节点，即既不调用其他 API 也不被其他 API 调用的节点。这种对调用图的修剪旨在降低其复杂性，同时尽可能多地保留恶意软件中常见的敏感 API。随后，我们使用 Python 脚本对 API 操作码序列的语义特征进行了分析。大约有 218 种不同的 Dalvik 操作码。图 2 展示了每个 API 包含的操作码数量。大多数 API 包含的操作码数量少于 250 个。为了帮助 CodeBERT 识别 Dalvik 操作码并将其纳入词汇表，我们对操作码进行了映射操作，如表 2 所示。<br>
!<a class="internal-link is-unresolved" href="/404" target=""> 300</a>!<a class="internal-link is-unresolved" href="/404" target=""> 300</a></p>
<p>3.2. 构建包含节点特征的 API 调用图的模块<br>
图 3 展示了用于处理操作码序列的嵌入模型流程。如算法 1 所述，API 的操作码序列被输入到预训练的 CodeBERT-base 模型中。通过一系列 12 个堆叠的 Transformer 编码器块，我们获得了 CodeBERT 输出中每个标记的向量表示，形成了维度为 <code>(N*768)</code> 的词向量矩阵。对于表 2 中的操作码，如“add-double”，我们将它们分解并映射为两个标记：“add”和“double”。这种方法旨在最大限度地利用嵌入在预训练模型 CodeBERT 中的先验知识。要做到这一点，确保从操作码映射出的所有标记都包含在 CodeBERT 的词汇表中至关重要。因此，这里的“N”并不表示操作码序列的数量，而是表示映射的操作码序列所对应的标记数量。然后，这些序列由 TextCNN 层处理。为了确保向量长度一致，根据前面提到的操作码数量范围执行填充或截断操作。使用不同大小的卷积核进行卷积运算，并以 ReLU 作为激活函数。每个卷积核的大小均采用 64 个滤波器来表示，正如 Zhang 和 Wallace（2016 年）所指出的那样，他们提到采用相同大小的多个滤波器旨在从同一窗口中学习互补特征。随后的 K-Max 池化（其中 k 设为 1）从每个特征向量中选择前 K 个特征，然后将它们连接起来形成一个复合向量表示。随后，一个线性层将这些特征压缩到固定维度 32、64、96、128。提取的权限特征向量和操作码特征向量与 API 调用图进行连接和合并，从而创建 APK 的图表示。将预训练的 CodeBERT 模型与 TextCNN 模型相结合，用于从 Dalvik 操作码序列中提取特征向量，具有整合多层语义信息的优势。</p>
<p>CodeBERT 由于其自注意力机制，能够捕捉序列中的长距离依赖关系和复杂的上下文信息。该模型在预训练期间从自然语言和编程语言数据中学习了大量的先验知识，能够捕捉丰富的语义表示，尤其是由于 Dalvik 操作码与编程语言和自然语言非常相似。这意味着该模型更能够理解指令与数据流之间的关系。另一方面，TextCNN（文本卷积神经网络）通过将特征提取层与不同滤波器大小相结合进一步提取局部特征，从而从各种粒度的信息中获取特征。操作码序列可能包含特定的语法结构或模式，TextCNN 可以通过卷积操作捕获这些特征，有助于从操作码序列中提取关键特征。这两种方法的结合提供了强大的特征提取机制，从不同角度分析输入序列，增强了模型对 Dalvik 操作码序列的理解，有效地提高了特征提取的质量，并更全面地捕捉语义信息。将这两种方法相结合，能够将嵌入向量压缩为维度更小的向量，从而提高模型的训练速度并降低计算成本。对 CodeBERT 进行微调通常需要相对较多的时间，因为这需要大量的数据集和多次训练迭代；然而，对 TextCNN 进行微调所需的时间则较少，这是因为该模型体积较小、训练速度更快且计算成本更高。在资源受限的环境中，单独使用 CodeBERT 可能效率不高。TextCNN 是一种轻量级的卷积神经网络，能够在保持性能的同时降低计算需求。</p>
<h3 id="3-3-gnn" tabindex="-1">3.3 基于GNN的检测模块</h3>
<p>在我们的最终阶段，这些图被输入到图神经网络（GNN）中用于图分类任务。我们所采用的 GNN 框架包含三个主要组成部分：过滤层、激活层和图池化层。在这个框架内，过滤层和激活层的功能是生成增强的 API 节点特征，而图池化层则将这些节点特征聚合起来，以生成能够捕捉调用图完整信息的高级特征。这一过程产生了具有更抽象和更高层次节点特征的粗化图。图 4 中我们的 GNN 结构由几个由过滤层、激活层和正则化组成的块组成，随后是图池化和读出层，最终形成一个通过全连接层处理的图级别表示，以产生输出。选择合适的过滤层和图池化层在 GNN 构建中至关重要，因为它们的设计直接影响模型的性能及其理解图结构的能力。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-4.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-4.png"><source media="(max-width:480px)" srcset="/img/optimized/MI3PohqG50-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/MI3PohqG50-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/MI3PohqG50-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/MI3PohqG50-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-4.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-4.png" width=""></picture></p>
<h3 id="3-3-1" tabindex="-1">3.3.1 过滤层</h3>
<p>我们最终使用的过滤层是SageConv，它结合了节点邻居的功能与其自己的特征以生成新的节点表示。 SageConv的公式如下：<br>
<picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-6.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-6.png"><source media="(max-width:480px)" srcset="/img/optimized/jOby0eNjrF-367.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/jOby0eNjrF-367.jpeg">
<img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-6.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-6.png" width=""></picture><br>
这里，N（𝑖）表示节点𝑖的邻居，𝑊是权重矩阵，AGGREGATE是一个可微的、置换不变的函数（如均值、和或最大池化）。GraphSage的独特之处在于它的归纳能力，这意味着它可以泛化到未见过的节点，这对于动态变化的Android应用来说尤为重要。</p>
<h3 id="3-3-2" tabindex="-1">3.3.2 图池化层</h3>
<p>我们选择的图形池层是sagpooling或自适应图池。该层订购并根据通过训练学到的分数选择节点，从而提取关键子图结构。它计算每个节点的分数，然后根据这些分数进行节点下采样或汇总。如果x表示节点特征，而s是分数向量，则sagpooling的过程可以包括以下步骤：<br>
<picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-7.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-7.png"><source media="(max-width:480px)" srcset="/img/optimized/EViPqRAoUn-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/EViPqRAoUn-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/EViPqRAoUn-607.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/EViPqRAoUn-607.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/GSEDroid%EF%BC%9AGNN-based%20Android%20malware%20detection%20framework%20using%20lightweight%20semantic%20embedding_image-7.png" alt="GSEDroid：GNN-based Android malware detection framework using lightweight semantic embedding_image-7.png" width=""></picture>在这里，<mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.375ex" xmlns="http://www.w3.org/2000/svg" width="11.697ex" height="1.97ex" role="img" focusable="false" viewBox="0 -705 5169.9 870.6" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D43A" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q492 659 471 656T418 643T357 615T294 567T236 496T189 394T158 260Q156 242 156 221Q156 173 170 136T206 79T256 45T308 28T353 24Q407 24 452 47T514 106Q517 114 529 161T541 214Q541 222 528 224T468 227H431Q425 233 425 235T427 254Q431 267 437 273H454Q494 271 594 271Q634 271 659 271T695 272T707 272Q721 272 721 263Q721 261 719 249Q714 230 709 228Q706 227 694 227Q674 227 653 224Q646 221 643 215T629 164Q620 131 614 108Q589 6 586 3Q584 1 581 1Q571 1 553 21T530 52Q530 53 528 52T522 47Q448 -22 322 -22Q201 -22 126 55T50 252Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(786,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="msub" transform="translate(1674,0)"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(836,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(645,0)"><path data-c="1D436" d="M50 252Q50 367 117 473T286 641T490 704Q580 704 633 653Q642 643 648 636T656 626L657 623Q660 623 684 649Q691 655 699 663T715 679T725 690L740 705H746Q760 705 760 698Q760 694 728 561Q692 422 692 421Q690 416 687 415T669 413H653Q647 419 647 422Q647 423 648 429T650 449T651 481Q651 552 619 605T510 659Q484 659 454 652T382 628T299 572T226 479Q194 422 175 346T156 222Q156 108 232 58Q280 24 350 24Q441 24 512 92T606 240Q610 253 612 255T628 257Q648 257 648 248Q648 243 647 239Q618 132 523 55T319 -22Q206 -22 128 53T50 252Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1405,0)"><path data-c="1D442" d="M740 435Q740 320 676 213T511 42T304 -22Q207 -22 138 35T51 201Q50 209 50 244Q50 346 98 438T227 601Q351 704 476 704Q514 704 524 703Q621 689 680 617T740 435ZM637 476Q637 565 591 615T476 665Q396 665 322 605Q242 542 200 428T157 216Q157 126 200 73T314 19Q404 19 485 98T608 313Q637 408 637 476Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2168,0)"><path data-c="1D445" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(2927,0)"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z" style="stroke-width:3"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi><mi>N</mi><msub><mi>N</mi><mrow data-mjx-texclass="ORD"><mi>S</mi><mi>C</mi><mi>O</mi><mi>R</mi><mi>E</mi></mrow></msub></math></mjx-assistive-mml></mjx-container>是由图神经网络计算得的分数，TOP-K是一个选择操作，基于分数s选择X中的顶部k节点，而Gnnpool是另一个图形神经网络，在选定节点功能x'上执行汇总操作。</p>
<p>Sagpooling允许模型筛选整个图表以滤除关键功能，从而实现了更高的分类任务准确性。通过整合图形和sagpooling的优势，我们的模型不仅在功能提取方面更强大，而且在处理大规模和复杂的API调用图方面效率更高，这是识别和分类数千个Android应用程序的必要性。</p>
</main>
<aside>
<div class="sidebar">
<div class="sidebar-container">
<div class="toc">
<div class="toc-title-container">
<div class="toc-title">
On this page
</div>
</div>
<div class="toc-container">
<nav class="toc">
<ol>
<li><a href="#摘要">摘要</a>
</li>
<li><a href="#介绍">介绍</a>
</li>
<li><a href="#相关工作">相关工作</a>
</li>
<li><a href="#建议的方法">建议的方法</a>
<ol>
<li><a href="#3-1">3.1 功能处理模块</a>
</li>
<li><a href="#3-3-gnn">3.3 基于GNN的检测模块</a>
</li>
<li><a href="#3-3-1">3.3.1 过滤层</a>
</li>
<li><a href="#3-3-2">3.3.2 图池化层</a>
</li>
</ol>
</li>
</ol>
</nav>
</div>
</div>
<div class="backlinks">
<div class="backlink-title" style="margin:4px 0!important">Pages mentioning this page</div>
<div class="backlink-list"><div class="backlink-card"><i icon-name="link"></i><a href="/硕士研究生/科研/恶意软件检测文献阅读/恶意软件检测文献阅读/" data-note-icon="" class="backlink">恶意软件检测文献阅读</a>
</div></div>
</div>
</div>
</div>
</aside>
<style>#tooltip-wrapper{background:var(--background-primary);padding:1em;border-radius:4px;overflow:hidden;position:fixed;width:80%;max-width:400px;height:auto;max-height:300px;font-size:.8em;box-shadow:0 5px 10px rgba(0,0,0,.1);opacity:0;transition:opacity .1s;unicode-bidi:plaintext;overflow-y:scroll;z-index:10}#tooltip-wrapper:after{content:"";position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;width:100%;unicode-bidi:plaintext;height:75px}</style>
<div style="opacity:0;display:none" id="tooltip-wrapper">
<div id="tooltip-content">
</div>
</div>
<iframe style="display:none;height:0;width:0" id="link-preview-iframe" src="">
</iframe>
<script>var opacityTimeout,contentTimeout,transitionDurationMs=100,iframe=document.getElementById("link-preview-iframe"),tooltipWrapper=document.getElementById("tooltip-wrapper"),tooltipContent=document.getElementById("tooltip-content"),linkHistories={};function hideTooltip(){opacityTimeout=setTimeout((function(){tooltipWrapper.style.opacity=0,contentTimeout=setTimeout((function(){tooltipContent.innerHTML="",tooltipWrapper.style.display="none"}),transitionDurationMs+1)}),transitionDurationMs)}function showTooltip(t){var e=t.target,o=e.getClientRects()[e.getClientRects().length-1],i=window.pageYOffset||document.documentElement.scrollTop,n=t.target.getAttribute("href");if(-1===n.indexOf("http")||-1!==n.indexOf(window.location.host)){let t=n.split("#")[0];linkHistories[t]?(tooltipContent.innerHTML=linkHistories[t],tooltipWrapper.style.display="block",setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)):(iframe.src=t,iframe.onload=function(){tooltipContentHtml="",tooltipContentHtml+='<div style="font-weight: bold; unicode-bidi: plaintext;">'+iframe.contentWindow.document.querySelector("h1").innerHTML+"</div>",tooltipContentHtml+=iframe.contentWindow.document.querySelector(".content").innerHTML,tooltipContent.innerHTML=tooltipContentHtml,linkHistories[t]=tooltipContentHtml,tooltipWrapper.style.display="block",tooltipWrapper.scrollTop=0,setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),console.log(e),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)}),tooltipWrapper.style.left=o.left-tooltipWrapper.offsetWidth/2+o.width/2+"px",window.innerHeight-o.top<tooltipWrapper.offsetHeight?tooltipWrapper.style.top=o.top+i-tooltipWrapper.offsetHeight-10+"px":window.innerHeight-o.top>tooltipWrapper.offsetHeight&&(tooltipWrapper.style.top=o.top+i+35+"px"),o.left+o.width/2<tooltipWrapper.offsetWidth/2?tooltipWrapper.style.left="10px":document.body.clientWidth-o.left-o.width/2<tooltipWrapper.offsetWidth/2&&(tooltipWrapper.style.left=document.body.clientWidth-tooltipWrapper.offsetWidth-20+"px")}}function setupListeners(t){t.addEventListener("mouseleave",(function(t){hideTooltip()})),tooltipWrapper.addEventListener("mouseleave",(function(t){hideTooltip()})),t.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout),showTooltip(t)})),tooltipWrapper.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout)}))}window.addEventListener("load",(function(t){document.querySelectorAll(".internal-link").forEach(setupListeners),document.querySelectorAll(".backlink-card a").forEach(setupListeners)}))</script>
<script>window.location.hash&&document.getElementById(window.location.hash.slice(1)).classList.add("referred"),window.addEventListener("hashchange",(e=>{const t=e.oldURL.split("#");t[1]&&document.getElementById(t[1]).classList.remove("referred");const n=e.newURL.split("#");n[1]&&document.getElementById(n[1]).classList.add("referred")}),!1);const url_parts=window.location.href.split("#"),url=url_parts[0],referrence=url_parts[1];document.querySelectorAll(".cm-s-obsidian > *[id]").forEach((function(e){e.ondblclick=function(e){const t=url+"#"+e.target.id;navigator.clipboard.writeText(t)}}))</script>
<script src="https://fastly.jsdelivr.net/npm/luxon@3.2.1/build/global/luxon.min.js"></script>
<script defer="defer">TIMESTAMP_FORMAT="MMM dd, yyyy h:mm a",document.querySelectorAll(".human-date").forEach((function(e){date=e.getAttribute("data-date")||e.innerText,parsed_date=luxon.DateTime.fromISO(date),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromSQL(date)),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromHTML(date)),e.innerHTML=parsed_date.toFormat(TIMESTAMP_FORMAT)}))</script>
<script>lucide.createIcons({attrs:{class:["svg-icon"]}})</script>
</body>
</html>
