<!doctype html>
<html lang="zh-CN">
<head>
<title>2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script async type="module">import mermaid from"https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs"</script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/prism.min.js" integrity="sha512-hpZ5pDCF2bRCweL5WoA0/N1elet1KYL5mx3LP555Eg/0ZguaHawxNvEjF6O3rufAChs16HVNhEc6blF/rZoowQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/plugins/autoloader/prism-autoloader.min.js" integrity="sha512-sv0slik/5O0JIPdLBCR2A3XDg/1U3WuDEheZfI/DI5n8Yqc3h5kjrnr46FGBNiUAJF7rE4LHKwQ/SoSLRKAxEA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script async src="https://cdn.jsdelivr.net/npm/lucide@0.115.0/dist/umd/lucide.min.js"></script>
<script>window.addEventListener("load",(()=>{document.querySelectorAll(".callout").forEach((e=>{const t=getComputedStyle(e).getPropertyValue("--callout-icon"),l=t&&t.trim().replace(/^lucide-/,"");if(l){const t=e.querySelector(".callout-title");if(t){const e=document.createElement("div"),c=document.createElement("i");e.appendChild(c),c.setAttribute("icon-name",l),e.setAttribute("class","callout-icon"),t.insertBefore(e,t.firstChild)}}})),lucide.createIcons(),Array.from(document.querySelectorAll(".callout.is-collapsible")).forEach((e=>{e.querySelector(".callout-title").addEventListener("click",(t=>{e.classList.contains("is-collapsed")?e.classList.remove("is-collapsed"):e.classList.add("is-collapsed")}))}))}))</script>
<script async src="https://fastly.jsdelivr.net/npm/force-graph@1.43.0/dist/force-graph.min.js"></script>
<script async src="https://fastly.jsdelivr.net/npm/@alpinejs/persist@3.11.1/dist/cdn.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/alpinejs@3.11.1/dist/cdn.min.js" async></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.25.0/themes/prism-okaidia.min.css" integrity="sha512-mIs9kKbaw6JZFfSuo+MovjU+Ntggfoj8RwAmJbVXQ5mkAX5LlgETQEweFPI18humSPHymTb5iikEOKWF7I8ncQ==" crossorigin="anonymous" referrerpolicy="no-referrer" async>
<script src="https://fastly.jsdelivr.net/npm/whatwg-fetch@3.6.2/dist/fetch.umd.min.js" crossorigin="anonymous" referrerpolicy="no-referrer" async></script>
<link href="/styles/digital-garden-base.css" rel="stylesheet">
<link href="/styles/obsidian-base.css" rel="stylesheet">
<link href="/styles/_theme.74516f71.css" rel="stylesheet">
<link href="/styles/custom-style.css" rel="stylesheet">
<link rel="icon" href="/favicon.ico" sizes="any">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="manifest" href="/manifest.webmanifest">
<style></style>
<style></style>
</head>
<body class="theme-light markdown-preview-view markdown-rendered markdown-preview-section css-settings-manager mod-windows is-frameless is-maximized is-hidden-frameless is-focused obsidian-app theme-light show-inline-title show-ribbon show-view-header css-settings-manager theme-default line-style-solid folder-default blockquote-normal callout-normal checkbox-default tag-default link-default heading-default responsive-tile-height oz-show-all-num">
<nav class="navbar">
<div class="navbar-inner">
<a href="/" style="text-decoration:none">
<h1 style="margin:15px!important">czc&#39;s digital garden</h1>
</a>
</div>
<div class="search-button align-icon" onclick="toggleSearch()">
<span class="search-icon">
<i icon-name="search"></i>
</span>
<span class="search-text">
<span>Search</span>
<span style="font-size:.6rem;padding:2px 2px 0 6px;text-align:center;transform:translateY(4px)" class="search-keys">
CTRL + K
</span>
</span>
</div>
</nav>
<div class="search-container" id="globalsearch" onclick="toggleSearch()">
<div class="search-box">
<input type="search" id="term" placeholder="Start typing...">
<div id="search-results"></div>
<footer class="search-box-footer">
<div class="navigation-hint">
<span>Enter to select</span>
</div>
<div class="navigation-hint align-icon">
<i icon-name="arrow-up" aria-hidden="true"></i>
<i icon-name="arrow-down" aria-hidden="true"></i>
<span>to navigate</span>
</div>
<div class="navigation-hint">
<span>ESC to close</span>
</div>
</footer>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js"></script>
<script>document.addEventListener("DOMContentLoaded",init,!1),document.addEventListener("DOMContentLoaded",setCorrectShortcut,!1),window.toggleSearch=function(){document.getElementById("globalsearch").classList.contains("active")?document.getElementById("globalsearch").classList.remove("active"):(document.getElementById("globalsearch").classList.add("active"),document.getElementById("term").focus())},window.toggleTagSearch=function(e){console.log(e.textContent);const t=e.textContent;t&&(window.document.getElementById("term").value=t.trim(),window.toggleSearch(),window.search())};const loadingSvg='\n    <svg width="100" height="100" viewBox="0 0 45 45" xmlns="http://www.w3.org/2000/svg" stroke="#fff">\n      <g fill="none" fill-rule="evenodd" transform="translate(1 1)" stroke-width="2">\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="1.5s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="1.5s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="1.5s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="6" stroke-opacity="0">\n              <animate attributeName="r"\n                   begin="3s" dur="3s"\n                   values="6;22"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-opacity"\n                   begin="3s" dur="3s"\n                   values="1;0" calcMode="linear"\n                   repeatCount="indefinite" />\n              <animate attributeName="stroke-width"\n                   begin="3s" dur="3s"\n                   values="2;0" calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n          <circle cx="22" cy="22" r="8">\n              <animate attributeName="r"\n                   begin="0s" dur="1.5s"\n                   values="6;1;2;3;4;5;6"\n                   calcMode="linear"\n                   repeatCount="indefinite" />\n          </circle>\n      </g>\n  </svg>';function debounce(e,t,n){var a;return function(){var r=this,i=arguments,c=n&&!a;clearTimeout(a),a=setTimeout((function(){a=null,n||e.apply(r,i)}),t),c&&e.apply(r,i)}}function setCorrectShortcut(){navigator.platform.toUpperCase().indexOf("MAC")>=0&&document.querySelectorAll(".search-keys").forEach((e=>e.innerHTML="⌘ + K"))}function createIndex(e){const t=e=>e.toLowerCase().split(/([^a-z]|[^\x00-\x7F])/),n=new FlexSearch.Document({cache:!0,charset:"latin:extra",optimize:!0,index:[{field:"content",tokenize:"reverse",encode:t},{field:"title",tokenize:"forward",encode:t},{field:"tags",tokenize:"forward",encode:t}]});return e.forEach(((e,t)=>{n.add({id:t,title:e.title,content:e.content,tags:e.tags})})),n}async function init(){let e=!0;if(localStorage.getItem("searchIndex")){let{date:t,docs:n}=JSON.parse(localStorage.getItem("searchIndex"));if("2025-06-04T13:41:18.385Z"===t){e=!1;let t=createIndex(n);window.docs=n,window.index=t}}if(e){let e=await(await fetch("/searchIndex.json?v=2025-06-04T13:41:18.385Z")).json(),t=createIndex(e);localStorage.setItem("searchIndex",JSON.stringify({date:"2025-06-04T13:41:18.385Z",docs:e})),window.docs=e,window.index=t}document.addEventListener("keydown",(e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),toggleSearch()),"Escape"===e.key&&document.getElementById("globalsearch").classList.remove("active"),document.getElementById("globalsearch").classList.contains("active")){if("ArrowDown"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.nextElementSibling?t.nextElementSibling.classList.add("active"):document.querySelector(".searchresult").classList.add("active")):document.querySelector(".searchresult").classList.add("active");let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("ArrowUp"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t?(t.classList.remove("active"),t.previousElementSibling?t.previousElementSibling.classList.add("active"):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling||e.classList.add("active")}))):document.querySelectorAll(".searchresult").forEach((e=>{e.nextElementSibling&&e.classList.add("active")}));let n=document.querySelector(".searchresult.active");n&&n.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}if("Enter"===e.key){e.preventDefault();let t=document.querySelector(".searchresult.active");t&&(window.location.href=t.querySelector("a").href)}}}));const t=debounce(search,200,!1);field=document.querySelector("#term"),field.addEventListener("keydown",(e=>{"ArrowDown"!==e.key&&"ArrowUp"!==e.key&&t()})),resultsDiv=document.querySelector("#search-results");const n=new URL(location.href).searchParams;n.get("q")&&(field.setAttribute("value",n.get("q")),toggleSearch(),search())}async function search(){let e=field.value.trim();if(!e)return;if(e==lastSearch)return;console.log(`search for ${e}`),window.lastSearch=e,resultsDiv.innerHTML=loadingSvg;let t=offlineSearch(e),n="";if(!t.length){let t=document.createElement("p");return t.innerText=`No results for "${e}"`,resultsDiv.innerHTML="",void resultsDiv.appendChild(t)}n+='<div style="max-width:100%;">',t.forEach((e=>{e.tags&&e.tags.length>0?n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        <div class="header-meta">\n                            <div class="header-tags">\n                                ${e.tags.map((e=>'<a class="tag" href="JavaScript:Void(0);">#'+e+"</a>")).join("")}\n                            </div>\n                        </div>\n                        ${e.content}\n                    </div>\n                </div>`:n+=`<div class="searchresult">\n                    <a class="search-link" href="${e.url}">${e.title}</a>\n                    <div onclick="window.location='${e.url}'">\n                        ${e.content}\n                    </div>\n                </div>`})),n+="</div>",resultsDiv.innerHTML=n}function truncate(e,t){return(e=e.replaceAll(/<[^>]*>/g,"")).length<t?e:e.substring(0,t-3)+"..."}function offlineSearch(e){let t=window.docs,n="#"===e[0]&&e.length>1?index.search(e.substring(1),[{field:"tags"}]):index.search(e,[{field:"title",limit:5},{field:"content",weight:10}]);const a=e=>{const t=n.filter((t=>t.field===e));return 0===t.length?[]:[...t[0].result]};return[...new Set([...a("title"),...a("content"),...a("tags")])].map((e=>{let n=t[e];return n.content=truncate(n.content,400),n.tags=n.tags.filter((e=>"gardenEntry"!=e&&"note"!=e)),n}))}window.lastSearch=""</script>
<main class="content cm-s-obsidian">
<header>
<h1 data-note-icon="">2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案</h1>
<div class="header-meta">
<div class="header-tags">
</div>
<div class="timestamps"><div><i icon-name="calendar-plus"></i> <span class="human-date" data-date="2024-12-15T21:27:14.292+08:00"></span></div><div><i icon-name="calendar-clock"></i> <span class="human-date" data-date="2024-12-15T23:30:23.411+08:00"></span></div></div></div>
</header>
<p>ccfA</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image.png"><source media="(max-width:480px)" srcset="/img/optimized/339Rx_MQXO-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/339Rx_MQXO-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/339Rx_MQXO-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/339Rx_MQXO-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image.png" width=""></picture></p>
<p>SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案</p>
<h1 id="摘要" tabindex="-1">摘要</h1>
<p>提出了一种名为SDAC的新型缓慢老化解决方案，用于解决Android恶意软件检测中的模型老化问题，该问题是由于在恶意软件检测过程中未能适应Android规范的变化所致。与现有解决方案中的检测模型定期重新训练不同，SDAC通过评估新API对恶意软件检测的贡献以及现有API的贡献来有效地进化。在SDAC中，通过API调用序列的上下文来评估API的贡献，这些序列是从Android应用程序中提取的。应用神经网络在序列上为API分配向量，其中API向量的差异被视为语义距离。然后，SDAC根据它们的语义距离对所有API进行聚类，以在训练阶段创建特征集，并在检测阶段扩展特征集以包括所有新API。SDAC无需通过任何新的实际标记的应用程序集进行训练，就可以通过简单地识别检测阶段出现的新API来适应Android规范的变化。在2011年至2016年的数据集上进行的广泛实验中，与维持对API变化有弹性的最先进的Android恶意软件检测解决方案MaMaDroid相比，SDAC实现了显著更高的准确率和显著更慢的老化速度。</p>
<h1 id="引言" tabindex="-1">引言</h1>
<p>大多数Android恶意软件检测模型迅速老化。根据Zhu和Dumitras的研究[1]，一个在2012年生成的Android恶意软件检测模型未能检测到Gappusin家族的任何恶意软件，而2014年的模型则能检测到其中的大多数。在百度的Wang的另一项研究中[2]，一个在百度开发的Android恶意软件检测模型的召回率在前六个月下降了7.6%。最近的研究发现，模型老化的主要原因是Android规范中API随时间变化[1]，[3]。显然，利用新添加的API执行恶意行为的恶意软件样本可能会逃避老化模型的检测。解决Android恶意软件检测模型老化的常见方法是更新基于签名的恶意软件检测的签名数据库，或者使用具有真实标签（即恶意软件和良性软件）的新Android应用更新恶意软件检测模型。然而，这个过程通常既耗时又昂贵，可能涉及许多领域专家在样本标记和跨多个组织的数据共享上的努力。此外，新收集的应用的真实标签可能不便于或及时获得，甚至在现实生活中可能会出错。例如，我们分别在2017年7月和2018年7月从VirusTotal1下载了42808个应用的报告。在这些应用中，大约11%（4717/42808）的应用在2017年7月被所有的杀毒引擎标记为“良性”，但在2018年7月至少有一个杀毒引擎将其标记为“危险”，表明标签可能长时间错误。因此，迫切需要开发一种缓慢老化的解决方案，该方案在更长时间内保持恶意软件检测的准确性，并且可以在不依赖新应用的真实标签的情况下更新。</p>
<p>虽然Android API的变化已被确认为导致Android恶意软件检测模型老化的主要问题[1]，[3]，但在缓慢老化解决方案的设计中尚未严格解决对API变化的适应。最近的一个名为PikaDroid的解决方案[4]通过利用恶意软件检测中敏感API的上下文信息解决了老化问题。然而，由于PikaDroid的特征集在其设计中保持不变，它不适应Android规范的变化。另一种方法，MaMaDroid[5]提出了一种对Android规范变化具有弹性的检测方法。特别是，MaMaDroid首先将应用程序编程接口（API）抽象为API执行路径中的相应包（或包家族）。然后，它将所有抽象路径总结为一个马尔可夫模型，并将马尔可夫模型转换为每个应用的特征向量，用于模型训练和测试。通过将API抽象为包，MaMaDroid对现有包中新添加的API具有弹性，并且在Android恶意软件检测中的表现显著优于其他解决方案，如DroidAPIMiner。然而，MaMaDroid没有解决任何新包对恶意软件检测的贡献问题，因为马尔可夫模型中由任何新包引起的转换不会转换为MaMaDroid中的特征。根据Android开发者文档[6]，与前一个API级别相比，平均每个API级别增加了大约340个新API和4个新包。这些新包和新API是导致Android恶意软件检测模型老化的重要因素。如果不更新模型，现有的恶意软件检测模型的性能，包括MaMaDroid，可能会随着越来越多的新包和API被添加到Android规范中并用于Android应用开发而显著下降。在本文中，我们开发了一种基于学习的、缓慢老化的Android恶意软件检测解决方案。我们的缓慢老化解决方案名为SDAC，代表基于语义距离的API聚类。SDAC根据API的上下文确定API对恶意行为的贡献，这指的是在应用执行的API调用序列中，API周围固定大小窗口内的API。特别是，在具有真实标签的应用训练集的基础上，SDAC从应用中提取API调用序列。基于提取的API序列，SDAC应用两层神经网络将API嵌入到API向量中，并将这些向量排列到一个向量空间中。在向量空间中，共享常见API上下文的API彼此靠近。根据API向量聚类形成特征集，其中每个特征定义为所有API的集合，其对应的API向量在同一聚类中。对于训练集中的每个应用，通过从特征集到特征的一对一映射生成二进制特征向量。如果应用没有使用映射特征中的任何API，则应用的特征向量中的元素被赋值为零，否则为一。任何分类模型都可以基于从训练应用及其相应标签派生的特征向量构建。为了使SDAC缓慢老化，识别新API对恶意软件检测的贡献是很重要的，而不需要知道使用这些API的新应用的真实标签。在SDAC中执行此类识别的关键技术是特征扩展。在这一步中，测试集应用中出现的每个新API都被添加到根据API向量空间中测量的距离最接近的特征中。一个新API对恶意软件检测的贡献被建模为等同于同一特征中其他API的贡献。由于所有“旧”API的贡献已在训练阶段评估过，因此在测试阶段不需要重新训练训练过的分类模型。在一系列测试集上随时间进行恶意软件检测时，SDAC可以以两种主要模式执行，SDAC-FEO和SDAC-FMU。SDAC-FEO是“SDAC-Feature Extension Only”的简称，在这种模式下，每次使用新的测试集进行特征扩展，而训练过的分类模型始终保持不变。SDAC-FMU是“SDAC-Feature and Model Updating”的简称，它与新的测试集一起更新分类模型和特征集。尽管在某些情况下分类器会发生变化，但SDAC-FEO和SDAC-FMU都不需要在连续时间段内使用任何标记的新样本，同时仍然可以保持高准确性，因此整个解决方案SDAC被视为缓慢老化。SDAC-FEO和SDAC-FMU都需要当前测试集在特征扩展中完全可用，以收集新API的上下文。为了放宽这一限制，我们为在线检测单个应用设计了SDAC-FEO-OL和SDAC-FMU-OL，而不必等待整个测试集可用。特别是，它们使用现有的分类模型进行单个应用的在线检测，不进行特征扩展，而在整个测试集可用后，它们转向其离线版本进行更新。我们使用2011年至2016年的70142个Android应用样本评估了SDAC在不同模式和版本中的性能。为简单起见，我们将2011年的样本用于训练和5折交叉验证的场景称为我们的“默认设置”，而2012年至2016年的样本用于测试。在默认设置中的评估结果显示，SDAC-FEO的F分数从2011年到2016年平均每年下降4.81%，而MaMaDroid平均每年下降7.67%。SDAC-FEO在这些测试集上的平均F分数为87.23%，高于同一情况下MaMaDroid的59.03%，提高了28.2%。与SDAC-FEO相比，SDAC-FMU进一步将老化速度从平均每年4.81%降低到0.10%，并将平均F分数从87.23%提高到97.09%。虽然在线版本在对每个应用进行在线分类时更有效，但它们的准确性略低，老化速度略高于相应的非在线版本。</p>
<h1 id="sdac" tabindex="-1">基础SDAC</h1>
<p>一个Android应用可以被视为一组操作路径，其中每个操作路径是在特定条件下可以在Android平台上执行的一系列操作。在SDAC的设计中，我们关注Android应用通过API调用操作访问Android系统服务和资源的情况。一个Android应用可能使用在其开发时Android规范中提供的任何API。随着时间的推移，Android规范从API级别1发展到API级别27，不断增加了许多新的API。当然，一个Android应用不能使用在其开发时尚不存在的新API。</p>
<p>假设：SDAC使用一组与真实标签（包括恶意软件和良性软件）相关联的Android应用进行训练，训练集中的应用是在同一时间段开发的。训练后，SDAC用于对其他时间段的测试集中的所有应用进行分类。假设在使用SDAC时，测试集中的应用没有可用的真实标签。首先开发基础SDAC来对一个测试集中的应用进行分类，该测试集是在训练集之后的一个时间段内开发的。然后，它在不同的模式和版本中扩展，以对在连续后来的时间段内开发的多个测试集中的应用进行分类。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-1.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-1.png"><source media="(max-width:480px)" srcset="/img/optimized/2II3PMlKKc-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/2II3PMlKKc-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/2II3PMlKKc-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/2II3PMlKKc-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-1.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-1.png" width=""></picture></p>
<p>结构：基础SDAC的结构如图1所示。它包括两个阶段，一个训练阶段，SDAC在此阶段使用训练集进行训练；一个检测阶段，SDAC在此阶段用于在测试集中检测恶意软件。在这两个阶段中，基础SDAC都经历四个步骤，其中前两个步骤，包括API路径提取和API向量嵌入，在两个阶段中都有。最后两个步骤是在训练阶段生成API聚类和训练分类模型，在检测阶段扩展API聚类和测试分类模型。</p>
<h2 id="2-1-api" tabindex="-1">2.1 API路径提取</h2>
<p>SDAC的第一步是从每个应用程序中提取一组API调用路径。可以利用适当的静态分析工具，例如FlowDroid [7]，将每个应用程序从字节码转换为适当的表示形式（例如，Jimple代码），并提取其程序方法之间的有向调用图。从调用图中，SDAC为每个方法提取一个调用图片段，并排除任何是另一个调用图片段的子图的调用图片段。目标方法的调用图片段包括调用图中所有方法及其之间的所有有向链接。在一个调用图片段中，所有方法最多距离目标方法d个链接，在调用图中，指向不使用API的方法的链接不计入片段中。SDAC然后从每个调用图片段中派生所有API调用路径。附录A中展示了API调用路径提取的一个真实世界示例，可以在计算机学会数字图书馆<a href="http://doi.ieeecomputersociety.org/10.1109/TDSC.2020.3005088%E6%89%BE%E5%88%B0%E3%80%82%E5%A6%82%E6%9E%9Cd%E8%B6%B3%E5%A4%9F%E5%A4%A7%EF%BC%8CSDAC%E5%B0%86%E4%B8%BA%E6%AF%8F%E4%B8%AA%E5%BA%94%E7%94%A8%E8%BE%93%E5%87%BA%E6%89%80%E6%9C%89%E5%8F%AF%E8%83%BD%E7%9A%84API%E8%B0%83%E7%94%A8%E8%B7%AF%E5%BE%84%EF%BC%8C%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E4%B8%8E%E7%A8%8B%E5%BA%8F%E5%A4%A7%E5%B0%8F%E6%88%90%E6%AD%A3%E6%AF%94%E7%9A%84%E9%9A%BE%E4%BB%A5%E5%A4%84%E7%90%86%E7%9A%84%E6%95%B0%E5%AD%97%5B8%5D%E3%80%82%E4%B8%BA%E4%BA%86%E4%BD%BFSDAC%E5%AE%9E%E7%94%A8%EF%BC%8C%E5%8F%82%E6%95%B0d%E8%A2%AB%E9%80%89%E6%8B%A9%E4%B8%BA%E7%9B%B8%E5%AF%B9%E8%BE%83%E5%B0%8F%EF%BC%8C%E7%AD%89%E4%BA%8E%E4%B8%8B%E4%B8%80%E5%B0%8F%E8%8A%82%E4%B8%AD%E6%8F%90%E5%88%B0%E7%9A%84%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8FS%E3%80%82" target="_blank" class="external-link">http://doi.ieeecomputersociety.org/10.1109/TDSC.2020.3005088找到。如果d足够大，SDAC将为每个应用输出所有可能的API调用路径，这是一个与程序大小成正比的难以处理的数字[8]。为了使SDAC实用，参数d被选择为相对较小，等于下一小节中提到的窗口大小S。</a></p>
<h2 id="2-2-api" tabindex="-1">2.2 API向量嵌入</h2>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-2.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-2.png"><source media="(max-width:480px)" srcset="/img/optimized/JwSVe9nphZ-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/JwSVe9nphZ-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/JwSVe9nphZ-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/JwSVe9nphZ-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-2.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-2.png" width=""></picture></p>
<p>此步骤的目标是将每个API嵌入到一个n维实值向量中，该向量的范围在[0, 1]之间，根据API在一组应用中的上下文。一组应用中API的上下文被定义为在所有从应用集中提取的API调用路径中，包含该API的固定大小窗口内所有邻近API的集合。具有相似上下文的不同API在向量空间中被映射得很接近。API向量嵌入过程在<strong>图2</strong>中进行了说明。基于在“API路径提取”步骤中提取的API调用路径，SDAC构建了一个API词汇表，其中包含这些路径中的所有唯一API。对于API词汇表中的每个目标API以及每个提取的API路径，SDAC派生出所有最多距离目标API S个API的邻近API，其中S称为窗口大小。然后，SDAC将每个目标API与其每个邻近API配对，并使用所有这些配对来训练Skip-Gram模型，这是一个具有输入层、隐藏层和输出层的神经网络[9]。在模型中，一个实值输入-隐藏矩阵WV用于将输入向量转换为隐藏输入向量，一个实值隐藏-输出矩阵W'用于进一步将隐藏输入向量转换为输出向量，其中V是API词汇表大小，K是API向量大小。在训练过程中，目标API及其所有配对API被视为Skip-Gram模型的输入和目标输出。对于一个目标API，Skip-Gram模型的输入是一个大小为V的独热编码向量，其中目标API对应的索引指向一，所有其他索引指向零。类似地，对于一个配对API，目标输出是一个大小为V的独热编码向量，其中配对API对应的索引指向一，所有其他索引指向零。对于每个目标API，Skip-Gram模型通过使用输入-隐藏矩阵、隐藏-输出矩阵和softmax函数（即标准化指数函数）依次转换输入向量来计算输出向量。然后，Skip-Gram模型使用反向传播更新这两个矩阵中的元素，这是神经网络监督学习的常见优化步骤，以最小化计算输出和目标输出之间的总误差。在用所有API对训练完Skip-Gram模型后，SDAC为每个API输出一个API向量。在<strong>图2</strong>中，APIT的向量是输入-隐藏矩阵中的第T行，其中T是APIT在API词汇表中的索引。一个API的向量嵌入了API的上下文，这代表了在目标输出中编码的所有邻近API。如果两个不同的API被嵌入到相似的API向量中，因此它们具有相似的上下文，因为在模型训练中优化计算输出以逼近它们的目标输出。</p>
<h2 id="2-3-api" tabindex="-1">2.3 API簇生成与扩展</h2>
<p>基础SDAC的第三步是在训练阶段进行API簇的生成，在检测阶段进行API簇的扩展。此步骤的目的是根据API之间的语义距离将API词汇表中的API分组成若干簇，其中语义距离定义为API向量空间中的欧几里得距离。此步骤的输出是一组API簇，将用作下一步为每个应用生成特征向量的特征集。</p>
<h3 id="api" tabindex="-1">API簇生成</h3>
<p>在训练阶段，SDAC应用来自[10]的同大小k均值聚类算法于从训练集计算得出的API向量。该算法将API向量划分为k个簇，每个API向量属于最近均值的簇，所有簇的大小差异最多为一。使用这些簇，通过簇到特征的一对一映射定义了一个初始特征集，每个特征包括所有在同一簇中出现的API的API向量。同一特征中的API由于API向量的接近性，共享相似的上下文，并因此在我们的模型中对恶意软件检测作出类似的贡献。选择同大小k均值算法是因为它可以有效避免偏斜的聚类结果，从而最大化良性应用和恶意应用的特征向量之间的差异。有关我们选择的同大小k均值聚类算法的详细信息，请参阅在线补充材料中的附录B。</p>
<h3 id="api-1" tabindex="-1">API簇扩展</h3>
<p>在检测阶段，SDAC输出从上一步的测试集中派生的一组API向量。现在，它扩展初始特征集以包括出现在测试集的API词汇表中但不在训练集的API词汇表中的所有新API。这一步也被称为特征扩展，因为每个簇被视为特征集中的一个特征。通常，如果新APIY与特征X中的API相比，在所有特征中具有最小的平均语义距离，则SDAC将特征X扩展以包括新APIY，其中语义距离通过从测试集派生的API向量来测量。在一个特征中，如果一个API在测试集的任何应用中都不存在，除非该特征中没有API存在于测试集中，在这种情况下，使用从训练集派生的相应API向量进行语义距离计算，否则SDAC将其从平均语义距离计算中排除。在所有新API被包括在特征扩展后，从初始特征集定义了一个扩展特征集。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-3.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-3.png"><source media="(max-width:480px)" srcset="/img/optimized/TADUC2I42k-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/TADUC2I42k-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/TADUC2I42k-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/TADUC2I42k-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-3.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-3.png" width=""></picture></p>
<p><strong>图3</strong>展示了一个特征扩展的玩具示例。在<strong>图3</strong>中，从训练集生成的向量空间中形成了两个簇，包括包含APIA、APIB和APIC的特征P，以及包含APID、APIE和APIF的特征Q。现在考虑一个在从测试集生成的向量空间中的新API APIY，计算APIY与特征P和特征Q的每个簇的平均语义距离。由于特征Q与APIY的平均距离最小，因此它被扩展以包括APIY进行特征扩展。之后，特征Q将包含四个API：APID、APIE、APIF和APIY，而特征P保持不变。注意，APIB在测试集中没有出现，因此在向量空间中没有代表性的API向量，所以在计算中简单地被排除。生成扩展特征集的目的是使用现有API的贡献来模拟新API对恶意软件检测的贡献，因为由于测试集中缺乏真实标签，后者不能直接通过分类模型测量。</p>
<h2 id="2-4" tabindex="-1">2.4 分类模型训练与测试特征向量生成</h2>
<p>给定一个特征集，无论是训练阶段的初始特征集还是检测阶段的扩展特征集，SDAC都会为每个应用生成一个二进制特征向量，通过特征集的一对一映射实现。如果应用没有使用其映射特征中的任何API，则应用的特征向量中的元素为零，否则为一。</p>
<h3 id="分类模型训练" tabindex="-1">分类模型训练</h3>
<p>在训练阶段，SDAC为训练集中的每个应用生成一个特征向量，并将特征向量与应用的真实标签关联。然后，SDAC使用所有特征向量和关联的标签训练一个分类模型。</p>
<h3 id="分类模型测试" tabindex="-1">分类模型测试</h3>
<p>在检测阶段，SDAC为测试集中的每个应用生成一个特征向量。然后，SDAC使用训练好的分类模型根据其特征向量作为模型输入输出每个应用的预测标签。</p>
<h2 id="2-5" tabindex="-1">2.5 模型投票</h2>
<p>在SDAC中，特征集中的一个特征可能包含多个API。有可能一些API被良性应用使用，而另一些则被恶意应用使用。单一特征难以区分良性和恶意应用。因此，利用特征集中的所有特征进行恶意软件检测会更好。为了进一步提高其准确性，SDAC利用多个特征集的区分能力而不是单一特征集。特别是，SDAC在其第三步执行聚类算法m次（m ≥ 1），从而生成m个初始特征集和m个扩展特征集。在训练阶段，每个初始特征集上训练一个分类模型，然后在检测阶段在相应的扩展特征集上进行测试。总共m个分类模型，如果至少t个（t ≤ m）分类模型同意某个标签，则SDAC输出应用的预测标签为“恶意软件”，否则输出为“良性软件”。在我们的实验中，我们发现使用多重投票的SDAC的F分数提高了大约3到10个百分点。关于调整t和m的细节在第4节中解释。</p>
<h2 id="3-sdac" tabindex="-1">3 SDAC的两种模式和在线版本</h2>
<p>虽然基础SDAC只关注处理一个测试集，但它可以通过两种不同的模式扩展，SDAC-FEO和SDAC-FMU，来处理多个测试集T1、T2、...、TN，其中应用是在不同时间段开发的，包含一些新的API。SDAC-FEO和SDAC-FMU之间的区别在于，在检测阶段，SDAC-FEO只进行特征扩展，而SDAC-FMU还进行特征和模型更新。</p>
<h3 id="3-1-sdac-feo" tabindex="-1">3.1 SDAC-FEO</h3>
<p>在训练阶段，SDAC-FEO接受一个训练集作为输入，并以与基础SDAC相同的方式输出m个初始特征集和m个分类模型。在将其应用于测试集T1时的检测阶段，每个初始特征集被扩展为“T1的扩展特征集”。然后，T1中的每个应用根据m个“T1的扩展特征集”转换为m个特征向量。最后，使用m个分类模型通过模型投票根据其特征向量预测每个应用的标签。当SDAC-FEO应用于测试集TN（N ≥ 2）时，每个“TN-1的扩展特征集”被视为“TN的初始特征集”，然后以与基础SDAC中的“特征扩展”步骤相同的方式扩展为“TN的扩展特征集”。之后，TN中的每个应用根据m个“TN的扩展特征集”转换为m个特征向量。与之前相同的m个分类模型用于根据其特征向量预测每个应用的标签。<strong>图4</strong>显示了SDAC-FEO的结构，包括一个训练集（2011年的应用）和三个测试集（2012年、2013年和2014年的应用）。在此图中，2011年的应用集用于生成初始特征集和训练分类模型。在应用于2012年和2013年的应用后，使用相同的分类模型对2014年的应用进行分类。2014年应用的扩展特征集是通过三次顺序扩展2011年应用的初始特征集生成的。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-4.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-4.png"><source media="(max-width:480px)" srcset="/img/optimized/5KmTL6o-xs-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/5KmTL6o-xs-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/5KmTL6o-xs-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/5KmTL6o-xs-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-4.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-4.png" width=""></picture></p>
<h2 id="3-2-sdac-fmu" tabindex="-1">3.2 SDAC-FMU</h2>
<p>SDAC-FMU在其训练阶段与SDAC-FEO相同，在应用于测试集T1的检测阶段也相同。当它应用于其他测试集T2; ...;TN时，它执行额外的特征和模型更新步骤。现在假设SDAC-FMU已经应用于测试集T1; ...;TN-1，为这些集合中的每个应用产生了一个预测标签（即伪标签）。当SDAC-FMU应用于测试集TN时，它首先从训练集和T1; ...;TN-1的联合中生成m个“TN的初始特征集”（与基础SDAC生成初始特征集的方式相同）。我们称这个过程为特征更新。注意，这与SDAC-FEO不同，SDAC-FEO中的初始特征集从未改变。</p>
<p>然后，SDAC-FMU从头开始为TN训练m个分类模型，使用（i）训练集中带有真实标签的应用，以及（ii）T1; ...;TN-1中带有伪标签的应用，其中每个应用根据m个“TN的初始特征集”转换为m个特征向量。我们称这个过程为模型更新。注意，在我们的假设中，测试集中的应用没有真实标签；因此，SDAC-FMU使用T1; ...;TN-1中的应用的伪标签进行模型更新。</p>
<p>模型更新后，SDAC-FMU将每个“TN的初始特征集”扩展为“TN的扩展特征集”（与基础SDAC扩展初始特征集的方式相同）。然后，TN中的每个应用根据m个“TN的扩展特征集”转换为m个特征向量。最后，用于TN的经过模型更新训练的分类模型用于根据其特征向量预测TN中每个应用的标签。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-5.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-5.png"><source media="(max-width:480px)" srcset="/img/optimized/U9o8a0HI_f-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/U9o8a0HI_f-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/U9o8a0HI_f-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/U9o8a0HI_f-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-5.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-5.png" width=""></picture></p>
<p><strong>图5</strong>显示了SDAC-FMU的结构，包括一个训练集（2011年的应用）和三个测试集（2012年、2013年和2014年的应用）。当SDAC-FMU在用2011年的应用训练并应用于2012年和2013年的应用后，应用于2014年的应用时，它首先从2011年、2012年和2013年的应用的联合中为2014年的应用生成初始特征集。然后，SDAC-FMU为联合中的每个应用生成特征向量，并使用（i）带有真实标签的2011年应用，以及（ii）带有伪标签的2012年和2013年应用，为2014年的应用训练分类模型，其中每个应用根据其特征向量进行模型训练。最后，SDAC-FMU扩展2014年应用的初始特征集，根据扩展的特征集将每个2014年的应用转换为特征向量，并使用2014年应用的分类模型根据其特征向量对每个2014年的应用进行分类。</p>
<h2 id="3-3" tabindex="-1">3.3 在线版本</h2>
<p>SDAC-FEO和SDAC-FMU都要求当前的测试集TN在执行特征扩展之前可用，然后才能应用于对该测试集中的每个应用进行分类。为了克服这一限制，我们开发了它们的在线版本，SDAC-FEO-OL和SDAC-FMU-OL，在这些版本中跳过了特征扩展步骤，可以在不等待整个测试集可用的情况下及时对单个应用进行分类。</p>
<h3 id="sdac-feo-ol" tabindex="-1">SDAC-FEO-OL</h3>
<p>SDAC-FEO-OL在训练阶段与SDAC-FEO相同，生成m个初始特征集和m个分类模型。当SDAC-FEO-OL用于对T1中的每个应用进行分类时，它根据m个初始特征集将应用转换为m个特征向量。然后，它使用已经训练好的m个分类模型根据其特征向量输出每个应用的预测标签。在T1中的所有应用被分类后，SDAC-FEO-OL以与SDAC-FEO相同的方式为T1生成m个扩展特征集。</p>
<p>当SDAC-FEO-OL用于对TN中的每个应用进行分类时（N ≥ 2），它根据TN-1的m个扩展特征集将应用转换为m个特征向量。然后，它使用相同的已经训练好的分类模型通过其特征向量为TN中的每个应用输出预测标签。</p>
<p>在TN中的所有应用被处理后，SDAC-FEO-OL转而使用SDAC-FEO再次处理TN，生成TN的m个扩展特征集。这是为了为下一个时间段检测应用做准备。</p>
<h3 id="sdac-fmu-ol" tabindex="-1">SDAC-FMU-OL</h3>
<p>SDAC-FMU-OL在训练阶段与SDAC-FMU相同，为T1生成m个初始特征集和T1的m个分类模型。当SDAC-FMU-OL应用于根据T1的m个初始特征集使用T1的m个分类模型对T1中的每个应用进行分类时，与SDAC-FEO-OL相同。</p>
<p>在T1中的所有应用被处理后，SDAC-FMU-OL转而使用SDAC-FMU再次处理T1，生成T2的m个初始特征集和T2的m个分类模型。</p>
<p>当SDAC-FMU-OL应用于测试集TN时（N ≥ 2），它根据TN的m个初始特征集将每个应用转换为m个特征向量。然后，它使用TN的m个分类模型根据其特征向量为TN中的每个应用预测标签。在TN中的所有应用被处理后，SDAC-FMU-OL以与SDAC-FMU相同的方式执行特征和模型更新。</p>
<h3 id="注释" tabindex="-1">注释</h3>
<p>当在线检测单个应用时，首先根据它使用的API集将应用转换为m个特征向量，然后由m个分类模型进行分类。SDAC的前三个步骤（API路径提取、API向量嵌入和API簇生成与扩展）在此过程中不执行，这使得在线版本比离线版本快得多。</p>
<p>SDAC-FEO-OL和SDAC-FMU-OL与在线机器学习在恶意软件检测中的直接应用不同[11]，因为我们的在线版本不需要使用真实标签进行模型更新，而在线机器学习则需要[12]。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-6.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-6.png"><source media="(max-width:480px)" srcset="/img/optimized/ZBUlUkAwL4-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/ZBUlUkAwL4-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/ZBUlUkAwL4-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/ZBUlUkAwL4-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-6.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-6.png" width=""></picture></p>
<h1 id="4-sdac" tabindex="-1">4 评估 SDAC 数据集</h1>
<p>SDAC 通过一个包含约 36k 个良性软件样本和 35k 个恶意软件样本的数据集进行评估，这些样本是从一个开放的 Android 应用程序集合项目中随机选择的 [13]。表1 展示了我们的数据集概览，该数据集包含从 2011 年到 2016 年六年间开发的良性软件样本和恶意软件样本。每个应用的时间定义为其 APK 文件打包的时间，这可以在其 APK 中的 .dex 文件里找到 [14]。我们的数据集中样本的标签是根据我们在 2018 年 7 月获取的 VirusTotal [15] 的报告来决定的。基于这些报告，我们将结果为零的应用标记为“良性”，将报告中包含超过阈值 Tmal 的正面结果的应用标记为“恶意”。</p>
<p>在恶意软件检测的文献中，用于标记“恶意”应用的 Tmal 值有不同的设定。根据 Roy 等人的研究，从 VirusTotal 只收到一个正面报告的恶意软件样本被认为是“低质量”，而从 54 个扫描器中收到超过十个正面结果的被认为是“高质量” [3]。Arp 等人则标记任何从一组选定的扫描器中收到至少 20% 正面结果的应用为恶意 [16]。Alex 等人进行了一个大规模研究，汇总了 Virustotal 的扫描器结果，并认为如果来自 34 个不同扫描器中的 4 个或更多的正面扫描结果，则可以信任恶意标签 [17]。在我们的实验中，我们在分别用 Tmal = 4、9 和 15 标记的三个不同数据集上评估 SDAC，这些数据集来自 Virustotal2 的总共 63 个扫描器。我们在默认情况下设置 Tmal = 15，并在第 4.5 节展示了 Tmal = 4 和 Tmal = 9 的结果。表1 显示了标记为 Tmal = 15 的数据集中不同年份的独特新 API 数量和所有 API 的数量。如果一个 API 在我们数据集中之前开发的应用中未被使用，则该年被认为是新的。</p>
<h2 id="工具和参数选择" tabindex="-1">工具和参数选择</h2>
<p>我们选择以下工具和参数来评估 SDAC。在 API 路径提取步骤中，我们选择 FlowDroid 来从每个应用中提取程序类之间的有向调用图 [7]。用于 API 路径提取的参数 d 被设置为与 API 向量嵌入的窗口大小相同。在 API 向量嵌入步骤中，我们依赖 gensim 工具包 [18] 来实现 Skip-Gram 模型，并从一组应用中派生 API 向量，其中我们选择窗口大小 S = 5 和 API 向量大小 K = 200（即 API 向量空间的维度）。在 API 簇生成和扩展步骤中，我们选择来自开源数据挖掘框架 ELKI [10] 的同大小 k-means 簇算法，并设置簇的数量 k = 1000。在分类模型训练和测试步骤中，我们选择线性 SVM 模型作为我们的分类模型，并设置分类模型的数量 m = 9，以及模型投票中的阈值 t = 3。我们调整这些参数，以及其他参数（例如，API 向量嵌入的迭代次数和学习率），以在使用相同训练集（2011 年的应用）的交叉验证中产生最佳结果，同时受到我们计算资源（一台具有 3.3 GHz CPU 和 12GB 内存的桌面计算机）的限制。这些参数在各种测试集上评估 SDAC 的所有实验中使用。</p>
<h2 id="k-m-t" tabindex="-1">参数选择：k、m 和 t</h2>
<p>参数 k（如在 k-means 聚类算法中）、m（即 SDAC 使用的分类模型数量）和 t（即模型投票中使用的阈值）被调整以在训练集上的交叉验证中获得 SDAC 的最佳性能，这个训练集在我们的实验中是 2011 年的数据集。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-8.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-8.png"><source media="(max-width:480px)" srcset="/img/optimized/-MIXkzsZyB-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/-MIXkzsZyB-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/-MIXkzsZyB-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/-MIXkzsZyB-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-8.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-8.png" width=""></picture></p>
<p>图6 显示了 SDAC 在不同 k 值的交叉验证中的性能。SDAC 的 F 分数从 k = 50 快速增加到 k = 500，并在 k = 1000 之后保持稳定。由于更高的 k 值会增加模型训练和测试的时间，我们在实验中选择 k = 1000。</p>
<p><picture src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-7.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-7.png"><source media="(max-width:480px)" srcset="/img/optimized/9-QUGccEjS-500.webp" type="image/webp">
<source media="(max-width:480px)" srcset="/img/optimized/9-QUGccEjS-500.jpeg">
<source media="(max-width:1920px)" srcset="/img/optimized/9-QUGccEjS-700.webp" type="image/webp"><source media="(max-width:1920px)" srcset="/img/optimized/9-QUGccEjS-700.jpeg"><img class="" src="/img/user/czc%E7%9F%A5%E8%AF%86%E5%BA%93/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/9-%E9%99%84%E4%BB%B6/%E9%99%84%E4%BB%B6/2022.03.SDAC%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%9F%BA%E4%BA%8E%E8%AF%AD%E4%B9%89%E8%B7%9D%E7%A6%BB%E7%9A%84%20API%20%E9%9B%86%E7%BE%A4%E8%BF%9B%E8%A1%8C%20Android%20%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6%E6%A3%80%E6%B5%8B%E7%9A%84%E6%85%A2%E8%80%81%E5%8C%96%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88_image-7.png" alt="2022.03.SDAC：使用基于语义距离的 API 集群进行 Android 恶意软件检测的慢老化解决方案_image-7.png" width=""></picture></p>
<p>图7 显示了如何决定分类模型的数量 m 和阈值 t。在交叉验证实验中，当 m&gt;7 且 t=m 约为 30 到 40 百分比时，SDAC 达到了最高的 F 分数（超过 97%）。由于 SDAC 的开销与 m 成正比，我们选择 m = 9 和 t = 3，这在最小的 m 下达到了最高的 F 分数。</p>
<h2 id="4-1-sdac-feo" tabindex="-1">4.1 SDAC-FEO的评估</h2>
<p>进行了三组实验来评估 SDAC-FEO。第一组实验是为了评估 SDAC-FEO 在使用同一时间段开发的样本集进行交叉验证时的准确性。第二组实验是为了评估 SDAC-FEO 在一个时间段的样本集上训练，并在后来时间段开发的其他样本集上测试时的老化速度。第三组实验是为了比较 SDAC-FEO 与 MaMaDroid [5] 的准确性和老化速度。</p>
<p>恶意软件检测模型的准确性可以通过在恶意软件和良性软件集上的 F 分数来衡量。F 分数是精确度和召回率的调和平均值，其中精确度为 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-1.236ex" xmlns="http://www.w3.org/2000/svg" width="20.739ex" height="3.604ex" role="img" focusable="false" viewBox="0 -1046.4 9166.5 1592.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="50" d="M130 622Q123 629 119 631T103 634T60 637H27V683H214Q237 683 276 683T331 684Q419 684 471 671T567 616Q624 563 624 489Q624 421 573 372T451 307Q429 302 328 301H234V181Q234 62 237 58Q245 47 304 46H337V0H326Q305 3 182 3Q47 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM507 488Q507 514 506 528T500 564T483 597T450 620T397 635Q385 637 307 637H286Q237 637 234 628Q231 624 231 483V342H302H339Q390 342 423 349T481 382Q507 411 507 488Z" style="stroke-width:3"></path><path data-c="72" d="M36 46H50Q89 46 97 60V68Q97 77 97 91T98 122T98 161T98 203Q98 234 98 269T98 328L97 351Q94 370 83 376T38 385H20V408Q20 431 22 431L32 432Q42 433 60 434T96 436Q112 437 131 438T160 441T171 442H174V373Q213 441 271 441H277Q322 441 343 419T364 373Q364 352 351 337T313 322Q288 322 276 338T263 372Q263 381 265 388T270 400T273 405Q271 407 250 401Q234 393 226 386Q179 341 179 207V154Q179 141 179 127T179 101T180 81T180 66V61Q181 59 183 57T188 54T193 51T200 49T207 48T216 47T225 47T235 46T245 46H276V0H267Q249 3 140 3Q37 3 28 0H20V46H36Z" transform="translate(681,0)" style="stroke-width:3"></path><path data-c="65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" transform="translate(1073,0)" style="stroke-width:3"></path><path data-c="63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z" transform="translate(1517,0)" style="stroke-width:3"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(1961,0)" style="stroke-width:3"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(2239,0)" style="stroke-width:3"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(2633,0)" style="stroke-width:3"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(2911,0)" style="stroke-width:3"></path><path data-c="6E" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q450 438 463 329Q464 322 464 190V104Q464 66 466 59T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(3411,0)" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4244.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(5300.6,0)"><g data-mml-node="mrow" transform="translate(1222,516.4) scale(0.707)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(982,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1733,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g></g><g data-mml-node="mrow" transform="translate(220,-370) scale(0.707)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(982,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1733,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2011,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2789,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3067,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3816,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4567,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g></g><rect width="3625.9" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>Precision</mtext><mo>=</mo><mfrac><mrow><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>T</mi><mi>P</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo></mrow><mrow><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>T</mi><mi>P</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mo>+</mo><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>F</mi><mi>P</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container>，召回率为 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-1.236ex" xmlns="http://www.w3.org/2000/svg" width="18.046ex" height="3.604ex" role="img" focusable="false" viewBox="0 -1046.4 7976.4 1592.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="52" d="M130 622Q123 629 119 631T103 634T60 637H27V683H202H236H300Q376 683 417 677T500 648Q595 600 609 517Q610 512 610 501Q610 468 594 439T556 392T511 361T472 343L456 338Q459 335 467 332Q497 316 516 298T545 254T559 211T568 155T578 94Q588 46 602 31T640 16H645Q660 16 674 32T692 87Q692 98 696 101T712 105T728 103T732 90Q732 59 716 27T672 -16Q656 -22 630 -22Q481 -16 458 90Q456 101 456 163T449 246Q430 304 373 320L363 322L297 323H231V192L232 61Q238 51 249 49T301 46H334V0H323Q302 3 181 3Q59 3 38 0H27V46H60Q102 47 111 49T130 61V622ZM491 499V509Q491 527 490 539T481 570T462 601T424 623T362 636Q360 636 340 636T304 637H283Q238 637 234 628Q231 624 231 492V360H289Q390 360 434 378T489 456Q491 467 491 499Z" style="stroke-width:3"></path><path data-c="65" d="M28 218Q28 273 48 318T98 391T163 433T229 448Q282 448 320 430T378 380T406 316T415 245Q415 238 408 231H126V216Q126 68 226 36Q246 30 270 30Q312 30 342 62Q359 79 369 104L379 128Q382 131 395 131H398Q415 131 415 121Q415 117 412 108Q393 53 349 21T250 -11Q155 -11 92 58T28 218ZM333 275Q322 403 238 411H236Q228 411 220 410T195 402T166 381T143 340T127 274V267H333V275Z" transform="translate(736,0)" style="stroke-width:3"></path><path data-c="63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z" transform="translate(1180,0)" style="stroke-width:3"></path><path data-c="61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z" transform="translate(1624,0)" style="stroke-width:3"></path><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" transform="translate(2124,0)" style="stroke-width:3"></path><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z" transform="translate(2402,0)" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2957.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mfrac" transform="translate(4013.6,0)"><g data-mml-node="mrow" transform="translate(1270.4,516.4) scale(0.707)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(982,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1733,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g></g><g data-mml-node="mrow" transform="translate(220,-370) scale(0.707)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(982,0)"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(1733,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2011,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(2789,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3067,0)"><path data-c="1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(3816,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3"></path></g><g data-mml-node="mo" transform="translate(4704,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z" style="stroke-width:3"></path></g></g><rect width="3722.8" height="60" x="120" y="220"></rect></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>Recall</mtext><mo>=</mo><mfrac><mrow><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>T</mi><mi>P</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo></mrow><mrow><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>T</mi><mi>P</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mo>+</mo><mo data-mjx-texclass="ORD" stretchy="false">|</mo><mi>F</mi><mi>N</mi><mo data-mjx-texclass="ORD" stretchy="false">|</mo></mrow></mfrac></math></mjx-assistive-mml></mjx-container>。我们使用 TP（即真正例）表示正确检测为恶意软件的恶意软件集，FP（即假正例）表示错误检测为恶意软件的良性软件集，FN（即假负例）表示错误检测为良性软件的恶意软件集，TN（即真负例）表示正确检测为良性软件的良性软件集。</p>
<p>SDAC-FEO 首先在使用同一时间段开发的样本进行 5 折交叉验证中评估其准确性。表2 显示了 SDAC-FEO 在不同应用集上的精确度、召回率和 F 分数，这些应用集由应用开发的时间段表示。SDAC-FEO 的平均 F 分数为 98.25%，这为随时间评估 SDAC-FEO 提供了一个良好的起点。</p>
<h3 id="sdac-feo" tabindex="-1">SDAC-FEO 随时间的性能</h3>
<p>SDAC-FEO 的老化属性通过一系列实验评估，在这些实验中，SDAC-FEO 在一个时间段的样本集上训练，并在后来时间段开发的其他样本集上测试。图9 显示了 SDAC-FEO 随时间检测的 F 分数。当 SDAC-FEO 在比训练集新一年的测试集上评估时，其平均 F 分数为 97.49%，比其在交叉验证中的平均 F 分数（98.52%）下降了 1.03%。当 SDAC-FEO 在比训练集新两年、三年、四年和五年的测试集上评估时，其 F 分数分别下降到 95.02%、88.48%、78.22% 和 73.72%。SDAC-FEO 在这些实验中的平均老化速度为每年 F 分数下降 4.96%。</p>
<h3 id="api-2" tabindex="-1">API 簇扩展分析</h3>
<p>API 簇扩展是 SDAC 中的一个关键步骤。在此步骤中，初始特征集通过添加新的 API 来创建扩展特征集。这使 SDAC 能够评估新 API 对于使用已训练的分类模型（这些模型是用没有使用新 API 的标记应用集训练的）的恶意软件检测的贡献。在附录 C 中描述了将新 API 添加到现有 API 簇的几个案例研究，这些材料可在在线补充材料中找到。</p>
<p>为了进一步了解 API 簇扩展如何有助于减缓 SDAC-FEO 的老化，在本节中，我们计算了测试集应用的特征向量在有无特征扩展的情况下的变化，并提取每个特征在线性 SVM 模型中的权重，以了解这种变化将如何影响检测结果。</p>
<p>具体来说，在 SDAC-FEO 使用的 SVM 模型中，应用的特征向量与线性 SVM 模型的权重向量之间的内积是 SVM 模型中应用的特征向量的输出分数 [16]，这代表了 SVM 模型对将应用分类为恶意软件（如果输出分数为正）或良性软件（如果输出分数为负）的信心。SVM 模型的信心与输出分数的绝对值成正比。</p>
<p>对于测试集中的每个应用，我们根据初始特征集和扩展特征集分别为每个 SVM 模型转换两个特征向量。应用的输出分数差异定义为从扩展特征集派生的特征向量的输出分数减去从初始特征集派生的特征向量的输出分数。应用在 SVM 模型中的输出分数差异代表了由于 API 簇扩展引起的对应用的信心变化。正（或负）的输出分数差异意味着在将应用分类为恶意软件（或良性软件）时更有信心。</p>
<p>然后，我们检查测试集中所有恶意软件样本的平均输出分数差异，以及 SDAC-FEO 使用的所有分类模型的平均输出分数差异。我们还检查同一测试集中所有良性软件样本的平均输出分数差异。每个实验中（包括一个训练集和一个测试集）API 簇扩展的可区分性定义为所有恶意软件样本的平均输出分数差异减去所有良性软件样本的平均输出分数差异。如果 API 簇扩展的可区分性为正，则 API 簇扩展对恶意软件检测做出了积极贡献，从而有助于减缓 SDAC-FEO 的老化。</p>
<p>图8 显示了我们实验中 API 簇扩展带来的可区分性。API 簇扩展对恶意软件检测的贡献在我们的所有实验中都是积极的，这表明特征扩展确实将有助于提高 SDAC 的准确性。</p>
<h2 id="4-2-sdac-fmu-sdac-feo-ma-ma-droid" tabindex="-1">4.2 SDAC-FMU的评估：比SDAC-FEO和MaMaDroid老化更慢</h2>
<p>与 SDAC-FEO 相比，SDAC-FMU 采取了额外的特征更新和模型更新步骤以获得更好的性能。图10 显示其性能显著且持续优于 SDAC-FEO。在所有实验中，SDAC-FMU（97.39%）的平均 F 分数比 SDAC-FEO（92.89%）高出 4.50%。在老化速度方面，SDAC-FMU 的 F 分数平均每年下降 0.25%，而 SDAC-FEO 在同样情况下下降 4.96%。</p>
<p>由于 SDAC-FMU 使用伪标签更新其分类模型，我们也使用伪标签更新 MaMaDroid 分类模型以进行公平比较。图10 还显示，使用伪标签更新后的 MaMaDroid 性能几乎与之前相同。一个可能的原因是 MaMaDroid 在生成这些伪标签时忽略了新包的 API，更新过程因此加剧了由于忽略这些新 API 而在 MaMaDroid 模型中造成的错误。</p>
<h3 id="假阳性分析" tabindex="-1">假阳性分析</h3>
<p>我们检查了 SDAC-FMU 在 2011 年数据集上训练并在 2012 至 2016 年的五个测试集上评估时的误分类结果。为了理解为什么会发生假阳性误分类，我们计算了一个 API 的权重，方法是在 SDAC-FMU 应用于每个测试集时，平均所有 SVM 模型中包含此 API 的特征的权重。API 的权重可以用来衡量其对 SDAC-FMU 在分类应用时的信心贡献。我们为每个测试集按照它们的权重对所有 API 进行排序。我们选择每个排序列表中贡献最大的前 p 和后 p 的 API，分别是在将应用分类为恶意软件和良性软件时对 SDAC-FMU 信心贡献最大的 API。</p>
<p>对于一组应用，我们定义一个 API 的比例为该集合中使用此 API 的应用的百分比。我们进一步定义 top-p 比例（分别为 bottom-p 比例）为 top p API（分别为 bottom p API）的 API 比例的平均值。一组应用的 top-p 比例减去 bottom-p 比例意味着 SDAC-FMU 将该集合分类为恶意软件的信心。</p>
<p>图11 显示了真阳性（TP）、假阳性（FP）、假阴性（FN）和真阴性（TN）的典型 top-p 比例减去 bottom-p 比例值，其中 p = 1%。与 TN 相比，SDAC 在将 FP 分类为恶意软件时更有信心，而在将 TP 分类为恶意软件时信心最强。</p>
<p>在权重最高的 API 列表中，我们发现了一些如 getConfiguration() 和 getDeviceId() 等在之前研究中被认为是“危险”的 API [5]，[16]。使用这些 API 的良性应用更有可能被 SDAC 错误地检测为恶意软件。例如，40%（126/315）的假阳性和超过一半的真阳性（3310/5890）使用了 API getConfiguration()，而只有 23%（1289/5555）的真阴性使用了它。另一个例子，66%（208/315）的假阳性和 96%（5633/5890）的真阳性包含了 TelephonyManager 类中的 API getDeviceId()，而只有 22%（1245/5555）的真阴性使用了它。关于 1% 权重最高的 API 对假阳性结果的贡献，请参阅在线补充材料中的附录 E。</p>
<h3 id="假阴性分析" tabindex="-1">假阴性分析</h3>
<p>我们还检查了 SDAC-FMU 在 2011 年数据集上训练并在 2012 至 2016 年的五个测试集上评估时的假阴性。在所有测试集生成的 1076 个假阴性样本中，约 69%（638/931）被至少一个 VirusTotal 扫描器分类为“阳性：广告软件”。根据 TrendMicro [22] 的说法，广告软件可能来自于使用第三方广告库重新打包的良性应用；SDAC-FMU 很难将它们与真正的良性应用区分开来。</p>
<p>此外，约 8.5%（79/931）的假阴性样本被分类为“阳性：风险软件”，约 17.4%（162/931）被分类为“阳性：非病毒”至少由一个 VirusTotal 扫描器。根据卡巴斯基实验室 [23] 的解释，风险软件指的是容易被恶意攻击者利用的合法程序，非病毒与广告软件和风险软件有关。</p>
<p>图11 还显示，与 TP 相比，SDAC 在将 FN 分类为良性软件时更有信心，而在将 TN 分类为良性软件时信心最强。</p>
<h2 id="4-3-sdac-feo-ol-sdac-fmu-ol" tabindex="-1">4.3 SDAC-FEO-OL 和 SDAC-FMU-OL 的评估</h2>
<p>SDAC-FEO-OL 和 SDAC-FMU-OL 的性能在默认情况下进行评估，即使用最小的训练集（2011年的应用）和最长的测试集时间跨度（2012-2016年）进行实验。图12 显示 SDAC-FMU-OL 的表现与 SDAC-FMU 非常接近，而 SDAC-FEO-OL 与 SDAC-FEO 之间的性能差距更为明显。与 SDAC-FMU 相比，SDAC-FMU-OL 的 F 分数平均下降了 0.41%，最小下降为 -0.29%（2014年测试集），最大下降为 0.85%（2012年测试集）。与 SDAC-FEO 相比，SDAC-FEO-OL 的 F 分数平均下降了 3.45%，最小下降为 -0.30%（2013年测试集），最大下降为 7.97%（2014年测试集）。尽管如此，SDAC-FMU-OL 和 SDAC-FEO-OL 的表现仍显著优于 MaMaDroid。</p>
<h2 id="4-4" tabindex="-1">4.4 运行时性能</h2>
<p>SDAC 的运行时性能在一台装有 Intel(R) i5-4590 3.3 GHz CPU 和 12 GB 物理内存的桌面电脑上进行评估，操作系统为 Ubuntu 14.04 (LTS)。表3 显示了 SDAC 在所有四个步骤中的运行时性能：(i) API 路径提取，(ii) API 向量嵌入，(iii) API 簇生成和扩展，以及 (iv) 分类模型训练和测试。</p>
<h3 id="sdac-feo-ol-sdac-fmu-ol" tabindex="-1">SDAC-FEO-OL 和 SDAC-FMU-OL 在检测阶段的运行时间</h3>
<p>SDAC-FEO-OL 可以在线检测单个应用，无需等待整个测试集可用。在线检测一个应用的平均时间成本为 0.20 秒。一旦整个测试集可用，SDAC-FEO-OL 将以与 SDAC-FEO 相同的方式扩展其特征集。这一额外的时间成本与 SDAC-FEO 在其检测阶段相似。</p>
<p>SDAC-FMU-OL 检测一个应用在线的时间成本与 SDAC-FEO-OL 相同。一旦整个测试集可用，SDAC-FMU-OL 将以与 SDAC-FMU 相同的方式进行特征和模型更新，因此额外的时间成本也与 SDAC-FMU 相同。</p>
<h3 id="ma-ma-droid" tabindex="-1">MaMaDroid 的运行时间</h3>
<p>MaMaDroid 在训练阶段和检测阶段都进行了三个主要步骤：(i) 利用 FlowDroid 从一个应用中提取一组 API 路径，(ii) 从一组 API 路径形成一个马尔可夫模型，然后用它来组成一个特征向量，以及 (iii) 从（在训练阶段）或应用到（在检测阶段）一组应用的分类模型进行训练。在我们的实现中，MaMaDroid 的训练阶段在第一步平均花费 37.29 秒，在第二步平均花费 0.41 秒，在第三步处理 11,033 个应用（分别为 58,360 个应用）的时间为 16.3 秒（分别为 785.29 秒）。在其检测阶段，MaMaDroid 在第三步平均花费 0.0036 秒来分类单个应用，而前两步所需时间与训练阶段相同。</p>
<h3 id="运行时性能比较" tabindex="-1">运行时性能比较</h3>
<p>在训练阶段，SDAC 的时间花费（平均每个应用 54.17 秒）比 MaMaDroid（平均每个应用 37.70 秒）更长，用于将反编译代码转换为特征向量。在下一步分类模型训练中，即 SDAC-FEO 的模型训练或 SDAC-FMU 的模型更新，时间成本从包含 11,033 个应用的最小训练集的 9.77 秒到包含 58,033 个应用的最大训练集的约 0.47 小时不等，用于训练每个分类模型。由于 SDAC 使用了 9 个分类模型，因此这一步骤的总时间成本从 87.93 秒到约 4.2 小时不等。相比之下，MaMaDroid 在模型训练步骤中在不同训练集上花费 16.3 秒到约 13.1 分钟不等。在检测阶段，SDAC 检测每个应用的平均时间为 8.90e-4 秒，MaMaDroid 为 3.6e-3 秒。</p>
<p>尽管 SDAC 的训练时间比 MaMaDroid 长，但如第 4.1 至 4.3 节所示，它实现了更高的准确性和更慢的老化速度。尽管实验是在普通桌面电脑上进行的（即 i5-4590@3.3GHz CPU 和 12GB 内存），SDAC 的运行时性能在所有实验中都是可接受的。</p>
<h3 id="注释-1" tabindex="-1">注释</h3>
<p>对于 SDAC-FMU 和 SDAC-FMU-OL，特征和模型更新的时间成本随着其输入数据的大小增加而增加，输入数据是其训练集和所有过去测试集的并集。随着时间的推移，处理和累积更多测试集后，输入数据的大小持续增加。为了解决这个问题，我们建议对输入数据应用一个验证窗口，该窗口覆盖从最后一个所有应用的真实标签可用的测试集开始的所有过去测试集。这个验证窗口的大小是有限的，因此特征和模型更新的时间成本也是有限的。</p>
<p>形成测试集的时间粒度主要由每个时间粒度内收集的应用数量决定，每个测试集应足够大，以便从中提取准确的 API 上下文信息。我们建议根据我们对 SDAC 的经验，选择每个测试集的大小超过 5500 个应用。</p>
<h2 id="4-5-mjx-container-class-math-jax-jax-svg-style-direction-ltr-position-relative-svg-style-overflow-visible-min-height-1px-min-width-1px-vertical-align-0-357ex-xmlns-http-www-w3-org-2000-svg-width-4-237ex-height-1-889ex-role-img-focusable-false-view-box-0-677-1872-6-834-8-aria-hidden-true-g-stroke-current-color-fill-current-color-stroke-width-0-transform-scale-1-1-g-data-mml-node-math-g-data-mml-node-msub-g-data-mml-node-mi-path-data-c-1-d447-d-m40-437-q21-437-21-445-q21-450-37-501-t71-602-l88-651-q93-669-101-677-h569-h659-q691-677-697-676-t704-667-q704-661-687-553-t668-444-q668-437-649-437-q640-437-637-437-t631-442-l629-445-q629-451-635-490-t641-551-q641-586-628-604-t573-629-q568-630-515-631-q469-631-457-630-t439-622-q438-621-368-343-t298-60-q298-48-386-46-q418-46-427-45-t436-36-q436-31-433-22-q429-4-424-1-l422-0-q419-0-415-0-q410-0-363-1-t228-2-q99-2-64-0-h49-q43-6-43-9-t45-27-q49-40-55-46-h83-h94-q174-46-189-55-q190-56-191-56-q196-59-201-76-t241-233-q258-301-269-344-q339-619-339-625-q339-630-310-630-h279-q212-630-191-624-q146-614-121-583-t67-467-q60-445-57-441-t43-437-h40-z-style-stroke-width-3-g-g-data-mml-node-te-x-atom-transform-translate-617-150-scale-0-707-data-mjx-texclass-ord-g-data-mml-node-mi-path-data-c-1-d45-a-d-m21-287-q22-293-24-303-t36-341-t56-388-t88-425-t132-442-t175-435-t205-417-t221-395-t229-376-l231-369-q231-367-232-367-l243-378-q303-442-384-442-q401-442-415-440-t441-433-t460-423-t475-411-t485-398-t493-385-t497-373-t500-364-t502-357-l510-367-q573-442-659-442-q713-442-746-415-t780-336-q780-285-742-178-t704-50-q705-36-709-31-t724-26-q752-26-776-56-t815-138-q818-149-821-151-t837-153-q857-153-857-145-q857-144-853-130-q845-101-831-73-t785-17-t716-10-q669-10-648-17-t627-73-q627-92-663-193-t700-345-q700-404-656-404-h651-q565-404-506-303-l499-291-l466-157-q433-26-428-16-q415-11-385-11-q372-11-364-4-t353-8-t350-18-q350-29-384-161-l420-307-q423-322-423-345-q423-404-379-404-h374-q288-404-229-303-l222-291-l189-157-q156-26-151-16-q138-11-108-11-q95-11-87-5-t76-7-t74-17-q74-30-112-181-q151-335-151-342-q154-357-154-369-q154-405-129-405-q107-405-92-377-t69-316-t57-280-q55-278-41-278-h27-q21-284-21-287-z-style-stroke-width-3-g-g-data-mml-node-mi-transform-translate-878-0-path-data-c-1-d44-e-d-m33-157-q33-258-109-349-t280-441-q331-441-370-392-q386-422-416-422-q429-422-439-414-t449-394-q449-381-412-234-t374-68-q374-43-381-35-t402-26-q411-27-422-35-q443-55-463-131-q469-151-473-152-q475-153-483-153-h487-q506-153-506-144-q506-138-501-117-t481-63-t449-13-q436-0-417-8-q409-10-393-10-q359-10-336-5-t306-36-l300-51-q299-52-296-50-q294-48-292-46-q233-10-172-10-q117-10-75-30-t33-157-zm-351-328-q351-334-346-350-t323-385-t277-405-q242-405-210-374-t160-293-q131-214-119-129-q119-126-119-118-t118-106-q118-61-136-44-t179-26-q217-26-254-59-t298-110-q300-114-325-217-t351-328-z-style-stroke-width-3-g-g-data-mml-node-mi-transform-translate-1407-0-path-data-c-1-d459-d-m117-59-q117-26-142-26-q179-26-205-131-q211-151-215-152-q217-153-225-153-h229-q238-153-241-153-t246-151-t248-144-q247-138-245-128-t234-90-t214-43-t183-6-t137-11-q101-11-70-11-t38-85-q38-97-39-102-l104-360-q167-615-167-623-q167-626-166-628-t162-632-t157-634-t149-635-t141-636-t132-637-t122-637-q112-637-109-637-t101-638-t95-641-t94-647-q94-649-96-661-q101-680-107-682-t179-688-q194-689-213-690-t243-693-t254-694-q266-694-266-686-q266-675-193-386-t118-83-q118-81-118-75-t117-65-v59-z-style-stroke-width-3-g-g-g-g-g-svg-mjx-assistive-mml-unselectable-on-display-inline-style-top-0px-left-0px-clip-rect-1px-1px-1px-1px-webkit-touch-callout-none-webkit-user-select-none-khtml-user-select-none-moz-user-select-none-ms-user-select-none-user-select-none-position-absolute-padding-1px-0px-0px-0px-border-0px-display-block-width-auto-overflow-hidden-math-xmlns-http-www-w3-org-1998-math-math-ml-msub-mi-t-mi-mrow-data-mjx-texclass-ord-mi-m-mi-mi-a-mi-mi-l-mi-mrow-msub-math-mjx-assistive-mml-mjx-container-sdac" tabindex="-1">4.5 使用不同 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="4.237ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 1872.6 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub></math></mjx-assistive-mml></mjx-container> 评估 SDAC</h2>
<p>SDAC-FEO 和 SDAC-FMU 的性能也在使用不同正面阈值 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>4</mn></math></mjx-assistive-mml></mjx-container> 和 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>9</mn></math></mjx-assistive-mml></mjx-container> 的数据集上进行了评估，这些数据集的标签来自 VirusTotal 报告。我们还在这些数据集上运行 MaMaDroid 以进行性能比较。</p>
<p>图13 显示了当 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>4</mn></math></mjx-assistive-mml></mjx-container> 和 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>9</mn></math></mjx-assistive-mml></mjx-container> 时，SDAC 的 F 测量值。在两种情况下，2011 年的应用集被用作训练集，2012至2016年的数据集被用作测试集。在 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>4</mn></math></mjx-assistive-mml></mjx-container> 的情况下，SDAC-FEO 的 F 分数下降了 4.89%，SDAC-FMU 下降了 0.40% 每年，而 MaMaDroid 平均每年下降 6.12%。SDAC-FEO 和 SDAC-FMU 分别在 F 分数上平均比 MaMaDroid 高出 14.85% 和 22.55%。当 <mjx-container class="MathJax" jax="SVG" style="direction:ltr;position:relative"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-.357ex" xmlns="http://www.w3.org/2000/svg" width="8.385ex" height="1.889ex" role="img" focusable="false" viewBox="0 -677 3706.2 834.8" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z" style="stroke-width:3"></path></g><g data-mml-node="TeXAtom" transform="translate(617,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z" style="stroke-width:3"></path></g><g data-mml-node="mi" transform="translate(1407,0)"><path data-c="1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z" style="stroke-width:3"></path></g></g></g><g data-mml-node="mo" transform="translate(2150.4,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3"></path></g><g data-mml-node="mn" transform="translate(3206.2,0)"><path data-c="39" d="M352 287Q304 211 232 211Q154 211 104 270T44 396Q42 412 42 436V444Q42 537 111 606Q171 666 243 666Q245 666 249 666T257 665H261Q273 665 286 663T323 651T370 619T413 560Q456 472 456 334Q456 194 396 97Q361 41 312 10T208 -22Q147 -22 108 7T68 93T121 149Q143 149 158 135T173 96Q173 78 164 65T148 49T135 44L131 43Q131 41 138 37T164 27T206 22H212Q272 22 313 86Q352 142 352 280V287ZM244 248Q292 248 321 297T351 430Q351 508 343 542Q341 552 337 562T323 588T293 615T246 625Q208 625 181 598Q160 576 154 546T147 441Q147 358 152 329T172 282Q197 248 244 248Z" style="stroke-width:3"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline" style="top:0;left:0;clip:rect(1px,1px,1px,1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0 0 0;border:0;display:block;width:auto;overflow:hidden"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mi>m</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>9</mn></math></mjx-assistive-mml></mjx-container> 时，F 分数的平均老化速度为 SDAC-FEO 3.94%，SDAC-FMU 0.44%，MaMaDroid 5.95%。SDAC-FEO 和 SDAC-FMU 分别在 F 分数上平均比 MaMaDroid 高出 19.22% 和 25.22%。</p>
<h2 id="4-6-sdac" tabindex="-1">4.6 使用不平衡数据集评估 SDAC</h2>
<p>在我们的平衡数据集上，SDAC 显著优于 MaMaDroid。然而，根据最近的一个研究项目，平衡数据集可能导致恶意软件检测的结果偏差，因为在实际环境中，恶意软件通常是少数类（与良性软件相比）。据报道，在现实世界设置中，恶意软件的比例约为 10% [24]。为了估计 SDAC 在这种情况下的表现，我们将恶意软件下采样，使其比例为所有应用的 10%，并在我们的评估中形成新的数据集。图14 显示了 SDAC 在这些数据集上的表现，展示了 SDAC 和 MaMaDroid 之间更大的差异，以及与我们之前评估显示的类似趋势。</p>
<h1 id="5" tabindex="-1">5 讨论</h1>
<h2 id="5-1-sdac" tabindex="-1">5.1 SDAC 对抗混淆</h2>
<p>代码混淆工具，如 DroidChameleon [25] 或 [26]，经常被用来混淆恶意应用以避免检测。由于 SDAC 基于 Android API 进行检测，混淆方法主要可以分为三类，根据它们对应用中使用的 API 的影响：类别 I：应用使用的 API 集在混淆中没有改变（例如，加密本地漏洞或有效载荷，重命名标识符或包），类别 II：应用使用的 API 集在混淆中扩大以包括新的 API（例如，重新打包或插入垃圾代码），类别 III：应用使用的 API 集在混淆中减少（例如，隐藏方法调用或反射 [27], [28]）。</p>
<p>SDAC 对类别 I 混淆方法自然具有鲁棒性，因为它仅基于应用使用的 API 集来检测应用。类别 II 混淆方法，如“插入垃圾代码”和“将恶意软件重新打包为良性软件”，可能会扩大应用使用的 API 集，从而避免被 SDAC 检测。为了测试 SDAC 对类别 II 方法的鲁棒性，我们为每个测试集生成了 10,000 个 API 集的集合。该集合中的每个 API 集是从测试集中随机选择的一个良性样本和一个真阳性恶意软件样本的 API 集的并集。然后将 SDAC 应用于这些虚拟的恶意应用，以检查其在不同测试集上的召回率。表4 显示，SDAC 在所有模式下的召回率在前两年高于 65%，表明它们仍然可以检测到大多数这种情况下的混淆恶意软件。</p>
<p>类别 III 混淆方法主要通过在运行时加载某些恶意代码来实现，这在静态分析中是不可见的。通常，没有静态分析能对抗类别 III 混淆方法的鲁棒。尽管如此，SDAC 可能在动态分析中应用，因为在动态分析中捕获的 API 调用序列可以直接用作 SDAC 中 API 嵌入步骤的输入。未来测试 SDAC 在动态分析中对抗类别 III 混淆方法的鲁棒性仍然是一个有趣的课题。通过应用打包进行混淆。打包技术也是一种有效的应用混淆方法，用于隐藏它们的代码。各种打包技术被恶意软件开发者广泛采用，如 [29] 所报道。这些机制保护打包的恶意软件免受反向分析，从而阻碍路径提取和特征向量生成 in SDAC。然而，将 SDAC 与动态分析工具或 Android 解包器 [29], [30], [31] 结合使用仍有可能对抗打包的恶意软件。</p>
<h2 id="5-2-api" tabindex="-1">5.2 API 语义提取</h2>
<p>除了 SDAC 从中提取 API 语义的顺序 API 外，数据依赖是分析 API 关系并提取其语义的另一种方式。这种方法已在之前的研究中使用，如 DarkHazard [32]。SDAC 目前专注于基于顺序 API 分析的恶意软件检测，这与数据依赖分析是互补的。一些 API 可能彼此之间有直接的数据依赖关系，但没有任何顺序关系。另一方面，数据依赖分析可能会错过恶意软件检测中的一些 API 关系。例如，在 Wang 等人在 [33] 中提出的 Android 恶意软件检测解决方案中，发现数据依赖信息在自定义方法中丢失，因此可能导致恶意行为未被检测。而在 SDAC 中，这些自定义方法与其调用方法和被调用方法一起收集，然后用于生成 API 序列。将 SDAC 扩展到在语义提取中涵盖数据依赖关系将是未来工作中的一个有趣课题。</p>
<h2 id="5-3" tabindex="-1">5.3 限制</h2>
<p>在我们的实验中，我们在 SDAC 的第一步中使用 FlowDroid 从 Android 应用中提取 API 路径。我们观察到，在我们最初收集的所有应用中，有 2.89%（1053/36490）的良性样本和 1.74%（610/35106）的恶意样本未能被 FlowDroid 处理，这些样本在我们的实验中被排除。一些失败是由于在提取过程中超出了内存限制（即在我们的实验中，使用 Soot 工具进行 API 路径提取的内存限制为 4 GB）。为了解决这个问题，可以使用具有更大内存的更强大的计算机，或依赖于其他静态分析工具如 Amandroid [34] 和 Androguard [35] 来提取 API 路径。我们实验的另一个限制是 FlowDroid 不涵盖 HTML5 代码、本地代码或在运行时加载的代码。将 SDAC 扩展以通过执行动态分析来覆盖此类代码是未来的一个方向。</p>
<h2 id="6" tabindex="-1">6 相关工作</h2>
<h3 id="android" tabindex="-1">Android 框架的演变</h3>
<p>Android 应用依赖 Android API 来执行其功能，随着时间的推移，许多 API 被添加或弃用。API 演变对应用可用性的影响最近已被研究。例如，McDonnell、Ray 和 Kim 调查了 Android 应用开发者如何随时间跟随并采纳 Android API 变化 [36]。Linares-Vásquez 等人研究了 API 变化与故障倾向之间的关系，并评估其对 Android 应用成功的威胁 [37]。Brito 等人研究了 API 弃用消息的采纳及其对软件演化的影响 [38]。最近，Wu 等人关注在 Android 应用中声明的 Android API 框架版本与实际使用的版本之间的不一致 [39]。虽然此领域的大多数先前研究都集中在应用的可用性上，但尚未对 Android 框架演变对恶意软件检测的影响进行严格研究。</p>
<h3 id="android-1" tabindex="-1">Android 恶意软件检测</h3>
<p>Android 恶意软件检测可以分为静态分析和动态分析（例如，[40]，[41]，[42]，[43]，[44]，[45]）。SDAC 属于静态分析，尽管其方法未来可以扩展到动态分析。静态分析根据从应用 APK 文件中提取的信息来检测 Android 恶意软件。它可以进一步分为基于签名的解决方案（例如，[46]，[47]，[48]）和基于学习的解决方案。我们简要总结了一些与 SDAC 更密切相关的基于学习的解决方案。例如，Arp 等人设计了 Drebin 来从清单文件和反汇编代码中提取八类特征（例如，网络地址、组件名称、权限和 API 调用）。Avdiienko 等人检查了恶意软件和良性软件之间敏感数据流的差异 [49]。Yang 等人设计了 DroidMiner 来从 API 和框架资源中提取恶意行为模式 [50]。在另一项工作中，Ke、Li 和 Deng 设计了 ICCDetector 来从应用组件中提取组件间通信特征 [51]。此外，由 Aafer、Du 和 Yin 提出的 DroidAPIMiner 提取了一组包括关键 API 调用频率、框架类和 API 参数的 API 级特征 [52]。Zhang 等人提出的 DroidSIFT 从应用中提取基于敏感 API 的加权上下文 API 依赖图 [53]。Chakradeo 等人提出的 MAST 检查了应用功能声明指标（例如，权限、意图过滤器和本地代码的存在）之间的强关系 [54]。许多其他类型的特征也用于基于学习的解决方案（例如，[55]，[56]，[57]，[58]，[59]，[60]）。大多数基于学习的解决方案中特征集的一个共同特点是它们是“静态”的，没有跟上 Android 框架的演变。因此，这些解决方案的准确性可能会随时间显著下降（即模型老化），这在最近的工业界（例如，[2]）和学术界（例如，[1]，[3]）中都有观察到。虽然 MaMaDroid 能够抵抗在 Android 规范中向现有包添加新 API 的问题 [5]，但在此之前，模型老化问题基本上未解决，因为 Android 框架中不断添加许多新包。</p>
<h2 id="7" tabindex="-1">7 结论</h2>
<p>在本文中，我们设计了一个名为 SDAC 的新型减缓老化解决方案，用于 Android 恶意软件检测。实现 SDAC 减缓老化的关键驱动因素包括：(i) 基于 API 之间的语义距离对 API 进行聚类，(ii) 使用现有 API 的基础上评估新 API 对恶意软件检测的贡献，以及 (iii) 基于具有真实标签的训练数据和具有伪标签的测试数据更新 API 簇和分类模型。SDAC 的最佳版本在我们的实验中实现了高准确性，平均 F 分数为 97.49%，并且老化速度慢，平均 F 分数每年下降 0.11%。其他版本对计算资源的要求较低。</p>
</main>
<aside>
<div class="sidebar">
<div class="sidebar-container">
<div class="toc">
<div class="toc-title-container">
<div class="toc-title">
On this page
</div>
</div>
<div class="toc-container">
<nav class="toc">
<ol>
<li><a href="#摘要">摘要</a>
</li>
<li><a href="#引言">引言</a>
</li>
<li><a href="#sdac">基础SDAC</a>
<ol>
<li><a href="#2-1-api">2.1 API路径提取</a>
</li>
<li><a href="#2-2-api">2.2 API向量嵌入</a>
</li>
<li><a href="#2-3-api">2.3 API簇生成与扩展</a>
<ol>
<li><a href="#api">API簇生成</a>
</li>
<li><a href="#api-1">API簇扩展</a>
</li>
</ol>
</li>
<li><a href="#2-4">2.4 分类模型训练与测试特征向量生成</a>
<ol>
<li><a href="#分类模型训练">分类模型训练</a>
</li>
<li><a href="#分类模型测试">分类模型测试</a>
</li>
</ol>
</li>
<li><a href="#2-5">2.5 模型投票</a>
</li>
<li><a href="#3-sdac">3 SDAC的两种模式和在线版本</a>
<ol>
<li><a href="#3-1-sdac-feo">3.1 SDAC-FEO</a>
</li>
</ol>
</li>
<li><a href="#3-2-sdac-fmu">3.2 SDAC-FMU</a>
</li>
<li><a href="#3-3">3.3 在线版本</a>
<ol>
<li><a href="#sdac-feo-ol">SDAC-FEO-OL</a>
</li>
<li><a href="#sdac-fmu-ol">SDAC-FMU-OL</a>
</li>
<li><a href="#注释">注释</a>
</li>
</ol>
</li>
</ol>
</li>
<li><a href="#4-sdac">4 评估 SDAC 数据集</a>
<ol>
<li><a href="#工具和参数选择">工具和参数选择</a>
</li>
<li><a href="#k-m-t">参数选择：k、m 和 t</a>
</li>
<li><a href="#4-1-sdac-feo">4.1 SDAC-FEO的评估</a>
<ol>
<li><a href="#sdac-feo">SDAC-FEO 随时间的性能</a>
</li>
<li><a href="#api-2">API 簇扩展分析</a>
</li>
</ol>
</li>
<li><a href="#4-2-sdac-fmu-sdac-feo-ma-ma-droid">4.2 SDAC-FMU的评估：比SDAC-FEO和MaMaDroid老化更慢</a>
<ol>
<li><a href="#假阳性分析">假阳性分析</a>
</li>
<li><a href="#假阴性分析">假阴性分析</a>
</li>
</ol>
</li>
<li><a href="#4-3-sdac-feo-ol-sdac-fmu-ol">4.3 SDAC-FEO-OL 和 SDAC-FMU-OL 的评估</a>
</li>
<li><a href="#4-4">4.4 运行时性能</a>
<ol>
<li><a href="#sdac-feo-ol-sdac-fmu-ol">SDAC-FEO-OL 和 SDAC-FMU-OL 在检测阶段的运行时间</a>
</li>
<li><a href="#ma-ma-droid">MaMaDroid 的运行时间</a>
</li>
<li><a href="#运行时性能比较">运行时性能比较</a>
</li>
<li><a href="#注释-1">注释</a>
</li>
</ol>
</li>
<li><a href="#4-5-mjx-container-class-math-jax-jax-svg-style-direction-ltr-position-relative-svg-style-overflow-visible-min-height-1px-min-width-1px-vertical-align-0-357ex-xmlns-http-www-w3-org-2000-svg-width-4-237ex-height-1-889ex-role-img-focusable-false-view-box-0-677-1872-6-834-8-aria-hidden-true-g-stroke-current-color-fill-current-color-stroke-width-0-transform-scale-1-1-g-data-mml-node-math-g-data-mml-node-msub-g-data-mml-node-mi-path-data-c-1-d447-d-m40-437-q21-437-21-445-q21-450-37-501-t71-602-l88-651-q93-669-101-677-h569-h659-q691-677-697-676-t704-667-q704-661-687-553-t668-444-q668-437-649-437-q640-437-637-437-t631-442-l629-445-q629-451-635-490-t641-551-q641-586-628-604-t573-629-q568-630-515-631-q469-631-457-630-t439-622-q438-621-368-343-t298-60-q298-48-386-46-q418-46-427-45-t436-36-q436-31-433-22-q429-4-424-1-l422-0-q419-0-415-0-q410-0-363-1-t228-2-q99-2-64-0-h49-q43-6-43-9-t45-27-q49-40-55-46-h83-h94-q174-46-189-55-q190-56-191-56-q196-59-201-76-t241-233-q258-301-269-344-q339-619-339-625-q339-630-310-630-h279-q212-630-191-624-q146-614-121-583-t67-467-q60-445-57-441-t43-437-h40-z-style-stroke-width-3-g-g-data-mml-node-te-x-atom-transform-translate-617-150-scale-0-707-data-mjx-texclass-ord-g-data-mml-node-mi-path-data-c-1-d45-a-d-m21-287-q22-293-24-303-t36-341-t56-388-t88-425-t132-442-t175-435-t205-417-t221-395-t229-376-l231-369-q231-367-232-367-l243-378-q303-442-384-442-q401-442-415-440-t441-433-t460-423-t475-411-t485-398-t493-385-t497-373-t500-364-t502-357-l510-367-q573-442-659-442-q713-442-746-415-t780-336-q780-285-742-178-t704-50-q705-36-709-31-t724-26-q752-26-776-56-t815-138-q818-149-821-151-t837-153-q857-153-857-145-q857-144-853-130-q845-101-831-73-t785-17-t716-10-q669-10-648-17-t627-73-q627-92-663-193-t700-345-q700-404-656-404-h651-q565-404-506-303-l499-291-l466-157-q433-26-428-16-q415-11-385-11-q372-11-364-4-t353-8-t350-18-q350-29-384-161-l420-307-q423-322-423-345-q423-404-379-404-h374-q288-404-229-303-l222-291-l189-157-q156-26-151-16-q138-11-108-11-q95-11-87-5-t76-7-t74-17-q74-30-112-181-q151-335-151-342-q154-357-154-369-q154-405-129-405-q107-405-92-377-t69-316-t57-280-q55-278-41-278-h27-q21-284-21-287-z-style-stroke-width-3-g-g-data-mml-node-mi-transform-translate-878-0-path-data-c-1-d44-e-d-m33-157-q33-258-109-349-t280-441-q331-441-370-392-q386-422-416-422-q429-422-439-414-t449-394-q449-381-412-234-t374-68-q374-43-381-35-t402-26-q411-27-422-35-q443-55-463-131-q469-151-473-152-q475-153-483-153-h487-q506-153-506-144-q506-138-501-117-t481-63-t449-13-q436-0-417-8-q409-10-393-10-q359-10-336-5-t306-36-l300-51-q299-52-296-50-q294-48-292-46-q233-10-172-10-q117-10-75-30-t33-157-zm-351-328-q351-334-346-350-t323-385-t277-405-q242-405-210-374-t160-293-q131-214-119-129-q119-126-119-118-t118-106-q118-61-136-44-t179-26-q217-26-254-59-t298-110-q300-114-325-217-t351-328-z-style-stroke-width-3-g-g-data-mml-node-mi-transform-translate-1407-0-path-data-c-1-d459-d-m117-59-q117-26-142-26-q179-26-205-131-q211-151-215-152-q217-153-225-153-h229-q238-153-241-153-t246-151-t248-144-q247-138-245-128-t234-90-t214-43-t183-6-t137-11-q101-11-70-11-t38-85-q38-97-39-102-l104-360-q167-615-167-623-q167-626-166-628-t162-632-t157-634-t149-635-t141-636-t132-637-t122-637-q112-637-109-637-t101-638-t95-641-t94-647-q94-649-96-661-q101-680-107-682-t179-688-q194-689-213-690-t243-693-t254-694-q266-694-266-686-q266-675-193-386-t118-83-q118-81-118-75-t117-65-v59-z-style-stroke-width-3-g-g-g-g-g-svg-mjx-assistive-mml-unselectable-on-display-inline-style-top-0px-left-0px-clip-rect-1px-1px-1px-1px-webkit-touch-callout-none-webkit-user-select-none-khtml-user-select-none-moz-user-select-none-ms-user-select-none-user-select-none-position-absolute-padding-1px-0px-0px-0px-border-0px-display-block-width-auto-overflow-hidden-math-xmlns-http-www-w3-org-1998-math-math-ml-msub-mi-t-mi-mrow-data-mjx-texclass-ord-mi-m-mi-mi-a-mi-mi-l-mi-mrow-msub-math-mjx-assistive-mml-mjx-container-sdac">4.5 使用不同 Tmal 评估 SDAC</a>
</li>
<li><a href="#4-6-sdac">4.6 使用不平衡数据集评估 SDAC</a>
</li>
</ol>
</li>
<li><a href="#5">5 讨论</a>
<ol>
<li><a href="#5-1-sdac">5.1 SDAC 对抗混淆</a>
</li>
<li><a href="#5-2-api">5.2 API 语义提取</a>
</li>
<li><a href="#5-3">5.3 限制</a>
</li>
<li><a href="#6">6 相关工作</a>
<ol>
<li><a href="#android">Android 框架的演变</a>
</li>
<li><a href="#android-1">Android 恶意软件检测</a>
</li>
</ol>
</li>
<li><a href="#7">7 结论</a>
</li>
</ol>
</li>
</ol>
</nav>
</div>
</div>
<div class="backlinks">
<div class="backlink-title" style="margin:4px 0!important">Pages mentioning this page</div>
<div class="backlink-list"><div class="backlink-card"><i icon-name="link"></i><a href="/硕士研究生/科研/文献阅读笔记/文献阅读笔记/" data-note-icon="" class="backlink">文献阅读笔记</a>
</div><div class="backlink-card"><i icon-name="link"></i><a href="/硕士研究生/科研/论文/论文思路/" data-note-icon="" class="backlink">论文思路</a>
</div></div>
</div>
</div>
</div>
</aside>
<style>#tooltip-wrapper{background:var(--background-primary);padding:1em;border-radius:4px;overflow:hidden;position:fixed;width:80%;max-width:400px;height:auto;max-height:300px;font-size:.8em;box-shadow:0 5px 10px rgba(0,0,0,.1);opacity:0;transition:opacity .1s;unicode-bidi:plaintext;overflow-y:scroll;z-index:10}#tooltip-wrapper:after{content:"";position:absolute;z-index:1;bottom:0;left:0;pointer-events:none;width:100%;unicode-bidi:plaintext;height:75px}</style>
<div style="opacity:0;display:none" id="tooltip-wrapper">
<div id="tooltip-content">
</div>
</div>
<iframe style="display:none;height:0;width:0" id="link-preview-iframe" src="">
</iframe>
<script>var opacityTimeout,contentTimeout,transitionDurationMs=100,iframe=document.getElementById("link-preview-iframe"),tooltipWrapper=document.getElementById("tooltip-wrapper"),tooltipContent=document.getElementById("tooltip-content"),linkHistories={};function hideTooltip(){opacityTimeout=setTimeout((function(){tooltipWrapper.style.opacity=0,contentTimeout=setTimeout((function(){tooltipContent.innerHTML="",tooltipWrapper.style.display="none"}),transitionDurationMs+1)}),transitionDurationMs)}function showTooltip(t){var e=t.target,o=e.getClientRects()[e.getClientRects().length-1],i=window.pageYOffset||document.documentElement.scrollTop,n=t.target.getAttribute("href");if(-1===n.indexOf("http")||-1!==n.indexOf(window.location.host)){let t=n.split("#")[0];linkHistories[t]?(tooltipContent.innerHTML=linkHistories[t],tooltipWrapper.style.display="block",setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)):(iframe.src=t,iframe.onload=function(){tooltipContentHtml="",tooltipContentHtml+='<div style="font-weight: bold; unicode-bidi: plaintext;">'+iframe.contentWindow.document.querySelector("h1").innerHTML+"</div>",tooltipContentHtml+=iframe.contentWindow.document.querySelector(".content").innerHTML,tooltipContent.innerHTML=tooltipContentHtml,linkHistories[t]=tooltipContentHtml,tooltipWrapper.style.display="block",tooltipWrapper.scrollTop=0,setTimeout((function(){if(tooltipWrapper.style.opacity=1,-1!=n.indexOf("#")){let t=n.split("#")[1];const e=tooltipWrapper.querySelector(`[id='${t}']`);e.classList.add("referred"),console.log(e),e.scrollIntoView({behavior:"smooth"},!0)}else tooltipWrapper.scroll(0,0)}),1)}),tooltipWrapper.style.left=o.left-tooltipWrapper.offsetWidth/2+o.width/2+"px",window.innerHeight-o.top<tooltipWrapper.offsetHeight?tooltipWrapper.style.top=o.top+i-tooltipWrapper.offsetHeight-10+"px":window.innerHeight-o.top>tooltipWrapper.offsetHeight&&(tooltipWrapper.style.top=o.top+i+35+"px"),o.left+o.width/2<tooltipWrapper.offsetWidth/2?tooltipWrapper.style.left="10px":document.body.clientWidth-o.left-o.width/2<tooltipWrapper.offsetWidth/2&&(tooltipWrapper.style.left=document.body.clientWidth-tooltipWrapper.offsetWidth-20+"px")}}function setupListeners(t){t.addEventListener("mouseleave",(function(t){hideTooltip()})),tooltipWrapper.addEventListener("mouseleave",(function(t){hideTooltip()})),t.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout),showTooltip(t)})),tooltipWrapper.addEventListener("mouseenter",(function(t){clearTimeout(opacityTimeout),clearTimeout(contentTimeout)}))}window.addEventListener("load",(function(t){document.querySelectorAll(".internal-link").forEach(setupListeners),document.querySelectorAll(".backlink-card a").forEach(setupListeners)}))</script>
<script>window.location.hash&&document.getElementById(window.location.hash.slice(1)).classList.add("referred"),window.addEventListener("hashchange",(e=>{const t=e.oldURL.split("#");t[1]&&document.getElementById(t[1]).classList.remove("referred");const n=e.newURL.split("#");n[1]&&document.getElementById(n[1]).classList.add("referred")}),!1);const url_parts=window.location.href.split("#"),url=url_parts[0],referrence=url_parts[1];document.querySelectorAll(".cm-s-obsidian > *[id]").forEach((function(e){e.ondblclick=function(e){const t=url+"#"+e.target.id;navigator.clipboard.writeText(t)}}))</script>
<script src="https://fastly.jsdelivr.net/npm/luxon@3.2.1/build/global/luxon.min.js"></script>
<script defer="defer">TIMESTAMP_FORMAT="MMM dd, yyyy h:mm a",document.querySelectorAll(".human-date").forEach((function(e){date=e.getAttribute("data-date")||e.innerText,parsed_date=luxon.DateTime.fromISO(date),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromSQL(date)),null!=parsed_date.invalid&&(parsed_date=luxon.DateTime.fromHTML(date)),e.innerHTML=parsed_date.toFormat(TIMESTAMP_FORMAT)}))</script>
<script>lucide.createIcons({attrs:{class:["svg-icon"]}})</script>
</body>
</html>
